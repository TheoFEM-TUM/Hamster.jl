<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Library · Hamster</title><meta name="title" content="Library · Hamster"/><meta property="og:title" content="Library · Hamster"/><meta property="twitter:title" content="Library · Hamster"/><meta name="description" content="Documentation for Hamster."/><meta property="og:description" content="Documentation for Hamster."/><meta property="twitter:description" content="Documentation for Hamster."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Hamster logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Hamster</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Config File</span><ul><li><a class="tocitem" href="../../conf/config/">Main Input File</a></li><li><a class="tocitem" href="../../conf/general_tags/">General Options</a></li><li><a class="tocitem" href="../../conf/block_tags/">Config Blocks</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/examples/">Overview</a></li><li><a class="tocitem" href="../../examples/model_eval/">Standard run for GaAs</a></li><li><a class="tocitem" href="../../examples/gaas_tb_hyperopt/">TB Hyperparameter optimization for GaAs</a></li><li><a class="tocitem" href="../../examples/gaas_ml_fit/">Fitting a Delta-ML model on data from MD</a></li></ul></li><li class="is-active"><a class="tocitem" href>Library</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Basis"><span>Basis</span></a></li><li class="toplevel"><a class="tocitem" href="#Structure"><span>Structure</span></a></li><li class="toplevel"><a class="tocitem" href="#TB"><span>TB</span></a></li><li class="toplevel"><a class="tocitem" href="#SOC"><span>SOC</span></a></li><li class="toplevel"><a class="tocitem" href="#ML"><span>ML</span></a></li><li class="toplevel"><a class="tocitem" href="#Optimization"><span>Optimization</span></a></li><li class="toplevel"><a class="tocitem" href="#Parsing-functions"><span>Parsing functions</span></a></li><li class="toplevel"><a class="tocitem" href="#Main"><span>Main</span></a></li><li class="toplevel"><a class="tocitem" href="#Config"><span>Config</span></a></li><li class="toplevel"><a class="tocitem" href="#Output"><span>Output</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Library</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Library</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/TheoFEM-TUM/Hamster.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/master/docs/src/library/library.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Calculation-types"><a class="docs-heading-anchor" href="#Calculation-types">Calculation types</a><a id="Calculation-types-1"></a><a class="docs-heading-anchor-permalink" href="#Calculation-types" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.hyper_optimize-NTuple{5, Any}" href="#Hamster.hyper_optimize-NTuple{5, Any}"><code>Hamster.hyper_optimize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hyper_optimize(param_values, params, comm, conf; rank=0, nranks=1, verbosity=get_verbosity(conf)) -&gt; Float64</code></pre><p>Evaluate a given set of hyperparameters by updating a configuration and running an optimization calculation.</p><p><strong>Arguments</strong></p><ul><li><code>param_values::Vector{Float64}</code>: Numerical values for each parameter to be optimized.</li><li><code>params::Vector{String}</code>: List of parameter keys. Keys can be flat (e.g., <code>&quot;alpha&quot;</code>) or hierarchical (e.g., <code>&quot;Ga_alpha&quot;</code>).</li><li><code>comm</code>: MPI communicator.</li><li><code>conf</code>: Configuration object.</li><li><code>rank::Int</code>: MPI rank (default = 0).</li><li><code>nranks::Int</code>: Total number of MPI processes (default = 1).</li><li><code>verbosity::Int</code>: Verbosity level (default = pulled from configuration).</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: The minimum training loss obtained from the optimization calculation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/calc/hyperopt.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.run_calculation-Tuple{Val{:hyper_optimization}, Any, Any}" href="#Hamster.run_calculation-Tuple{Val{:hyper_optimization}, Any, Any}"><code>Hamster.run_calculation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_calculation(::Val{:hyper_optimization}, comm, conf; rank=0, nranks=1, verbosity=get_verbosity(conf))</code></pre><p>Performs random search hyperparameter optimization by repeatedly evaluating randomly sampled parameter configurations.</p><p><strong>Arguments</strong></p><ul><li><code>::Val{:hyper_optimization}</code>: Dispatch tag to indicate this function handles hyperparameter optimization.</li><li><code>comm</code>: MPI communicator used for distributed computation.</li><li><code>conf</code>: Configuration object used to retrieve hyperparameter bounds, optimization settings, and verbosity.</li><li><code>rank::Int</code>: MPI rank (default = 0).</li><li><code>nranks::Int</code>: Number of MPI processes (default = 1).</li><li><code>verbosity::Int</code>: Controls the amount of output printed (default = retrieved from <code>conf</code>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/calc/hyperopt.jl#L59-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.run_calculation-Tuple{Val{:optimization}, Any, Config}" href="#Hamster.run_calculation-Tuple{Val{:optimization}, Any, Config}"><code>Hamster.run_calculation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>run_calculation(::Val{:optimization}, comm, conf::Config; rank=0, nranks=1)</p><p>Runs the optimization process for an effective Hamiltonian model using the specified configuration.</p><p><strong>Arguments</strong></p><ul><li><code>conf::Config</code>: A configuration instance.</li></ul><p><strong>Workflow</strong></p><ol><li><strong>Configuration Sampling</strong>:<ul><li>Splits the configuration indices into training (<code>train_config_inds</code>) and validation (<code>val_config_inds</code>) sets.</li></ul></li><li><strong>Translation Vectors</strong>:<ul><li>Reads translation vectors <code>Rs</code> (if <code>hr_fit</code>).</li></ul></li><li><strong>Training Data Preparation</strong>:<ul><li>Retrieves training structures (<code>train_strcs</code>) and constructs basis functions (<code>train_bases</code>).</li><li>Initializes the effective Hamiltonian (<code>ham_train</code>) for the training data.</li></ul></li><li><strong>Validation Data Preparation</strong>:<ul><li>Retrieves validation structures (<code>val_strcs</code>) and constructs basis functions (<code>val_bases</code>).</li><li>Initializes the effective Hamiltonian (<code>ham_val</code>) for the validation data.</li></ul></li><li><strong>Data Loader and Optimizer</strong>:<ul><li>Initializes a <code>DataLoader</code> (<code>dl</code>) with the training and validation configuration indices.</li><li>Sets up a gradient descent optimizer (<code>optim</code>) with the extracted parameters.</li></ul></li><li><strong>Profiler</strong>:<ul><li>Creates a <code>HamsterProfiler</code> (<code>prof</code>) for profiling the optimization process.</li></ul></li><li><strong>Model Optimization</strong>:<ul><li>Performs the optimization using <code>optimize_model!</code>, which iterates over the training and validation data to refine the model.</li></ul></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/calc/optimization.jl#L1-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_eigenvalues" href="#Hamster.get_eigenvalues"><code>Hamster.get_eigenvalues</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_eigenvalues(ham::EffectiveHamiltonian, prof, local_inds, comm, conf=get_empty_config();
                Nbatch=get_nbatch(conf), rank=0, nranks=1, verbosity=get_verbosity(conf))</code></pre><p>Computes eigenvalues and eigenvectors of the Hamiltonian for a set of structures, distributing the computation across MPI ranks.</p><p><strong>Arguments</strong></p><ul><li><code>ham::EffectiveHamiltonian</code>: The effective Hamiltonian object.</li><li><code>prof</code>: A profiling object that stores timing information for each step.</li><li><code>local_inds</code>: Indices of the local structures assigned to the current MPI rank.</li><li><code>comm</code>: The MPI communicator used for parallel execution.</li><li><code>conf</code>: Configuration object (default: <code>get_empty_config()</code>) containing parameters for diagonalization.</li><li><code>Nbatch</code>: The batch size for processing structures (default: <code>get_nbatch(conf)</code>).</li><li><code>rank</code>: The rank of the MPI process (default: <code>0</code>).</li><li><code>nranks</code>: Total number of MPI ranks (default: <code>1</code>).</li><li><code>verbosity</code>: Level of verbosity for printed output (default: <code>get_verbosity(conf)</code>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/calc/standard.jl#L71-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.run_calculation-Tuple{Val{:standard}, Any, Config}" href="#Hamster.run_calculation-Tuple{Val{:standard}, Any, Config}"><code>Hamster.run_calculation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_calculation(::Val{:standard}, comm, conf::Config; rank=0, nranks=1)</code></pre><p>Performs a standard calculation for an effective Hamiltonian model.</p><p><strong>Arguments</strong></p><ul><li><code>::Val{:standard}</code>: A type parameter indicating that this function performs a standard calculation.</li><li><code>comm</code>: The MPI communicator used for parallel processing.</li><li><code>conf::Config</code>: A configuration object that contains parameters for the calculation.</li><li><code>rank</code>: The MPI rank of the current process (default: <code>0</code>).</li><li><code>nranks</code>: The total number of MPI ranks (default: <code>1</code>).</li></ul><p><strong>Function Behavior</strong></p><ol><li>Retrieves the configuration indices using <code>get_config_index_sample(conf)</code>.</li><li>If configuration indices are specified in the configuration file, they are read from a file.</li><li>The root process (<code>rank == 0</code>) writes the configuration indices to a file.</li><li>The indices are broadcast to all processes using <code>MPI.Bcast!</code>, ensuring consistency across ranks.</li><li>Determines the mode of calculation:<ul><li><code>&quot;md&quot;</code> (molecular dynamics) if the configuration contains <code>&quot;Supercell&quot;</code>.</li><li><code>&quot;pc&quot;</code> (phonon calculation) otherwise.</li></ul></li><li>Distributes the configuration indices among MPI ranks for parallel execution.</li><li>Extracts atomic structures using <code>get_structures(conf, config_indices=local_inds, mode=mode)</code>.</li><li>Constructs bases using the <code>Basis</code> type for each structure.</li><li>Initializes the <code>EffectiveHamiltonian</code> for solving electronic or vibrational properties.</li><li>Sets up a <code>HamsterProfiler</code> to profile the computation over multiple iterations.</li><li>Computes eigenvalues using <code>get_eigenvalues</code>, which performs the main calculation.</li><li>Returns the profiler object (<code>prof</code>), which contains performance and profiling data.</li></ol><p><strong>Returns</strong></p><ul><li><code>prof::HamsterProfiler</code>: An object containing profiling information about the Hamiltonian calculation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/calc/standard.jl#L1-L31">source</a></section></article><h1 id="Basis"><a class="docs-heading-anchor" href="#Basis">Basis</a><a id="Basis-1"></a><a class="docs-heading-anchor-permalink" href="#Basis" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.AdaptiveInterpolator" href="#Hamster.AdaptiveInterpolator"><code>Hamster.AdaptiveInterpolator</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AdaptiveInterpolator(xmin::Float64, xmax::Float64, Ninit::Int64, Nmax::Int64, tol::Float64)</code></pre><p>A struct that defines the settings for adaptive interpolation.</p><p><strong>Fields</strong></p><ul><li><code>xmin::Float64</code>: The minimum value of <code>x</code> in the interpolation range.</li><li><code>xmax::Float64</code>: The maximum value of <code>x</code> in the interpolation range.</li><li><code>Ninit::Int64</code>: The initial number of sample points for the interpolation.</li><li><code>Nmax::Int64</code>: The maximum number of sample points allowed during the interpolation process.</li><li><code>tol::Float64</code>: The convergence tolerance. If the interpolation error falls below this value, the algorithm is considered to have converged.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/adaptive_intp.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_new_point!-NTuple{4, Any}" href="#Hamster.get_new_point!-NTuple{4, Any}"><code>Hamster.get_new_point!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_new_point(f, xmax, ymax, Nmax; max_iter=10000)</code></pre><p>Generate a new point <code>xnew</code> for function sampling based on the gradient and curvature of the function <code>f</code>.  This function prioritizes areas of the function with high curvature or gradient, to improve sampling in regions  with rapid changes.</p><p><strong>Arguments</strong></p><ul><li><code>f</code>: The function to sample from. Assumed to have fields <code>xs</code> containing previous sample points.</li><li><code>xmax</code>: The maximum possible value for <code>x</code>.</li><li><code>ymax</code>: The maximum possible value of the function <code>f</code> over the sampled points.</li><li><code>Nmax</code>: The maximum number of points that can be generated.</li><li><code>max_iter</code>: Maximum number of iterations to attempt generating a new point (default is <code>10000</code>).</li></ul><p><strong>Returns</strong></p><ul><li><code>xnew</code>: A new sampled point <code>xnew</code> that is in a region with either high gradient or high curvature, and  sufficiently far from existing points in <code>f.xs</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/adaptive_intp.jl#L96-L113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.insertxy!-NTuple{4, Any}" href="#Hamster.insertxy!-NTuple{4, Any}"><code>Hamster.insertxy!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">insertxy!(xs, ys, xnew, ynew)</code></pre><p>Insert a new point <code>(xnew, ynew)</code> into two vectors <code>xs</code> and <code>ys</code>, which are assumed to be paired coordinates,  while maintaining the sorted order of <code>xs</code>.</p><p><strong>Arguments</strong></p><ul><li><code>xs</code>: A vector of <code>x</code> values (assumed to be sorted in ascending order).</li><li><code>ys</code>: A vector of <code>y</code> values corresponding to <code>xs</code>.</li><li><code>xnew</code>: The new <code>x</code> value to insert into <code>xs</code>.</li><li><code>ynew</code>: The new <code>y</code> value to insert into <code>ys</code>, corresponding to <code>xnew</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/adaptive_intp.jl#L75-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.interpolate_f-Tuple{Hamster.AdaptiveInterpolator, Function}" href="#Hamster.interpolate_f-Tuple{Hamster.AdaptiveInterpolator, Function}"><code>Hamster.interpolate_f</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">interpolate_f(itper::AdaptiveInterpolator, f::Function)</code></pre><p>Adaptive interpolation of a given function <code>f</code> using an <code>AdaptiveInterpolator</code>. The function is sampled  at adaptive points and interpolated using cubic splines until convergence is reached or the maximum number  of samples (<code>Nmax</code>) is exceeded.</p><p><strong>Arguments</strong></p><ul><li><code>itper::AdaptiveInterpolator</code>: An instance of the <code>AdaptiveInterpolator</code> struct that defines the interpolation  settings, such as the initial number of points, the maximum allowed number of points (<code>Nmax</code>),  and the convergence tolerance.</li><li><code>f::Function</code>: The function to interpolate.</li></ul><p><strong>Returns</strong></p><ul><li><code>xs</code>: A vector of <code>x</code> values where the function has been evaluated.</li><li><code>ys</code>: A vector of <code>y</code> values (<code>f(xs)</code>) corresponding to the <code>x</code> values.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/adaptive_intp.jl#L24-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Basis" href="#Hamster.Basis"><code>Hamster.Basis</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Basis(strc::Structure, conf=get_empty_config()) -&gt; Basis</code></pre><p>Construct a <code>Basis</code> object from a given <code>Structure</code> and configuration.</p><p><strong>Arguments</strong></p><ul><li><code>strc::Structure</code>: The <code>Structure</code> object representing the atomic or molecular structure for which the basis is being constructed.</li><li><code>conf</code>: (Optional) The configuration object that holds parameters to control the basis construction. Defaults to <code>get_empty_config()</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>Basis</code>: A <code>Basis</code> object.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/basis.jl#L19-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Basis" href="#Hamster.Basis"><code>Hamster.Basis</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct Basis{Orb, Ov, P, R}</code></pre><p>A data structure that represents the basis of a system, containing information about orbitals, overlap integrals, parameters, and precomputed radial functions (RLLM).</p><p><strong>Fields</strong></p><ul><li><code>orbitals::Orb</code>: A collection of orbitals for each ion in the system. This typically contains the orbital functions and axes associated with each ion.</li><li><code>overlaps::Ov</code>: A collection of overlap integrals between orbitals. These overlap integrals define how the orbitals interact with each other spatially.</li><li><code>parameters::P</code>: Parameters used for computing the matrix elements between orbitals. These can include interaction strengths, angular momentum values, and other system-specific constants.</li><li><code>rllm::R</code>: Precomputed radial functions (RLLM), typically stored as spline objects for efficient interpolation. These functions depend on the distance between ions and are used in overlap integrals.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/basis.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.length-Tuple{Basis}" href="#Base.length-Tuple{Basis}"><code>Base.length</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">length(basis::Basis) -&gt; Int</code></pre><p>Compute the total number of orbitals in the <code>basis</code>.</p><p><strong>Arguments</strong></p><ul><li><code>basis::Basis</code>: The <code>Basis</code> object containing orbitals for each ion in the system.</li></ul><p><strong>Returns</strong></p><ul><li><code>Int</code>: The total number of orbitals, calculated by summing the lengths of the orbital sets for all ions in the <code>basis</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/basis.jl#L39-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.size-Tuple{Basis}" href="#Base.size-Tuple{Basis}"><code>Base.size</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Base.size(basis::Basis) -&gt; Tuple{Int}</code></pre><p>Returns the size of the <code>Basis</code> object, which corresponds to the number of orbitals centered on each ion.</p><p><strong>Arguments</strong></p><ul><li><code>basis::Basis</code>: The basis object containing a set of orbitals.</li></ul><p><strong>Returns</strong></p><ul><li>A tuple containing the number of orbitals in the basis.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/basis.jl#L52-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_geometry_tensor" href="#Hamster.get_geometry_tensor"><code>Hamster.get_geometry_tensor</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_geometry_tensor(strc, basis, conf=get_empty_config(); tmethod=get_tmethod(conf), rcut=get_rcut(conf))</code></pre><p>Constructs the geometry tensor based on the structure of the system, the orbital basis, and configuration settings.</p><p><strong>Arguments</strong></p><ul><li><code>strc</code>: The structure object, containing information about ions, lattice, and geometry of the system.</li><li><code>basis</code>: The basis object, containing the orbital information and overlap parameters.</li><li><code>conf</code>: Configuration object, defaults to an empty configuration if not provided.</li><li><code>tmethod</code>: Transformation method used for coordinate system alignment (default is obtained from the configuration).</li><li><code>rcut</code>: Cutoff distance for nearest neighbor interactions (default is obtained from the configuration).</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>tmethod</code>: The transformation method for aligning coordinate systems.</li><li><code>rcut</code>: The distance cutoff for nearest neighbor interactions.</li></ul><p><strong>Returns</strong></p><ul><li>The reshaped geometry tensor, represented as a matrix of sparse matrices, which encodes the overlap contributions for the system&#39;s orbital interactions for each parameter.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/basis.jl#L78-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_oc_and_mode_dicts-Tuple{Any, Any}" href="#Hamster.get_oc_and_mode_dicts-Tuple{Any, Any}"><code>Hamster.get_oc_and_mode_dicts</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_oc_and_mode_dicts(overlaps, ions)</code></pre><p>Generate dictionaries that map ion pairs to their respective orbital configuration (oc)  and mode types for each overlap configuration.</p><p><strong>Arguments</strong></p><ul><li><code>overlaps::Vector</code>: A collection of overlap configurations, where each element represents a different overlap calculation.</li><li><code>ions::Vector</code>: A vector of ion types, where each ion has a <code>type</code> field that identifies the specific ion type.</li></ul><p><strong>Returns</strong></p><ul><li><code>oc_dicts::Vector{Dict{IonLabel, Union{SymOrb, DefOrb, MirrOrb}}}</code>: A vector of dictionaries, each corresponding to one overlap configuration, mapping ion pairs (represented by <code>IonLabel</code>) to their respective orbital configuration (<code>SymOrb</code>, <code>DefOrb</code>, or <code>MirrOrb</code>).</li><li><code>mode_dicts::Vector{Dict{IonLabel, Union{NormalMode, ConjugateMode}}}</code>: A vector of dictionaries, each corresponding to one overlap configuration, mapping ion pairs (represented by <code>IonLabel</code>) to their respective mode type (<code>NormalMode</code> or <code>ConjugateMode</code>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/basis.jl#L210-L223">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_param_index-NTuple{7, Any}" href="#Hamster.get_param_index-NTuple{7, Any}"><code>Hamster.get_param_index</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_param_index(overlap, nnlabel, parameters, orb1, orb2, i, j) :: Int64</code></pre><p>Retrieve the index of a parameter that matches a given nearest neighbor label, overlap label,  orbital types, and ion labels. </p><p><strong>Arguments</strong></p><ul><li><code>overlap</code>: An object representing the overlap between two orbitals or ions.</li><li><code>nnlabel::Int</code>: The nearest neighbor (NN) label, identifying if this is a nearest neighbor interaction.</li><li><code>parameters::Vector</code>: A vector of parameter objects, each of which contains attributes such as <code>nnlabel</code>, <code>overlap_label</code>, and <code>ion_label</code>.</li><li><code>orb1</code>: The first orbital involved in the overlap.</li><li><code>orb2</code>: The second orbital involved in the overlap.</li><li><code>i::Int</code>: The index of the first orbital.</li><li><code>j::Int</code>: The index of the second orbital.</li></ul><p><strong>Returns</strong></p><ul><li><code>Int64</code>: The index <code>v</code> of the parameter in the <code>parameters</code> vector that matches the conditions. If no match is found, the function returns <code>0</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/basis.jl#L172-L189">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.nparams-Tuple{Basis}" href="#Hamster.nparams-Tuple{Basis}"><code>Hamster.nparams</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nparams(basis::Basis) -&gt; Int</code></pre><p>Return the number of TB overlap parameters defined in <code>basis</code>.</p><p><strong>Arguments</strong></p><ul><li><code>basis::Basis</code>: The <code>Basis</code> object containing orbitals for each ion in the system.</li></ul><p><strong>Returns</strong></p><ul><li><code>Int</code>: The total number of parameters.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/basis.jl#L65-L75">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.overlap_contributes_to_matrix_element-NTuple{4, Any}" href="#Hamster.overlap_contributes_to_matrix_element-NTuple{4, Any}"><code>Hamster.overlap_contributes_to_matrix_element</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">overlap_contributes_to_matrix_element(overlap, orb1, orb2, ion_label)</code></pre><p>Return true if <code>overlap</code> contributes to the matrix element between the orbitals <code>orb1</code> and <code>orb2</code> for <code>ion_label</code>.</p><p><strong>Arguments</strong></p><ul><li><code>overlap</code>: The overlap object, which contains information about the types of orbitals involved and the ion label.</li><li><code>orb1</code>: The first orbital.</li><li><code>orb2</code>: The second orbital.</li><li><code>ion_label</code>: The ion label to check if the overlap corresponds to the same type of ions as the orbitals.</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: Returns <code>true</code> if the overlap contributes to the matrix element, i.e., if the orbital types of <code>orb1</code> and <code>orb2</code> match the types in the overlap, and the <code>ion_label</code> matches.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/basis.jl#L152-L165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.reshape_geometry_tensor-NTuple{4, Any}" href="#Hamster.reshape_geometry_tensor-NTuple{4, Any}"><code>Hamster.reshape_geometry_tensor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reshape_geometry_tensor(h_dict, NV, NR, Nε)</code></pre><p>Reshapes the geometry tensor from a dictionary <code>h_dict</code> into a matrix of sparse matrices.</p><p><strong>Arguments</strong></p><ul><li><code>h_dict::Dict</code>: A dictionary where keys are tuples of the form <code>(v, i, j, R)</code> representing the tensor indices, and values are the corresponding tensor entries.</li><li><code>NV::Int</code>: Number of rows (vectors) in the reshaped matrix.</li><li><code>NR::Int</code>: Number of columns (points) in the reshaped matrix.</li><li><code>Nε::Int</code>: Not used explicitly in this function but typically represents the number of strain components.</li></ul><p><strong>Returns</strong></p><ul><li>A <code>NV x NR</code> matrix <code>h_out</code> where each element is a sparse matrix (<code>SparseMatrixCSC{Float64, Int64}</code>) formed by the corresponding indices and values from the input dictionary <code>h_dict</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/basis.jl#L245-L260">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_index_to_ion_orb_map-Tuple{Any}" href="#Hamster.get_index_to_ion_orb_map-Tuple{Any}"><code>Hamster.get_index_to_ion_orb_map</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_index_to_ion_orb_map(Norb) -&gt; Vector{Tuple{Int64, Int64}}</code></pre><p>Generate a mapping from basis state indices to corresponding ion and orbital indices.</p><p><strong>Arguments:</strong></p><ul><li><code>Norb</code>: A vector where each element represents the number of orbitals associated with each ion. </li></ul><p><strong>Returns:</strong></p><ul><li><code>index_map</code>: A vector of tuples where each tuple <code>(iion, iorb)</code> represents the ion and orbital index corresponding to <code>i</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/index.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_ion_and_orbital_indices-Tuple{Any, Any}" href="#Hamster.get_ion_and_orbital_indices-Tuple{Any, Any}"><code>Hamster.get_ion_and_orbital_indices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_ion_and_orbital_indices(Norb, index) -&gt; Tuple{Int64, Int64}</code></pre><p>Return the ion index <code>iion</code> and the orbital index <code>jorb</code> corresponding to the basis-state index <code>index</code> in the Hamiltonian matrix.</p><p><strong>Arguments:</strong></p><ul><li><code>Norb</code>: A vector where each element represents the number of orbitals for each ion. </li><li><code>index</code>: The basis-state index for which the corresponding ion and orbital indices are sought.</li></ul><p><strong>Returns:</strong></p><ul><li><code>iion</code>: The index of the ion corresponding to the given <code>index</code>.</li><li><code>jorb</code>: The index of the orbital for the ion <code>iion</code> corresponding to <code>index</code>.</li><li>If <code>index</code> is out of bounds, returns <code>(0, 0)</code> as a fallback.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/index.jl#L43-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_ion_orb_to_index_map-Tuple{Any}" href="#Hamster.get_ion_orb_to_index_map-Tuple{Any}"><code>Hamster.get_ion_orb_to_index_map</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_ion_orb_to_index_map(Norb) -&gt; Dict{Tuple{Int64, Int64}, Int64}</code></pre><p>Generate a mapping from ion and orbital indices to a basis state index.</p><p><strong>Arguments:</strong></p><ul><li><code>Norb</code>: A vector where each element represents the number of orbitals associated with each ion. </li></ul><p><strong>Returns:</strong></p><ul><li><code>ij_map</code>: A dictionary where each key is a tuple <code>(i_ion, i_orb)</code> representing the ion index <code>i_ion</code> and the  orbital index <code>i_orb</code>. The value corresponding to each key is the basis state index <code>i</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/index.jl#L21-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.IonLabel" href="#Hamster.IonLabel"><code>Hamster.IonLabel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">IonLabel(types::SVector{2, Int64})</code></pre><p>A structure representing a label for overlaps between two ions, characterized by a 2-element static vector of integers that indicate the ion species.</p><p><strong>Fields</strong></p><ul><li><code>types::SVector{2, Int64}</code>: A static vector containing two <code>Int64</code> values representing the types or identifiers associated with the ion. The use of <code>SVector{2, Int64}</code> ensures that the two types are stored efficiently as a fixed-size array.</li></ul><p><strong>Constructors</strong></p><ul><li><code>IonLabel(type1::Int64, type2::Int64; sorted=true)</code>: Creates an <code>IonLabel</code> from two integer types. If <code>sorted=true</code>, the types will be sorted before creating the label, ensuring consistent ordering.</li><li><code>IonLabel(type1::String, type2::String; sorted=true)</code>: Creates an <code>IonLabel</code> from two element symbols (as <code>String</code>s). Converts the symbols to atomic numbers and optionally sorts them if <code>sorted=true</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/label.jl#L7-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.isequal-Tuple{Hamster.IonLabel, Hamster.IonLabel}" href="#Base.isequal-Tuple{Hamster.IonLabel, Hamster.IonLabel}"><code>Base.isequal</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Base.isequal(ion_label1::IonLabel, ion_label2::IonLabel; sorted=false) -&gt; Bool</code></pre><p>Compares two <code>IonLabel</code> objects for equality. </p><p><strong>Arguments</strong></p><ul><li><code>ion_label1::IonLabel</code>: The first <code>IonLabel</code> instance to compare.</li><li><code>ion_label2::IonLabel</code>: The second <code>IonLabel</code> instance to compare.</li><li><code>sorted::Bool=false</code>: Whether to sort the <code>types</code> fields of both <code>IonLabel</code> instances before comparing them. Defaults to <code>false</code>. </li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: Returns <code>true</code> if the <code>IonLabel</code> instances are considered equal based on their <code>types</code> fields (with or without sorting), and <code>false</code> otherwise.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/label.jl#L27-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.string-Tuple{Hamster.IonLabel}" href="#Base.string-Tuple{Hamster.IonLabel}"><code>Base.string</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">string(ion_label::IonLabel) -&gt; String</code></pre><p>Converts an <code>IonLabel</code> object into a human-readable string representation, where the <code>types</code> are converted into their corresponding element symbols.</p><p><strong>Arguments</strong></p><ul><li><code>ion_label::IonLabel</code>: The <code>IonLabel</code> instance containing two atomic types represented as atomic numbers.</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: A string representation of the <code>IonLabel</code>, where the two element numbers are converted to their respective element symbols and concatenated with a <code>+</code> sign.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/label.jl#L42-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.aresameions-Tuple{Hamster.IonLabel}" href="#Hamster.aresameions-Tuple{Hamster.IonLabel}"><code>Hamster.aresameions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sameions(ion_label::IonLabel) -&gt; Bool</code></pre><p>Checks if both ions in the given <code>IonLabel</code> are of the same type.</p><p><strong>Arguments</strong></p><ul><li><code>ion_label::IonLabel</code>: The <code>IonLabel</code> object that contains two ion types represented as atomic numbers.</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: Returns <code>true</code> if both ions in the <code>IonLabel</code> have the same atomic number, meaning they are the same type of ion; otherwise, returns <code>false</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/label.jl#L55-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.areswapped-Tuple{Any, Any}" href="#Hamster.areswapped-Tuple{Any, Any}"><code>Hamster.areswapped</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">areswapped(type1, type2) -&gt; Bool</code></pre><p>Determines whether the two ion types <code>type1</code> and <code>type2</code> are swapped when creating an <code>IonLabel</code>.  This function returns <code>true</code> if the unsorted <code>IonLabel(type1, type2, sorted=false)</code> differs from the sorted <code>IonLabel(type1, type2)</code>,  indicating that the order of <code>type1</code> and <code>type2</code> was altered during sorting. Otherwise, it returns <code>false</code>.</p><p><strong>Arguments</strong></p><ul><li><code>type1</code>: The first ion type.</li><li><code>type2</code>: The second ion type.</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: <code>true</code> if the order of <code>type1</code> and <code>type2</code> is swapped in the sorted <code>IonLabel</code>, <code>false</code> otherwise.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/label.jl#L68-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_nn_label" href="#Hamster.get_nn_label"><code>Hamster.get_nn_label</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_nn_label(r, r_thresh, onsite, sepNN) :: Int64</code></pre><p>Returns the nearest neighbor (NN) label (0, 1, 2) for a matrix element based on the interatomic distance <code>r</code>, a nearest neighbor  threshold <code>r_thresh</code>, and flags for <code>onsite</code> and <code>sepNN</code> (separated nearest neighbors).</p><p><strong>Arguments</strong></p><ul><li><code>r::Float64</code>: The interatomic distance between two atoms.</li><li><code>r_thresh::Float64</code>: The threshold distance for determining nearest neighbors.</li><li><code>onsite::Bool</code>: A flag indicating if onsite interactions (i.e., when <code>r ≈ 0</code>) should be considered separately.</li><li><code>sepNN::Bool</code>: A flag indicating if nearest neighbors should be separated into multiple groups based on distance.</li></ul><p><strong>Returns</strong></p><ul><li>An integer label (<code>Int64</code>) representing the type of interaction.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/label.jl#L84-L98">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.string_to_overlap_label-Tuple{Any}" href="#Hamster.string_to_overlap_label-Tuple{Any}"><code>Hamster.string_to_overlap_label</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">string_to_overlap_label(overlap_string::String) -&gt; SVector{3, Int64}</code></pre><p>Converts an <code>overlap_string</code> into an overlap label, represented as a 3-element static vector of integers.  The overlap label consists of two angular momentum indices (<code>l1</code>, <code>l2</code>) and a magnetic quantum number (<code>m</code>).</p><p><strong>Arguments</strong></p><ul><li><code>overlap_string::String</code>: A string representing the overlap label. This string can indicate diagonal or off-diagonal onsite interactions or hybridized orbitals.</li></ul><p><strong>String Parsing</strong></p><ul><li>If the string contains <code>&quot;diag&quot;</code>, it represents a diagonal or off-diagonal onsite interaction.<ul><li>If it&#39;s diagonal, <code>l1</code> and <code>l2</code> will be the same value.</li><li>If it&#39;s off-diagonal, the string may represent hybrid orbitals or a combination of atomic and hybrid orbitals.</li><li>Based on the length of <code>ll_string</code>, <code>l1</code> and <code>l2</code> are parsed:<ul><li>Length 2: Represents two atomic orbitals (e.g., <code>&quot;diag12&quot;</code>).</li><li>Length 3: Combination of hybrid and atomic orbitals (e.g., <code>&quot;diag-12&quot;</code>).</li><li>Length 4: Only hybrid orbitals (e.g., <code>&quot;diag-1213&quot;</code>).</li></ul></li><li><code>m</code> is set to <code>0</code> for diagonal and <code>1</code> for off-diagonal onsite interactions to differentiate between them.</li></ul></li><li>If the string does not contain <code>&quot;diag&quot;</code>, it represents an offsite overlap, and <code>l1</code>, <code>l2</code>, and <code>m</code> are determined using lookup tables (<code>ldict_inv</code> and <code>mdict_inv</code>).</li></ul><p><strong>Returns</strong></p><ul><li><code>SVector{3, Int64}</code>: A static vector where:<ul><li><code>l1</code>: First angular momentum index.</li><li><code>l2</code>: Second angular momentum index.</li><li><code>m</code>: Magnetic quantum number (or other integer differentiating diagonal and off-diagonal cases).</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/label.jl#L115-L140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.DefOrb" href="#Hamster.DefOrb"><code>Hamster.DefOrb</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DefOrb()</code></pre><p>No symmetry in orbitals: orbital type in label has to be used in the same order as given.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/orbconfig.jl#L64-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.MirrOrb" href="#Hamster.MirrOrb"><code>Hamster.MirrOrb</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MirrOrb()</code></pre><p>No symmetry in orbitals: orbital type in label has to be used in reverse order as given.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/orbconfig.jl#L71-L75">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.OrbitalConfiguration" href="#Hamster.OrbitalConfiguration"><code>Hamster.OrbitalConfiguration</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">OrbitalConfiguration</code></pre><p>Abstract type for defining the configuration of orbitals w.r.t. to the overlap label for a specific TB overlap.</p><p>Subtypes:</p><ul><li><code>SymOrb</code>: Symmetry in orbitals allows for interchangeable orbital types in labels.</li><li><code>DefOrb</code>: No symmetry; the order of orbital types in labels must be preserved exactly.</li><li><code>MirrOrb</code>: Symmetry requires orbital types to be used in reverse order.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/orbconfig.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.OrbitalConfiguration-NTuple{4, Any}" href="#Hamster.OrbitalConfiguration-NTuple{4, Any}"><code>Hamster.OrbitalConfiguration</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">OrbitalConfiguration(Y1, Y2, Ys1, Ys2; sameions=true, ionswap=false) -&gt; OrbitalConfiguration</code></pre><p>Determine the <code>OrbitalConfiguration</code> type based on the symmetry and relationship between two orbitals, <code>Y1</code> and <code>Y2</code>,  and their corresponding sets <code>Ys1</code> and <code>Ys2</code>. This function decides the appropriate orbital symmetry configuration  based on the angular momentum and ion types involved.</p><p><strong>Arguments</strong></p><ul><li><code>Y1</code>: The first orbital (expected to have an <code>l</code> property for angular momentum).</li><li><code>Y2</code>: The second orbital (expected to have an <code>l</code> property for angular momentum).</li><li><code>Ys1</code>: Set of orbitals corresponding to the first ion.</li><li><code>Ys2</code>: Set of orbitals corresponding to the second ion.</li><li><code>sameions</code> (optional, default=true): A boolean indicating whether both orbitals belong to the same ion type.</li><li><code>ionswap</code> (optional, default=false): A boolean indicating whether the ion types are swapped in the configuration.</li></ul><p><strong>Returns:</strong></p><ul><li>Either <code>SymOrb</code>, <code>DefOrb</code> or <code>MirrOrb</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/orbconfig.jl#L13-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.SymOrb" href="#Hamster.SymOrb"><code>Hamster.SymOrb</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SymOrb()</code></pre><p>Symmetry in orbitals: orbital type in label can be interchanged.</p><p><strong>Example</strong></p><pre><code class="language-markdown hljs">&lt;Ga_pσ|As_pσ&gt;

In this case, both orbitals are equal and the label ppσ is symmetric.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/orbconfig.jl#L50-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_mode-NTuple{5, Any}" href="#Hamster.get_mode-NTuple{5, Any}"><code>Hamster.get_mode</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_mode(mode_dicts, kparam, ion_label, iorb, jorb)</code></pre><p>Retrieve the mode (<code>mode</code>) for a given ion label and orbital indices.</p><p><strong>Arguments</strong></p><ul><li><code>mode_dicts</code>: A vector of dictionaries where each dictionary maps <code>IonLabel</code>s to their respective mode (e.g., <code>NormalMode</code>, <code>ConjugateMode</code>). Each entry corresponds to a different k-point parameter (<code>kparam</code>).</li><li><code>kparam</code>: The k-point parameter index indicating which dictionary in <code>mode_dicts</code> to use.</li><li><code>ion_label</code>: The label identifying the ion pair for which the mode is needed.</li><li><code>iorb</code>: The index of the first orbital in the pair.</li><li><code>jorb</code>: The index of the second orbital in the pair.</li></ul><p><strong>Returns</strong></p><ul><li><code>mode</code>: The mode corresponding to the given <code>ion_label</code>, after potentially checking for a conjugate mode using <code>check_for_conjugate_mode</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/orbconfig.jl#L89-L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_orbconfig-NTuple{5, Any}" href="#Hamster.get_orbconfig-NTuple{5, Any}"><code>Hamster.get_orbconfig</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_orbconfig(oc_dicts, kparam, ion_label, iorb, jorb)</code></pre><p>Retrieve the orbital configuration (<code>orbconfig</code>) for a given ion label and orbital indices.</p><p><strong>Arguments</strong></p><ul><li><code>oc_dicts</code>: A vector of dictionaries where each dictionary maps <code>IonLabel</code>s to their respective orbital configurations (<code>orbconfig</code>). Each entry in the dictionary corresponds to a different k-point parameter (<code>kparam</code>).</li><li><code>kparam</code>: The k-point parameter index indicating which dictionary in <code>oc_dicts</code> to use.</li><li><code>ion_label</code>: The label identifying the ion pair for which the orbital configuration is needed.</li><li><code>iorb</code>: The index of the first orbital in the pair.</li><li><code>jorb</code>: The index of the second orbital in the pair.</li></ul><p><strong>Returns</strong></p><ul><li><code>orbconfig</code>: The orbital configuration (<code>orbconfig</code>) after potentially checking for a conjugate configuration using <code>check_for_conjugate_orbconfig</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/orbconfig.jl#L117-L131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Orbital" href="#Hamster.Orbital"><code>Hamster.Orbital</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Orbital{O&lt;:Angular}(ion_type::Int64, type::O, axis::SVector{3, Float64})</code></pre><p>Defines an orbital associated with an ion, characterized by its type, angular momentum properties, and orientation.</p><p><strong>Type Parameters</strong></p><ul><li><code>O&lt;:Angular</code>: Specifies the angular momentum type, such as s, p, or d orbitals.</li></ul><p><strong>Fields</strong></p><ul><li><code>ion_type::Int64</code>: An integer representing the type or species of the ion this orbital is associated with.</li><li><code>type::O</code>: The angular momentum type of the orbital, parameterized by <code>O</code>, which defines the orbital&#39;s angular properties (e.g., s, p, d orbitals).</li><li><code>axis::SVector{3, Float64}</code>: A 3D unit vector representing the orientation or axis of the orbital in Cartesian coordinates.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/orbital.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_axes" href="#Hamster.get_axes"><code>Hamster.get_axes</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_axes(iion::Int64, strc::Structure, orbital_list::Vector{Angular}, conf=get_empty_config(); NNaxes=get_nnaxes(conf, type))</code></pre><p>Compute the axes (or orientations) for a set of orbitals associated with a specific ion in a structure.</p><p><strong>Arguments</strong></p><ul><li><code>iion::Int64</code>: The index of the ion for which to compute the axes.</li><li><code>strc::Structure</code>: A <code>Structure</code> object representing the lattice and ion configuration.</li><li><code>orbital_list::Vector{Angular}</code>: A vector containing angular orbital types (e.g., <code>s</code>, <code>p</code>, <code>sp3</code>) for which axes need to be computed.</li><li><code>conf</code>: Configuration object (optional) that contains settings for computing axes. Default is <code>get_empty_config()</code>.</li><li><code>NNaxes</code>: A Boolean flag that determines whether to compute nearest-neighbor axes (<code>true</code>) or directly use predefined orbital axes (<code>false</code>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/orbital.jl#L68-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_axes_from_orbitals-Tuple{Vector{Vector{Hamster.Orbital}}}" href="#Hamster.get_axes_from_orbitals-Tuple{Vector{Vector{Hamster.Orbital}}}"><code>Hamster.get_axes_from_orbitals</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_axes_from_orbitals(orbitals::Vector{Vector{Orbitals}}]) -&gt; Vector{Matrix{3, Norb}}</code></pre><p>Reads the orbital axes from a nested Vector of <code>Orbital</code> and returns them as a Vector of matrices.</p><p><strong>Arguments</strong></p><ul><li><code>orbitals::Vector{Vector{Orbital}}</code>: A vector where each element is a vector of <code>Orbital</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/orbital.jl#L58-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_axis-Tuple{Hamster.sp3}" href="#Hamster.get_axis-Tuple{Hamster.sp3}"><code>Hamster.get_axis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_axis(h::HybridOrbital) -&gt; Vector{SVector{3, Float64}}
get_axis(o::AngularOrbital) -&gt; SVector{3, Float64}</code></pre><p>Returns the unit vector(s) representing the axis (or axes) of the given orbital type.</p><p><strong>Orbital Types and Axes</strong></p><ul><li><code>h::sp3</code>: Returns four unit vectors corresponding to the axes of <code>sp3</code> (or <code>sp3dr2</code>) hybrid orbitals: <code>[1, 1, 1]</code>, <code>[1, -1, -1]</code>, <code>[-1, 1, -1]</code>, <code>[-1, -1, 1]</code>.</li><li><code>o::s</code>: Returns the axis <code>[0, 0, 1]</code> for an <code>s</code> orbital.</li><li><code>o::px</code>: Returns the axis <code>[1, 0, 0]</code> for a <code>px</code> orbital.</li><li><code>o::py</code>: Returns the axis <code>[0, 1, 0]</code> for a <code>py</code> orbital.</li><li><code>o::pz</code>: Returns the axis <code>[0, 0, 1]</code> for a <code>pz</code> orbital.</li><li><code>o::pxdx2</code>: Returns the axis <code>[1, 0, 0]</code> for a combined <code>px/dx²</code> orbital.</li><li><code>o::pydy2</code>: Returns the axis <code>[0, 1, 0]</code> for a combined <code>py/dy²</code> orbital.</li><li><code>o::pzdz2</code>: Returns the axis <code>[0, 0, 1]</code> for a combined <code>pz/dz²</code> orbital.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/orbital.jl#L98-L113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_orbitals" href="#Hamster.get_orbitals"><code>Hamster.get_orbitals</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_orbitals(strc::Structure, conf=get_empty_config())</code></pre><p>Generate a list of orbitals for the ions in a given <code>Structure</code> object, using a configuration for the orbital types and axes.</p><p><strong>Arguments</strong></p><ul><li><code>strc::Structure</code>: The structure containing ions and their corresponding positions and types.</li><li><code>conf</code>: Configuration object that defines how to retrieve orbital information for the given ions. Defaults to <code>get_empty_config()</code> if no configuration is provided.</li></ul><p><strong>Returns</strong></p><ul><li><code>orbitals::Vector{Orbital}</code>: A vector of <code>Orbital</code> objects, where each orbital corresponds to a specific ion in the structure.</li></ul><p><strong>Details</strong></p><ul><li>The function loops over all ions in the given structure (<code>strc</code>), retrieves the orbital types for each ion based on the ion&#39;s type, and generates corresponding axes.</li><li>For each ion, it constructs the associated orbitals, considering the ion&#39;s type, angular properties, and orientation (axes).</li><li>It then stores the orbitals as <code>Orbital</code> objects in a vector.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/orbital.jl#L20-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.TBOverlap" href="#Hamster.TBOverlap"><code>Hamster.TBOverlap</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TBOverlap{T&lt;:MatrixElement, OC&lt;:OrbitalConfiguration}</code></pre><p>Represents a tight-binding (TB) overlap used in calculations, characterized by its type, orbital configuration, and ion label. This represents one interaction term.</p><p><strong>Fields</strong></p><ul><li><code>type::T</code>: Specifies the type of the TB overlap parameter, where <code>T</code> is a subtype of <code>MatrixElement</code>. This field indicates the specific kind of matrix element or overlap parameter.</li><li><code>orbconfig::OC</code>: Represents the <code>OrbitalConfiguration</code> associated with the TB overlap parameter.</li><li><code>ion_label::IonLabel</code>: Labels the ions that are involved in the interaction term.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/overlap.jl#L5-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Vddδ" href="#Hamster.Vddδ"><code>Hamster.Vddδ</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Vddδ</code></pre><p>Overlap parameter for overlaps between two d-orbitals with |m|=2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/overlap.jl#L358-L362">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Vddπ" href="#Hamster.Vddπ"><code>Hamster.Vddπ</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Vddπ</code></pre><p>Overlap parameter for overlaps between two d-orbitals with |m|=1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/overlap.jl#L339-L343">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Vddσ" href="#Hamster.Vddσ"><code>Hamster.Vddσ</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Vddσ</code></pre><p>Overlap parameter for overlaps between an s- and a d-orbital with |m|=0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/overlap.jl#L321-L325">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Vpdπ" href="#Hamster.Vpdπ"><code>Hamster.Vpdπ</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Vpdπ</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/overlap.jl#L296-L298">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Vpdσ" href="#Hamster.Vpdσ"><code>Hamster.Vpdσ</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Vpdσ</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/overlap.jl#L273-L275">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Vppπ" href="#Hamster.Vppπ"><code>Hamster.Vppπ</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Vppπ</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/overlap.jl#L234-L236">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Vppσ" href="#Hamster.Vppσ"><code>Hamster.Vppσ</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Vppσ</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/overlap.jl#L219-L221">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Vsdσ" href="#Hamster.Vsdσ"><code>Hamster.Vsdσ</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Vsdσ</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/overlap.jl#L250-L252">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Vspσ" href="#Hamster.Vspσ"><code>Hamster.Vspσ</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Vspσ</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/overlap.jl#L201-L203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Vssσ" href="#Hamster.Vssσ"><code>Hamster.Vssσ</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Vssσ</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/overlap.jl#L186-L188">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.isequal-Union{Tuple{OV2}, Tuple{OV1}, Tuple{OV1, OV2}} where {OV1, OV2&lt;:Hamster.TBOverlap}" href="#Base.isequal-Union{Tuple{OV2}, Tuple{OV1}, Tuple{OV1, OV2}} where {OV1, OV2&lt;:Hamster.TBOverlap}"><code>Base.isequal</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Base.isequal(ov1::TBOverlap, ov2::TBOverlap)</code></pre><p>Compare two <code>TBOverlap</code> objects, <code>ov1</code> and <code>ov2</code>, for equality.</p><p><strong>Arguments</strong></p><ul><li><code>ov1::TBOverlap</code>: The first <code>TBOverlap</code> instance.</li><li><code>ov2::TBOverlap</code>: The second <code>TBOverlap</code> instance.</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: <code>true</code> if the two <code>TBOverlap</code> instances are considered equal, <code>false</code> otherwise.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/overlap.jl#L21-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.string-Tuple{Hamster.TBOverlap}" href="#Base.string-Tuple{Hamster.TBOverlap}"><code>Base.string</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Base.string(p::TBOverlap; apply_oc=false)::String</code></pre><p>Converts a <code>TBOverlap</code> instance into a string, e.g., <code>&quot;Ga+As_ssσ&quot;</code><code>. If</code>apply_oc=true<code>, the</code>OrbitalConfiguration<code>is taken into account.  This is only relevant for</code>orbconfig&lt;:MirrOrb<code>, where the order of orbitals in the label is inverted, e.g., the overlap</code>spσ`<code>with</code>orbconfig&lt;:MirrOrb<code>would become</code>psσ`.</p><p><strong>Arguments</strong></p><ul><li><code>p::TBOverlap</code>: The <code>TBOverlap</code> instance to be converted into a string.</li><li><code>apply_oc::Bool</code>: A flag indicating whether to apply orbital configuration-specific formatting.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/overlap.jl#L102-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.NConst-Tuple{Hamster.NormalMode, Any, Any, Any}" href="#Hamster.NConst-Tuple{Hamster.NormalMode, Any, Any, Any}"><code>Hamster.NConst</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NConst(baseorb, l₁, l₂)</code></pre><p>Determine the normalization constant for the matrix element between orbitals in <code>baseorb</code> with respective components <code>l₁</code> and <code>l₂</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/overlap.jl#L170-L175">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.decide_orbconfig-Tuple{Hamster.TBOverlap, Hamster.IonLabel}" href="#Hamster.decide_orbconfig-Tuple{Hamster.TBOverlap, Hamster.IonLabel}"><code>Hamster.decide_orbconfig</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">decide_orbconfig(Vllm, ion_label)</code></pre><p>Conjugate the orbital configuration if the sorted ion overlap label of the TB parameter <code>Vllm</code> is the conjugate of the actual ion overlap label <code>ion_label</code> of the respective Hamiltonian matrix element.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/overlap.jl#L159-L164">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_baseorb_ls-Tuple{Hamster.TBOverlap}" href="#Hamster.get_baseorb_ls-Tuple{Hamster.TBOverlap}"><code>Hamster.get_baseorb_ls</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_baseorb_ls(overlap::TBOverlap) -&gt; Tuple{Int, Int}</code></pre><p>Extract the orbital angular momentum quantum numbers <code>l</code> for the two orbitals in the <code>baseorb</code> field of  the given <code>TBOverlap</code> object.</p><p><strong>Arguments</strong></p><ul><li><code>overlap::TBOverlap</code>: A <code>TBOverlap</code> object representing the overlap between two orbitals in a tight-binding model.  The <code>baseorb</code> field contains information about the two orbitals.</li></ul><p><strong>Returns</strong></p><ul><li>A tuple <code>(l1, l2)</code> where <code>l1</code> is the angular momentum quantum number of the first orbital and  <code>l2</code> is that of the second orbital.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/overlap.jl#L128-L141">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_overlaps" href="#Hamster.get_overlaps"><code>Hamster.get_overlaps</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_overlaps(ions, orbitals, conf=get_empty_config())</code></pre><p>Compute all tight-binding (TB) overlaps between pairs of orbitals for a given list of ions.</p><p><strong>Arguments</strong></p><ul><li><code>ions</code>: A vector of ions from which overlaps are to be computed.</li><li><code>orbitals</code>: A vector of orbitals corresponding to each ion in <code>ions</code>.</li><li><code>conf</code>: Optional configuration parameter (default: <code>get_empty_config()</code>).</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{TBOverlap}</code>: A vector containing all computed <code>TBOverlap</code> instances for the ion and orbital pairs.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/overlap.jl#L40-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_overlaps_for_orbitals-NTuple{4, Any}" href="#Hamster.get_overlaps_for_orbitals-NTuple{4, Any}"><code>Hamster.get_overlaps_for_orbitals</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_overlaps_for_orbitals(orbitals_1, orbitals_2, ion_label, ionswap)</code></pre><p>Compute the list of tight-binding (TB) overlaps for pairs of orbitals from two ions (<code>orbitals_1</code> and <code>orbitals_2</code>) based on the given <code>ion_label</code> and whether the ions are swapped (<code>ionswap</code>).</p><p><strong>Arguments</strong></p><ul><li><code>orbitals_1</code>: A collection of orbitals from the first ion.</li><li><code>orbitals_2</code>: A collection of orbitals from the second ion.</li><li><code>ion_label</code>: An <code>IonLabel</code> instance representing the ion types involved in the interaction.</li><li><code>ionswap</code>: A boolean flag indicating if the ions are swapped in the interaction.</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{TBOverlap}</code>: A unique list of <code>TBOverlap</code> instances describing the possible overlaps between the orbitals of the two ions, taking into account symmetry and ion swaps.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/overlap.jl#L69-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.me_to_overlap_label-Tuple{Any}" href="#Hamster.me_to_overlap_label-Tuple{Any}"><code>Hamster.me_to_overlap_label</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">me_to_overlap_label(me::MatrixElement) -&gt; SVector{3, Int64}</code></pre><p>Converts the matrix element <code>me</code> to an overlap label with l, l&#39;, m as a static array.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/overlap.jl#L121-L125">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.same_ion_label-Tuple{Hamster.TBOverlap, Hamster.IonLabel}" href="#Hamster.same_ion_label-Tuple{Hamster.TBOverlap, Hamster.IonLabel}"><code>Hamster.same_ion_label</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">same_ion_label(Vllm, ion_label)</code></pre><p>Return <code>true</code> if the TB overlap <code>Vllm</code> has the ion overlap ion label <code>ion_label</code> independently if either is sorted.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/overlap.jl#L144-L148">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.ParameterLabel" href="#Hamster.ParameterLabel"><code>Hamster.ParameterLabel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ParameterLabel(nnlabel::Int64, ion_label::IonLabel, overlap_label::SVector{3, Int64})</code></pre><p>Represents a tight-binding (TB) parameter label by uniquely identifying it based on its nearest neighbor (NN) label, ion label,  and overlap label.</p><p><strong>Fields</strong></p><ul><li><code>nnlabel::Int64</code>: An integer representing the nearest neighbor (NN) label, which identifies a specific neighbor interaction.</li><li><code>ion_label::IonLabel</code>: An <code>IonLabel</code> object representing the two ion types involved in the TB parameter.</li><li><code>overlap_label::SVector{3, Int64}</code>: A 3D static vector representing the overlap label in terms of <code>ll&#39;m</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/param.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.string-Tuple{ParameterLabel}" href="#Base.string-Tuple{ParameterLabel}"><code>Base.string</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">string(param_label::ParameterLabel) -&gt; String</code></pre><p>Returns a string representation of the <code>ParameterLabel</code> object by concatenating its nearest neighbor label (<code>nnlabel</code>), ion label (<code>ion_label</code>), and overlap label (<code>overlap_label</code>).</p><p><strong>Arguments</strong></p><ul><li><code>param_label::ParameterLabel</code>: The <code>ParameterLabel</code> object containing information about nearest neighbors, ions, and overlap.</li></ul><p><strong>String Formatting</strong></p><ul><li>Nearest neighbor (<code>nnlabel</code>) is prefixed with <code>&quot;NN&quot;</code> (e.g., <code>&quot;NN1&quot;</code>).</li><li>Ion label is converted to string using <code>string(param_label.ion_label)</code>.</li><li>The overlap string is constructed based on the <code>nnlabel</code> value:<ul><li>For <code>nnlabel ≠ 0</code>: The overlap string is constructed from <code>ldict</code> and <code>mdict</code> dictionaries using the first two elements of <code>overlap_label</code>.</li><li>For <code>nnlabel == 0</code>:<ul><li>If <code>overlap_label[3] == 0</code>: The overlap string is <code>&quot;diag&quot;</code> followed by the angular momentum index <code>l</code>.</li><li>Otherwise, the overlap string is <code>&quot;offdiag&quot;</code> followed by two angular momentum indices <code>l1</code> and <code>l2</code>.</li></ul></li></ul></li></ul><p><strong>Returns</strong></p><ul><li>A concatenated string in the form, e.g., <code>NN1_Ga+As_ssσ</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/param.jl#L20-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.check_consistency-Tuple{Any, Config}" href="#Hamster.check_consistency-Tuple{Any, Config}"><code>Hamster.check_consistency</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_consistency(conf_values, conf::Config) -&gt; Bool</code></pre><p>Checks the consistency of configuration values from a file with the given <code>Config</code> object.</p><p><strong>Arguments</strong></p><ul><li><code>conf_values::Dict{String, String}</code>: A dictionary of configuration values read from the file (e.g., <code>rcut</code>, <code>onsite</code>, <code>sepNN</code>, <code>_n</code>, and <code>_alpha</code> values).</li><li><code>conf::Config</code>: A <code>Config</code> object containing the expected values for comparison.</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: Returns <code>true</code> if all values in <code>conf_values</code> are consistent with the values in <code>conf</code>, otherwise returns <code>false</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/param.jl#L296-L307">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_ion_types_from_parameters-Tuple{Any}" href="#Hamster.get_ion_types_from_parameters-Tuple{Any}"><code>Hamster.get_ion_types_from_parameters</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_ion_types_from_parameters(parameters) -&gt; Vector{String}</code></pre><p>Extract and return a unique list of ion types from a given list of <code>parameters</code>. </p><p>Each parameter contains an <code>ion_label</code> that consists of two ion types concatenated by a <code>&quot;+&quot;</code> sign. This function splits the ion labels, and collects the unique ion types into a single vector.</p><p><strong>Arguments</strong></p><ul><li><code>parameters::Vector</code>: A vector of parameter objects where each parameter has an <code>ion_label</code>.</li></ul><p><strong>Returns</strong></p><ul><li>A vector of unique ion types (as strings) extracted from the <code>ion_label</code> field of the parameters.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/param.jl#L96-L108">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_onsite_parameters!-Tuple{Any, Any}" href="#Hamster.get_onsite_parameters!-Tuple{Any, Any}"><code>Hamster.get_onsite_parameters!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_onsite_parameters!(parameters::Vector{ParameterLabel}, overlaps::Vector{TBOverlap})</code></pre><p>Populate the <code>parameters</code> vector with onsite tight-binding parameters based on the given <code>overlaps</code> between orbitals.</p><p>This function identifies onsite interaction terms (where both orbitals belong to the same ion) and adds corresponding  <code>ParameterLabel</code> objects to the <code>parameters</code> vector. These labels represent the interaction of orbitals of the same  type (onsite) and account for angular momentum quantum numbers (<code>l₁</code>, <code>l₂</code>).</p><p><strong>Arguments</strong></p><ul><li><code>parameters::Vector{ParameterLabel}</code>: A vector of tight-binding parameter labels, which will be populated with new onsite parameters.</li><li><code>overlaps::Vector{TBOverlap}</code>: A vector of <code>TBOverlap</code> objects representing the overlap between orbitals. The function filters those with the same ion type for onsite interactions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/param.jl#L140-L152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_parameter_for_nn_label!-Tuple{Any, Any, Any}" href="#Hamster.get_parameter_for_nn_label!-Tuple{Any, Any, Any}"><code>Hamster.get_parameter_for_nn_label!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_parameter_for_nn_label!(parameters::Vector{ParameterLabel}, overlaps::Vector{TBOverlap}, nn_label::Int)</code></pre><p>Populate the <code>parameters</code> vector with tight-binding parameters for a given nearest-neighbor (NN) interaction label (<code>nn_label</code>),  based on the provided orbital overlaps.</p><p>This function takes a list of orbital overlaps and assigns them a specified nearest-neighbor label (<code>nn_label</code>), creating  a <code>ParameterLabel</code> for each overlap. These labels capture the interaction between orbitals at different distances (nearest-neighbor interactions).</p><p><strong>Arguments</strong></p><ul><li><code>parameters::Vector{ParameterLabel}</code>: A vector of tight-binding parameter labels to be populated with new nearest-neighbor parameters.</li><li><code>overlaps::Vector{TBOverlap}</code>: A vector of <code>TBOverlap</code> objects representing the overlaps between orbitals.</li><li><code>nn_label::Int</code>: The nearest-neighbor label that defines the type of interaction (e.g., first-nearest-neighbor, second-nearest-neighbor).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/param.jl#L170-L183">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_parameters_from_overlaps" href="#Hamster.get_parameters_from_overlaps"><code>Hamster.get_parameters_from_overlaps</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_parameters_from_overlaps(overlaps::Vector{TBOverlap}, conf::Config=get_empty_config(); sepNN::Bool=get_sepNN(conf), onsite::Bool=get_onsite(conf)) -&gt; Vector{ParameterLabel}</code></pre><p>Generate tight-binding parameters (<code>ParameterLabel</code>) from orbital overlaps, including onsite and nearest-neighbor interactions.</p><p>This function computes a list of <code>ParameterLabel</code> objects based on the given orbital overlaps. It determines whether to include  onsite parameters, first-nearest-neighbor (NN) parameters, and optionally second-nearest-neighbor (NN) parameters, depending on the  configuration.</p><p><strong>Arguments</strong></p><ul><li><code>overlaps::Vector{TBOverlap}</code>: A vector of orbital overlap objects representing the interactions between orbitals.</li><li><code>conf::Config</code>: A configuration object that specifies how parameters should be generated (default is an empty config).</li><li><code>sepNN::Bool</code>: A keyword argument (default from <code>conf</code>) indicating whether second-nearest-neighbor interactions should be included (<code>true</code> if included, <code>false</code> otherwise).</li><li><code>onsite::Bool</code>: A keyword argument (default from <code>conf</code>) indicating whether onsite parameters should be included (<code>true</code> if included, <code>false</code> otherwise).</li></ul><p><strong>Returns</strong></p><ul><li>A <code>Vector{ParameterLabel}</code> containing the tight-binding parameters based on the overlaps, including:<ul><li>Onsite parameters (if <code>onsite=true</code>).</li><li>First-nearest-neighbor parameters (always included).</li><li>Second-nearest-neighbor parameters (if <code>sepNN=true</code>).</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/param.jl#L111-L131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.read_params" href="#Hamster.read_params"><code>Hamster.read_params</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_params(filename=&quot;params.dat&quot;)</code></pre><p>Reads and parses a parameter file generated by <code>write_params</code> into tight-binding (TB) parameters, parameter values, ion types, SOC parameters, and system configuration.</p><p><strong>Arguments</strong></p><ul><li><code>filename::String=&quot;params.dat&quot;</code>: The name of the file to read (default is <code>&quot;params.dat&quot;</code>).</li></ul><p><strong>Returns</strong></p><ul><li><code>parameters::Vector{ParameterLabel}</code>: A vector of TB parameter labels.</li><li><code>parameter_values::Vector{Float64}</code>: A vector of corresponding TB parameter values.</li><li><code>ion_types::Vector{String}</code>: A vector of ion types for which SOC parameters are defined (if any).</li><li><code>soc_parameters::Vector{Float64}</code>: A vector of SOC parameters corresponding to the <code>ion_types</code> (if any).</li><li><code>conf_values::Dict{String, String}</code>: A dictionary containing the configuration values from the header section (if present), such as system type, <code>rcut</code>, <code>onsite</code>, etc.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/param.jl#L248-L262">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.same_param_label-NTuple{4, Any}" href="#Hamster.same_param_label-NTuple{4, Any}"><code>Hamster.same_param_label</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">same_param_label(nnlabel::Int64, ion_label::IonLabel, overlap_label::SVector{3, Int64}, param_label::ParameterLabel) -&gt; Bool</code></pre><p>Check if the given nearest-neighbor label (<code>nnlabel</code>), ion label (<code>ion_label</code>), and overlap label (<code>overlap_label</code>) are the same as those in the <code>param_label</code>.</p><p><strong>Arguments</strong></p><ul><li><code>nnlabel::Int64</code>: The nearest-neighbor label to compare with the <code>nnlabel</code> in <code>param_label</code>.</li><li><code>ion_label::IonLabel</code>: The ion label to compare with the <code>ion_label</code> in <code>param_label</code>.</li><li><code>overlap_label::SVector{3, Int64}</code>: The overlap label to compare with the <code>overlap_label</code> in <code>param_label</code>.</li><li><code>param_label::ParameterLabel</code>: The parameter label to compare against.</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: Returns <code>true</code> if all components (<code>nnlabel</code>, <code>ion_label</code>, <code>overlap_label</code>) match those of the given <code>param_label</code>, otherwise returns <code>false</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/param.jl#L73-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.string_to_param_label-Tuple{Any}" href="#Hamster.string_to_param_label-Tuple{Any}"><code>Hamster.string_to_param_label</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">string_to_param_label(string_label)</code></pre><p>Convert a string parameter label <code>string_label</code> to a <code>ParameterLabel</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/param.jl#L59-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.write_params" href="#Hamster.write_params"><code>Hamster.write_params</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_params(parameters::Vector, parameter_values::Vector, ion_types::Vector=[], soc_parameters::Vector=[], conf::Config=get_empty_config(); filename=&quot;params&quot;)
write_params(parameters, parameter_values, conf::Config; filename=&quot;params&quot;)</code></pre><p>Writes the tight-binding (TB) parameters, system configuration, and optional spin-orbit coupling (SOC) parameters to a <code>.dat</code> file.</p><p><strong>Arguments</strong></p><ul><li><code>parameters::Vector</code>: A vector of TB parameter labels (<code>ParameterLabel</code>) that describe the system.</li><li><code>parameter_values::Vector</code>: A vector of parameter values corresponding to the <code>parameters</code>.</li><li><code>ion_types::Vector=[]</code>: A vector of ion types for which SOC parameters are defined (optional).</li><li><code>soc_parameters::Vector=[]</code>: A vector of SOC parameters corresponding to the ion types (optional).</li><li><code>conf::Config</code>: A configuration object that holds various settings for the system (e.g., system type, <code>rcut</code>, <code>onsite</code>, etc.).</li><li><code>filename::String=&quot;params&quot;</code>: The base filename (without extension) for the output file (optional, default is <code>&quot;params&quot;</code>).</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>filename</code>: The name of the file (excluding the extension) to which the data will be written (default: <code>&quot;params&quot;</code>).</li></ul><p><strong>File Format</strong></p><p>The file written contains the following:</p><ol><li><strong>System configuration block</strong>: Includes details like <code>rcut</code>, <code>onsite</code>, <code>sepNN</code>, and alpha/n values for each unique ion type.</li><li><strong>Tight-binding parameters</strong>: Parameters and corresponding values, formatted to align in a readable manner.</li><li><strong>SOC parameters</strong> (optional): SOC values for each ion type, if provided.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/param.jl#L192-L214">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.distance_dependence-NTuple{5, Any}" href="#Hamster.distance_dependence-NTuple{5, Any}"><code>Hamster.distance_dependence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">distance_dependence(ME::MatrixElement, orbconfig::OrbitalConfiguration, r, ns, αs)</code></pre><p>Computes the distance-dependent interaction between two orbitals, based on their matrix element <code>ME</code> and orbital configuration <code>orbconfig</code>.</p><p><strong>Arguments</strong></p><ul><li><code>ME::MatrixElement</code>: The matrix element representing the interaction type.</li><li><code>orbconfig::OrbitalConfiguration</code>: The configuration of the orbitals involved in the interaction, which determines the orbital angular momenta.</li><li><code>r</code>: The distance between the two orbitals in the interaction.</li><li><code>ns</code>: A vector containing the quantum numbers <code>n</code> for the two orbitals.</li><li><code>αs</code>: A vector containing the exponential decay factors <code>α</code> for the two orbitals.</li></ul><p><strong>Returns</strong></p><ul><li>The integral <code>I</code> of the overlap function between the two orbitals over the given distance <code>r</code>, modified by a sign factor if necessary.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/rllm.jl#L90-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.fcut-Tuple{Any, Any}" href="#Hamster.fcut-Tuple{Any, Any}"><code>Hamster.fcut</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fcut(r, rcut)</code></pre><p>Cut-off function whose value smoothly transitions to zero as <code>r</code> approaches <code>rcut</code>. Ensures continuity by using a cosine-based smoothing function.</p><p><strong>Arguments</strong></p><ul><li><code>r</code>: The input distance.</li><li><code>rcut</code>: The cutoff radius beyond which the function returns zero.</li><li><code>rcut_tol</code>: A tolerance applied to the cut-off radius, can be positive or negative.</li></ul><p><strong>Returns</strong></p><ul><li>A smoothly varying value between 1 and 0, with <code>fcut(r, rcut) = 0</code> for <code>r &gt; rcut</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/rllm.jl#L1-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_rllm" href="#Hamster.get_rllm"><code>Hamster.get_rllm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_rllm(overlaps, conf=get_empty_config(); load_rllm=get_load_rllm(conf), rllm_file=get_rllm_file(conf), interpolate_rllm=get_interpolate_rllm(conf))</code></pre><p>Retrieves or computes the radial orbital integral look-up table (RLLM) for a given set of overlaps, based on configuration settings.</p><p><strong>Arguments</strong></p><ul><li><code>overlaps::Vector</code>: A list of overlap objects for which RLLM data is required.</li><li><code>conf::Config</code>: Configuration object controlling the behavior of RLLM retrieval or generation. Defaults to an empty configuration.</li><li><code>load_rllm::Bool</code>: (Keyword argument) If <code>true</code>, load the RLLM data from a file. The file location is provided by <code>rllm_file</code>. Defaults to the value from <code>conf</code>.</li><li><code>rllm_file::String</code>: (Keyword argument) Filename for loading or saving the RLLM data. Defaults to the value from <code>conf</code>.</li><li><code>interpolate_rllm::Bool</code>: (Keyword argument) If <code>true</code>, interpolate new RLLM data based on the overlaps and save it to a file. Defaults to the value from <code>conf</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>rllm_dict::Dict{String, CubicSpline}</code>: A dictionary mapping overlap string representations to cubic spline interpolations of the radial integrals. If <code>load_rllm</code> is <code>true</code>, the data is read from the file. If <code>interpolate_rllm</code> is <code>true</code>, it is interpolated and saved.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/rllm.jl#L35-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.interpolate_overlap-Tuple{Any, Config}" href="#Hamster.interpolate_overlap-Tuple{Any, Config}"><code>Hamster.interpolate_overlap</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">interpolate_overlap!(overlap, conf::Config)</code></pre><p>Interpolates an overlap and stores the resulting cubic spline in the overlap&#39;s <code>rllm</code> field.</p><p><strong>Arguments</strong></p><ul><li><code>overlap</code>: An overlap object that contains information about the interaction type and orbital configuration.</li><li><code>conf::Config</code>: A configuration object that provides values for parameters such as <code>n</code> and <code>α</code> for each ion type involved in the overlap.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/rllm.jl#L71-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.read_rllm" href="#Hamster.read_rllm"><code>Hamster.read_rllm</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_rllm(filename=&quot;rllm.dat&quot;) -&gt; Dict{String, Tuple{Vector{Float64}, Vector{Float64}}}</code></pre><p>Reads the <code>rllm.dat</code> file and returns a dictionary mapping overlap labels to tuples of vectors containing the <code>x</code> and <code>y</code> values.</p><p><strong>Arguments</strong></p><ul><li><code>filename::String</code>: The name of the file containing Rllm data. Defaults to <code>&quot;rllm.dat&quot;</code>.</li></ul><p><strong>Returns</strong></p><ul><li>A dictionary where each key is an overlap label, and each value a tuple of x/y value vectors.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/rllm.jl#L143-L153">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.save_rllm-Tuple{Any}" href="#Hamster.save_rllm-Tuple{Any}"><code>Hamster.save_rllm</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_rllm(overlaps; filename=&quot;rllm.dat&quot;)</code></pre><p>Saves overlap data, including the associated Rllm values, to a file.</p><p><strong>Arguments</strong></p><ul><li><code>overlaps</code>: A collection of overlap objects, where each overlap contains an <code>rllm</code> field with <code>xs</code> (x values) and <code>ys</code> (y values).</li><li><code>filename::String</code>: The name of the file where the Rllm data will be saved. Defaults to <code>&quot;rllm.dat&quot;</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/rllm.jl#L118-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.fs-Tuple{Any, Any, Hamster.Angular}" href="#Hamster.fs-Tuple{Any, Any, Hamster.Angular}"><code>Hamster.fs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Define rotation coefficients.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/sh_transforms.jl#L23-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_base_orb-Union{Tuple{Tuple{A1, A2}}, Tuple{A2}, Tuple{A1}} where {A1, A2&lt;:Hamster.Angular}" href="#Hamster.get_base_orb-Union{Tuple{Tuple{A1, A2}}, Tuple{A2}, Tuple{A1}} where {A1, A2&lt;:Hamster.Angular}"><code>Hamster.get_base_orb</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">baseorb logic</code></pre><p>The baseorb of px, py, pz should be the same since since one can transform one into  the other by rotation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/sh_transforms.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Angular" href="#Hamster.Angular"><code>Hamster.Angular</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Angular</code></pre><p>Angular parts of real atomic orbitals.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/sper_harm.jl#L169-L173">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.OrbitalFunction" href="#Hamster.OrbitalFunction"><code>Hamster.OrbitalFunction</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">(orb::OrbitalFunction)(r⃗)</code></pre><p>Evaluate the orbital <code>orb</code> at the point <code>r⃗</code>, which can be one- or two-dimensional or a tuple including the norm.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/sper_harm.jl#L49-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Overlap" href="#Hamster.Overlap"><code>Hamster.Overlap</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Overlap(Ψ₁, r⃗₁, Ψ₂, r⃗₂)</code></pre><p>Struct to calculate the overlap integral between two wavefunctions with centers <code>r⃗₁</code> and <code>r⃗₂</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/sper_harm.jl#L292-L297">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Radial" href="#Hamster.Radial"><code>Hamster.Radial</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Radial</code></pre><p>Radial parts for atomic s orbitals with n=1,2,3,4,5,6.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/sper_harm.jl#L81-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_spherical-Tuple{Any, Any}" href="#Hamster.get_spherical-Tuple{Any, Any}"><code>Hamster.get_spherical</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_spherical(l, m)</code></pre><p>Returns the spherical harmonic function for a given orbital angular momentum quantum number <code>l</code> and magnetic quantum number <code>m</code>.</p><p><strong>Arguments</strong></p><ul><li><code>l::Int</code>: The orbital angular momentum quantum number (<code>l = 0</code> for <code>s</code>, <code>l = 1</code> for <code>p</code>, <code>l = 2</code> for <code>d</code>, etc.).</li><li><code>m::Int</code>: The magnetic quantum number, which ranges from <code>-l</code> to <code>l</code>.</li></ul><p><strong>Returns</strong></p><ul><li>The corresponding spherical harmonic function as a vector, based on the values of <code>l</code> and <code>m</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/sper_harm.jl#L32-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.str_to_orb-Tuple{Any}" href="#Hamster.str_to_orb-Tuple{Any}"><code>Hamster.str_to_orb</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">str_to_orb(str::String)</code></pre><p>Convert an orbital name given as a string to its corresponding orbital object.</p><p><strong>Arguments</strong></p><ul><li><code>str::String</code>: The name of the orbital as a string. Valid strings include <code>&quot;s&quot;</code>, <code>&quot;px&quot;</code>, <code>&quot;py&quot;</code>, <code>&quot;pz&quot;</code>, <code>&quot;dz2&quot;</code>, <code>&quot;dxy&quot;</code>, <code>&quot;dxz&quot;</code>, <code>&quot;dyz&quot;</code>, <code>&quot;dx2_y2&quot;</code>, <code>&quot;sp3&quot;</code>, <code>&quot;sp3dr2&quot;</code>, <code>&quot;pxdx2&quot;</code>, <code>&quot;pydy2&quot;</code>, and <code>&quot;pzdz2&quot;</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>Orbital</code>: The corresponding orbital object based on the input string.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/basis/sper_harm.jl#L1-L11">source</a></section></article><h1 id="Structure"><a class="docs-heading-anchor" href="#Structure">Structure</a><a id="Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Structure" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.PointGrid" href="#Hamster.PointGrid"><code>Hamster.PointGrid</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PointGrid(rs_ion, Ts, conf::TBConfig) -&gt; PointGrid</code></pre><p>Constructs a <code>PointGrid</code> for managing atomic positions within a 3D simulation cell. </p><p>The function takes atomic positions <code>rs_ion</code>, lattice translation vectors <code>Ts</code>, and a <code>TBConfig</code> configuration object as input, and returns a <code>PointGrid</code> object that organizes these atomic positions into a grid of cubic cells.</p><p><strong>Arguments:</strong></p><ul><li><code>rs_ion</code>: A collection (e.g., array) of atomic positions in real space.</li><li><code>Ts</code>: A collection of lattice translation vectors, typically used for defining the periodic boundaries of the simulation cell.</li><li><code>conf::Config</code>: A configuration object containing parameters necessary for setting up the <code>PointGrid</code>, such as the grid size.</li></ul><p><strong>Returns:</strong></p><ul><li><code>PointGrid</code>: A <code>PointGrid</code> object that partitions the real-space simulation cell into a grid and maps atomic positions to these grid cells.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/grid.jl#L21-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.PointGrid" href="#Hamster.PointGrid"><code>Hamster.PointGrid</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PointGrid</code></pre><p>A data structure for organizing and managing points in a 3D simulation cell by dividing the space into equally-sized cubic boxes. </p><p>The <code>PointGrid</code> structure stores grid points for atom positions, allowing for efficient spatial queries and neighbor searches.</p><p><strong>Fields:</strong></p><ul><li><code>grid_size::Float64</code>: The size of each cubic grid cell in real space.</li><li><code>dict0::Dict{SVector{3, Int64}, Vector{Int64}}</code>: A dictionary that maps grid cell indices to a vector of point indices (e.g., atoms) within that cell.</li><li><code>dictR::Dict{SVector{3, Int64}, Vector{Tuple{Int64, Int64}}}</code>: A dictionary that maps grid cell indices to a vector of tuples. Each tuple contains an atom index and a corresponding replica index, facilitating the handling of periodic boundary conditions.</li><li><code>num_points::Int64</code>: The total number of points (e.g., atoms) managed by the grid.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/grid.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_grid_dict-Tuple{Any, Any, Any}" href="#Hamster.get_grid_dict-Tuple{Any, Any, Any}"><code>Hamster.get_grid_dict</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_grid_dict(rs, Ts, grid_size; δrs=zeros(3, size(rs, 2)))</code></pre><p>Constructs a point grid for ion positions <code>rs</code>, considering all translation vectors <code>Ts</code>.</p><p><strong>Arguments</strong></p><ul><li><code>rs::AbstractMatrix</code>: A 3×N matrix where each column represents the position of an ion in 3D space.</li><li><code>Ts::AbstractMatrix</code>: A 3×M matrix where each column represents a translation vector.</li><li><code>grid_size::Real</code>: The size of the grid cells used to map the ion positions and their translations.</li></ul><p><strong>Returns</strong></p><ul><li><code>grid_dict::Dict{SVector{3, Int64}, Vector{Tuple{Int64, Int64}}}</code>:    A dictionary where the keys are grid points (represented as static 3D integer vectors <code>SVector{3, Int64}</code>),   and the values are vectors of tuples <code>(iion, R)</code>, where <code>iion</code> is the index of the ion and <code>R</code> is the index of the translation vector.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/grid.jl#L65-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_grid_dict-Tuple{Any, Any}" href="#Hamster.get_grid_dict-Tuple{Any, Any}"><code>Hamster.get_grid_dict</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_grid_dict(rs, grid_size)</code></pre><p>Constructs a spatial grid based on the ion positions <code>rs</code>, mapping each position to a grid point determined by <code>grid_size</code>.</p><p><strong>Arguments</strong></p><ul><li><code>rs::AbstractMatrix</code>: A 3×N matrix where each column represents the position of an ion in 3D space.</li><li><code>grid_size::Real</code>: The size of the grid cells used to map the ion positions.</li></ul><p><strong>Returns</strong></p><ul><li><code>grid_dict::Dict{SVector{3, Int64}, Vector{Int64}}</code>:    A dictionary where the keys are grid points (represented as static 3D integer vectors <code>SVector{3, Int64}</code>),   and the values are vectors of ion indices corresponding to the ions located at that grid point.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/grid.jl#L42-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_grid_point-Tuple{Any, Any}" href="#Hamster.get_grid_point-Tuple{Any, Any}"><code>Hamster.get_grid_point</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_grid_point(r⃗, grid_size) -&gt; SVector{3, Int64}</code></pre><p>Calculate the grid point corresponding to a given position vector <code>r⃗</code> based on a specified grid size.</p><p><strong>Arguments</strong></p><ul><li><code>r⃗</code>: A 3D position vector, typically represented as an <code>SVector{3, Float64}</code> or similar type, indicating the coordinates in space.</li><li><code>grid_size</code>: A scalar value representing the size of each grid cell. This is used to determine which grid point the position <code>r⃗</code> belongs to.</li></ul><p><strong>Returns</strong></p><ul><li>An <code>SVector{3, Int64}</code> representing the grid point. The grid point is computed by dividing each component of <code>r⃗</code> by <code>grid_size</code>, flooring the result to obtain the integer grid coordinates.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/grid.jl#L186-L197">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.iterate_nn_grid_points-Tuple{Any, Hamster.PointGrid}" href="#Hamster.iterate_nn_grid_points-Tuple{Any, Hamster.PointGrid}"><code>Hamster.iterate_nn_grid_points</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">iterate_nn_grid_points(grid_point, point_grid::PointGrid)</code></pre><p>Find and return all neighboring grid points of a given <code>grid_point</code> within the specified point grid and gather the associated ion indices and translation vectors.</p><p><strong>Arguments</strong></p><ul><li><code>grid_point</code>: A grid point represented as a tuple (or similar structure), indicating the current grid position for which neighboring points are being queried.</li><li><code>point_grid::PointGrid</code>: A <code>PointGrid</code> object containing information about the point grid, including the ions&#39; positions and the translation vectors.</li></ul><p><strong>Returns</strong></p><ul><li><code>all_inds::Vector{Tuple{Int64, Int64}}</code>: A vector of tuples, where each tuple contains:<ul><li>The index of the ion (<code>iion</code>) corresponding to a nearby grid point.</li><li>The translation vector (<code>R</code>) for that ion.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/grid.jl#L116-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.iterate_nn_grid_points-Tuple{Hamster.PointGrid}" href="#Hamster.iterate_nn_grid_points-Tuple{Hamster.PointGrid}"><code>Hamster.iterate_nn_grid_points</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">iterate_nn_grid_points(point_grid::PointGrid)</code></pre><p>Iterates over nearest-neighbor (NN) grid points in a given <code>PointGrid</code> and collects indices of ion pairs and translation vectors.</p><p><strong>Arguments</strong></p><ul><li><code>point_grid::PointGrid</code>: A <code>PointGrid</code> object containing the initial grid points and the corresponding indices of ions.</li></ul><p><strong>Returns</strong></p><ul><li><code>all_inds::Vector{Tuple{Int64, Int64, Int64}}</code>: A vector of tuples where each tuple consists of:<ul><li><code>iion1::Int64</code>: Index of the first ion in the current grid point.</li><li><code>iion2::Int64</code>: Index of the second ion in the neighboring grid point.</li><li><code>R::Int64</code>: Index of the translation vector between the current grid point and its nearest neighbor.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/grid.jl#L90-L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.nn_grid_points-Tuple{Any, Any}" href="#Hamster.nn_grid_points-Tuple{Any, Any}"><code>Hamster.nn_grid_points</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nn_grid_points(grid_point, grid_dict) -&gt; Vector{SVector{3, Int64}}</code></pre><p>Returns a vector of grid points that are nearest neighbors to the given <code>grid_point</code>.</p><p>This function computes the nearest-neighbor grid points in a 3D grid by considering all adjacent grid cells in the 3x3x3 neighborhood centered around <code>grid_point</code>. It checks for the existence of each neighbor in the provided <code>grid_dict</code> before including it in the result.</p><p><strong>Arguments:</strong></p><ul><li><code>grid_point</code>: An <code>SVector{3, Int64}</code> representing the coordinates of the grid point for which nearest neighbors are sought.</li><li><code>grid_dict</code>: A dictionary (<code>Dict{SVector{3, Int64}, ...}</code>) where the keys are grid points in the form of <code>SVector{3, Int64}</code>. This dictionary is used to determine if a neighbor grid point exists.</li></ul><p><strong>Returns:</strong></p><ul><li><code>Vector{SVector{3, Int64}}</code>: A vector containing the nearest-neighbor grid points of the specified <code>grid_point</code> that are present in the <code>grid_dict</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/grid.jl#L140-L153">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.push_grid_point!-Tuple{Any, Any, Any}" href="#Hamster.push_grid_point!-Tuple{Any, Any, Any}"><code>Hamster.push_grid_point!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">push_grid_point!(grid_dict, grid_point, point_info)</code></pre><p>Add or update an entry in the grid dictionary with a specified grid point.</p><p><strong>Arguments</strong></p><ul><li><code>grid_dict::Dict</code>: A dictionary where keys are grid points (e.g., <code>SVector{3, Int64}</code>) and values are lists of associated points or indices.</li><li><code>grid_point</code>: The key representing the grid point in the dictionary. Typically a static vector or tuple indicating the grid coordinates.</li><li><code>point_info</code>: The value to associate with the <code>grid_point</code>. Often this is an index, tuple of indices, or other relevant information.</li></ul><p><strong>Details</strong></p><p>If the <code>grid_point</code> key already exists in <code>grid_dict</code>, the <code>point_info</code> is appended to the existing list of values. If the <code>grid_point</code> does not exist, a new entry is created with <code>point_info</code> as the first element in the list.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/grid.jl#L165-L177">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Ion" href="#Hamster.Ion"><code>Hamster.Ion</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Ion</code></pre><p>A mutable structure representing an ion in a crystal lattice.</p><p><strong>Fields</strong></p><ul><li><code>type::String</code>: The type or species of the ion, usually denoted by its chemical symbol (e.g., &quot;Na&quot; for sodium, &quot;Cl&quot; for chlorine).</li><li><code>pos::StaticArray{3, Float64}</code>: A 3D static array representing the position of the ion in Cartesian coordinates.</li><li><code>dist::StaticArray{3, Float64}</code>: A 3D static array representing any distortion applied to the ion&#39;s position.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/ion.jl#L4-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.findnext_ion_of_type-Tuple{Any, Vector{Ion}}" href="#Hamster.findnext_ion_of_type-Tuple{Any, Vector{Ion}}"><code>Hamster.findnext_ion_of_type</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">findnext_ion_of_type(type, ions::Vector{Ion}) -&gt; Int64</code></pre><p>Find the index of the next ion in the vector <code>Ions</code> that has the specified <code>type</code>.</p><p><strong>Arguments:</strong></p><ul><li><code>type</code>: The type of ion to search for. This could be a string, integer, or any other type that represents an ion type.</li><li><code>Ions</code>: A vector of <code>Ion</code> objects, where each <code>Ion</code> has a <code>type</code> field that specifies its ion type.</li></ul><p><strong>Returns:</strong></p><ul><li>The index <code>iion</code> of the first ion in <code>ions</code> whose <code>type</code> matches the input <code>type</code>. </li><li>If no ion with the specified <code>type</code> is found, the function returns <code>0</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/ion.jl#L64-L76">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_ion_positions-Tuple{Vector{Ion}}" href="#Hamster.get_ion_positions-Tuple{Vector{Ion}}"><code>Hamster.get_ion_positions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_ion_positions(ions::Vector{Ion}) :: Vector{SVector{3, Float64}}</code></pre><p>Retrieve the positions of all ions in a given vector of <code>Ion</code> objects.</p><p><strong>Arguments</strong></p><ul><li><code>ions::Vector{Ion}</code>: A vector of <code>Ion</code> objects, where each <code>Ion</code> contains information about its type, position, and distortion.</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{SVector{3, Float64}}</code>: A vector of <code>SVector{3, Float64}</code> where each element represents the 3D Cartesian coordinates of an ion.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/ion.jl#L85-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_ion_types-Tuple{Vector{Ion}}" href="#Hamster.get_ion_types-Tuple{Vector{Ion}}"><code>Hamster.get_ion_types</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_ion_types(ions::Vector{Ion}; uniq=false, sorted=false)</code></pre><p>Return an array containing the types of all ions in the vector <code>ions</code>.</p><p><strong>Arguments</strong></p><ul><li><code>ions::Vector{Ion}</code>: A vector of <code>Ion</code> instances, each containing information about an ion&#39;s type, position, and distortion.</li><li><code>uniq::Bool=false</code>: If <code>true</code>, the returned array contains only unique ion types.</li><li><code>sorted::Bool=false</code>: If <code>true</code>, the returned array is sorted in alphabetical order.</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{String}</code>: An array of ion types. The array will contain all ion types present in the input vector <code>ions</code>. If <code>uniq</code> is set to <code>true</code>, only unique types will be included. If <code>sorted</code> is set to <code>true</code>, the types will be sorted alphabetically.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/ion.jl#L41-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_ions" href="#Hamster.get_ions"><code>Hamster.get_ions</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_ions(positions, types, distortions=zeros(3, size(positions, 2)))</code></pre><p>Create a vector of <code>Ion</code> instances from given positions, types, and distortions.</p><p><strong>Arguments</strong></p><ul><li><code>positions::AbstractMatrix{T}</code>: A matrix where each column represents the 3D position of an ion in Cartesian coordinates.</li><li><code>types::AbstractVector{String}</code>: A vector of strings representing the type or species of each ion, corresponding to the columns of <code>positions</code>.</li><li><code>distortions::AbstractMatrix{T}</code>: A matrix where each column represents the 3D distortion vector applied to the corresponding ion&#39;s position. Defaults to a matrix of zeros.</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Ion}</code>: A vector of <code>Ion</code> instances, each containing the type, position, and distortion of an ion.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/ion.jl#L20-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.findR0-Tuple{Any}" href="#Hamster.findR0-Tuple{Any}"><code>Hamster.findR0</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">findR0(Rs::Matrix{&lt;:Number})</code></pre><p>Finds the index of the translation vector <code>[0, 0, 0]</code> in the matrix <code>Rs</code>.</p><p><strong>Arguments</strong></p><ul><li><code>Rs::Matrix{&lt;:Number}</code>: A 3xN matrix where each column represents a translation vector.</li></ul><p><strong>Returns</strong></p><ul><li><code>R::Int</code>: The index of the column in <code>Rs</code> that contains the vector <code>[0, 0, 0]</code>. If the vector <code>[0, 0, 0]</code> is not found, returns <code>0</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/lattice.jl#L78-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_Rmax" href="#Hamster.get_Rmax"><code>Hamster.get_Rmax</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_Rmax(lattice, conf=get_empty_config(); rcut=get_rcut(conf), Rmax=get_Rmax(conf), upperR=10)</code></pre><p>Determines the maximum radius <code>Rmax</code> for the given lattice and configuration parameters based on the cutoff radius <code>rcut</code>.</p><p><strong>Arguments</strong></p><ul><li><code>lattice</code>: The lattice parameters used to convert fractional to Cartesian coordinates.</li><li><code>conf</code>: (Optional) Configuration object. Defaults to <code>get_empty_config()</code>.</li><li><code>rcut</code>: (Optional) The cutoff radius used to determine the maximum radius. Defaults to <code>get_rcut(conf)</code>.</li><li><code>Rmax</code>: (Optional) Initial guess for the maximum radius. Defaults to <code>get_Rmax(conf)</code>.</li><li><code>upperR</code>: (Optional) Upper limit for the search radius. Defaults to 10.</li></ul><p><strong>Returns</strong></p><ul><li><code>Rmax::Int</code>: The maximum radius such that the spherical region of radius <code>Rmax</code> contains all points within the cutoff radius <code>rcut</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/lattice.jl#L52-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_translation_vectors" href="#Hamster.get_translation_vectors"><code>Hamster.get_translation_vectors</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_translation_vectors(rs_ion, lattice, conf=get_empty_config(); Rmax=get_Rmax(lattice, conf), rcut=get_rcut(conf))</code></pre><p>Generate a set of translation vectors based on ion positions <code>rs_ion</code>, the lattice vectors <code>lattice</code>, and optional configuration settings. The function returns the translation vectors that satisfy the maximum interatomic distance <code>rcut</code>, which is determined from the configuration or can be manually specified.</p><p><strong>Arguments</strong></p><ul><li><code>rs_ion::AbstractMatrix</code>: Matrix of ion positions in fractional coordinates. Each column represents the position of an ion.</li><li><code>lattice::AbstractMatrix</code>: Lattice vectors of the system, where each column represents a lattice vector.</li><li><code>conf::Config</code>: (Optional) Configuration object containing settings like <code>Rmax</code> and <code>rcut</code>. Defaults to an empty configuration.</li><li><code>Rmax::Int64</code>: (Optional) Maximum entry magnitude for the initial set of translation vectors. Defaults to the value from the configuration.</li><li><code>rcut::Float64</code>: (Optional) Maximum interatomic distance. If set to 0, all initial translation vectors will be returned. Defaults to the value from the configuration.</li></ul><p><strong>Returns</strong></p><ul><li><code>AbstractMatrix</code>: A matrix containing the translation vectors as columns. The vectors are filtered based on the <code>rcut</code> value to include only those within the specified interatomic distance.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/lattice.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_translation_vectors-Tuple{Int64}" href="#Hamster.get_translation_vectors-Tuple{Int64}"><code>Hamster.get_translation_vectors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_translation_vectors(M::Int64)</code></pre><p>Generate a set of translation vectors within a cubic grid defined by the maximum entry magnitude <code>M</code>.</p><p><strong>Arguments</strong></p><ul><li><code>M::Int64</code>: The maximum magnitude of the entries in the translation vectors. The resulting grid will include all integer vectors where each component is in the range <code>-M</code> to <code>M</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>Rs::Matrix{Float64}</code>: A 3xN matrix where <code>N</code> is the total number of translation vectors. Each column of <code>Rs</code> represents a translation vector with components within the specified magnitude range.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/lattice.jl#L32-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_nearest_neighbors-Tuple{Any, Any, Any, Hamster.PointGrid}" href="#Hamster.get_nearest_neighbors-Tuple{Any, Any, Any, Hamster.PointGrid}"><code>Hamster.get_nearest_neighbors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_nearest_neighbors(r0, rs, Ts, point_grid::PointGrid; kNN=1, sorted=false)</code></pre><p>Find the nearest neighbors (NN) of a given point <code>r0</code> within a set of points <code>rs</code> and translation vectors <code>Ts</code>.</p><p><strong>Arguments</strong></p><ul><li><code>r0::AbstractVector{T}</code>: The reference point in 3D space for which the nearest neighbors are to be found.</li><li><code>rs::AbstractMatrix{T}</code>: A 3xN matrix where each column represents a 3D point in space. These are the potential neighbors.</li><li><code>Ts::AbstractMatrix{T}</code>: A 3xM matrix where each column is a 3D translation vector. These vectors are applied to the points in <code>rs</code> to account for periodic boundary conditions.</li><li><code>point_grid::PointGrid</code>: A <code>PointGrid</code> structure used for efficient neighbor searching, containing a grid size and a dictionary of grid points.</li><li><code>kNN::Int</code>: The number of nearest neighbors to find. Defaults to 1.</li></ul><p><strong>Returns</strong></p><ul><li><code>r_NN::Matrix{Float64}</code>: A 3xkNN matrix where each column represents the 3D coordinates of one of the <code>kNN</code> nearest neighbors to <code>r0</code>.</li></ul><p><strong>Description</strong></p><p>This function computes the nearest neighbors of a point <code>r0</code> by:</p><ol><li>Locating the grid point corresponding to <code>r0</code> in the <code>point_grid</code>.</li><li>Iterating over the neighboring grid points to compute distances to all potential neighbor points in <code>rs</code> shifted by translation vectors in <code>Ts</code>.</li><li>Sorting these distances to identify the <code>kNN</code> closest neighbors.</li><li>Returning the positions of these nearest neighbors in a matrix.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/methods.jl#L1-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_nn_thresholds" href="#Hamster.get_nn_thresholds"><code>Hamster.get_nn_thresholds</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_nn_thresholds(ions, Ts, point_grid, conf=get_empty_config(); sepNN=get_sepNN(conf))</code></pre><p>Calculate nearest-neighbor distance thresholds for pairs of ions based on their positions and types, returning a dictionary of <code>IonLabel</code> keys and corresponding minimum distances.</p><p><strong>Arguments</strong></p><ul><li><code>ions</code>: A list of ion objects. Each ion contains its position and type.</li><li><code>Ts</code>: A transformation matrix used for periodic boundary conditions.</li><li><code>point_grid</code>: A grid of points to iterate over for calculating neighbor distances.</li><li><code>conf</code>: A configuration object (optional). Default is <code>get_empty_config()</code>.</li><li><code>sepNN</code>: A Boolean flag (optional). If <code>true</code>, separate NN thresholds are calculated for each ion pair. If <code>false</code>, all ion pairs are treated uniformly. Default is <code>get_sepNN(conf)</code>.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>sepNN</code>: Whether to compute separate NN distances for different ion pairs. Default is <code>get_sepNN(conf)</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>NN_dict::Dict{IonLabel, Float64}</code>: A dictionary where each key is an <code>IonLabel</code> representing a pair of ion types, and the value is the minimum nearest-neighbor distance for that pair.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/methods.jl#L43-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_sk_transform_matrix-NTuple{4, Any}" href="#Hamster.get_sk_transform_matrix-NTuple{4, Any}"><code>Hamster.get_sk_transform_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_sk_transform_matrix(r⃗₁, r⃗₂, axis, tmethod)</code></pre><p>Returns a transformation matrix that aligns the z-axis along the vector connecting  <code>r⃗₁</code> and <code>r⃗₂</code>. The method of transformation depends on <code>tmethod</code>.</p><p><strong>Arguments</strong></p><ul><li><code>r⃗₁::AbstractVector</code>: The first position vector.</li><li><code>r⃗₂::AbstractVector</code>: The second position vector.</li><li><code>axis::AbstractVector</code>: A vector used to define the x-axis in case of Gram-Schmidt transformation.</li><li><code>tmethod::String</code>: The transformation method. </li></ul><p><strong>Returns</strong></p><ul><li><code>Ê::AbstractMatrix</code>: The 3x3 transformation matrix that aligns the z-axis with the vector  between <code>r⃗₁</code> and <code>r⃗₂</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/sk_transform.jl#L3-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_transformed_system-Tuple{Any, Any, Any}" href="#Hamster.get_transformed_system-Tuple{Any, Any, Any}"><code>Hamster.get_transformed_system</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_transformed_system(r⃗₁, r⃗₂, ω; ϵ=1e-5)
get_transformed_system(r⃗₁, r⃗₂)</code></pre><p>Construct a new orthonormal coordinate system based on two vectors <code>r⃗₁</code> and <code>r⃗₂</code>,  with the z-axis oriented along the vector connecting <code>r⃗₁</code> and <code>r⃗₂</code>. Optionally, a  third vector <code>ω</code> can be provided to influence the initial guess for the x-axis.</p><p><strong>Arguments</strong></p><ul><li><code>r⃗₁::Vector</code>: A 3D vector representing the first position.</li><li><code>r⃗₂::Vector</code>: A 3D vector representing the second position.</li><li><code>ω::Vector</code>: (Optional) A 3D vector used as the initial guess for the x-axis orientation.  If <code>ω</code> is omitted, the function assumes a default method for constructing the x-axis.</li><li><code>ϵ::Float64=1e-5</code>: (Optional) A small tolerance value to handle near-zero differences and near-parallel vectors.</li></ul><p><strong>Returns</strong></p><ul><li>A 3x3 matrix <code>Ê</code> where the rows correspond to the new x-axis, y-axis, and z-axis of the coordinate system.</li></ul><p><strong>Details</strong></p><ul><li><strong>Z-axis (ez)</strong>: Always aligned with the normalized vector <code>r⃗₂ - r⃗₁</code>. If this vector is zero or near-zero  (within tolerance <code>ϵ</code>), the z-axis defaults to <code>[0, 0, 1]</code>.</li><li><strong>X-axis (ex)</strong>: If <code>ω</code> is provided, the x-axis is constructed from the projection of <code>ω</code> orthogonal to the  z-axis and is normalized. If <code>ω</code> is omitted, an alternative method will define the x-axis.</li><li><strong>Y-axis (ey)</strong>: Always computed as the cross-product of the z-axis and x-axis, ensuring orthogonality and  completeness of the coordinate system.</li><li><strong>Fallback behavior</strong>: If <code>ω</code> is nearly parallel to the z-axis within tolerance <code>ϵ</code>, the function reverts to  the simpler version <code>get_transformed_system(r⃗₁, r⃗₂)</code> to handle the ambiguity in the x-axis.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/sk_transform.jl#L27-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.rotation_matrix_around_axis-Union{Tuple{T}, Tuple{AbstractVector{T}, T}} where T" href="#Hamster.rotation_matrix_around_axis-Union{Tuple{T}, Tuple{AbstractVector{T}, T}} where T"><code>Hamster.rotation_matrix_around_axis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rotation_matrix_around_axis(u⃗::AbstractVector{T}, θ::T) where T</code></pre><p>Constructs a 3x3 rotation matrix that rotates by an angle <code>θ</code> around an arbitrary axis <code>u⃗</code>, using Rodrigues&#39; rotation formula.</p><p><strong>Arguments</strong></p><ul><li><code>u⃗::AbstractVector{T}</code>: A 3D unit vector (axis of rotation) where <code>T</code> is a numeric type.</li><li><code>θ::T</code>: The angle of rotation (in radians) around the axis <code>u⃗</code>.</li></ul><p><strong>Returns</strong></p><ul><li>A 3x3 static matrix representing the rotation around the axis <code>u⃗</code> by angle <code>θ</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/sk_transform.jl#L77-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Structure" href="#Hamster.Structure"><code>Hamster.Structure</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Structure(conf=get_empty_config(); poscar_path=get_poscar(conf), rcut=get_rcut(conf), grid_size=get_grid_size(conf))</code></pre><p>Create a <code>Structure</code> instance from a POSCAR file.</p><p><strong>Arguments</strong></p><ul><li><code>conf</code>: A <code>Config</code> instance that contains various parameters.</li><li><code>poscar_path</code>: The file path to the POSCAR file.</li><li><code>rcut</code>: The cutoff radius for interactions to be taken into account.</li><li><code>grid_size</code>: The size of the grid used in the <code>PointGrid</code> for efficient neighbor searching.</li></ul><p><strong>Returns</strong></p><ul><li><code>Structure</code>: A <code>Structure</code> instance.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/structure.jl#L19-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Structure" href="#Hamster.Structure"><code>Hamster.Structure</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Structure</code></pre><p>A data structure representing a crystal structure, including its lattice vectors, atomic positions, and a point grid for efficient neighbor searching.</p><p><strong>Fields</strong></p><ul><li><code>lattice::Matrix{Float64}</code>: A 3x3 matrix representing the lattice vectors of the crystal. Each column corresponds to a lattice vector.</li><li><code>Rs::Matrix{Float64}</code>: A matrix where each column represents the position of a lattice translation vector in fractional coordinates.</li><li><code>ions::Vector{Ion}</code>: A vector containing the ions in the structure. Each <code>Ion</code> includes information like the type of ion, its position, and possibly its distortion from the equilibrium.</li><li><code>point_grid::PointGrid</code>: A data structure used for efficiently finding neighboring ions based on their positions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/structure.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Structure-Union{Tuple{M4}, Tuple{M3}, Tuple{M2}, Tuple{M1}, Tuple{M1, M2, M3, Any, M4}, Tuple{M1, M2, M3, Any, M4, Config}} where {M1, M2, M3, M4&lt;:Matrix{Float64}}" href="#Hamster.Structure-Union{Tuple{M4}, Tuple{M3}, Tuple{M2}, Tuple{M1}, Tuple{M1, M2, M3, Any, M4}, Tuple{M1, M2, M3, Any, M4, Config}} where {M1, M2, M3, M4&lt;:Matrix{Float64}}"><code>Hamster.Structure</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Structure(Rs, rs_ion, δrs_ion, ion_types, lattice, conf=get_empty_config(); rcut=get_rcut(conf), grid_size=get_grid_size(conf))
Structure(Rs, rs_ion, ion_types, lattice, conf=get_empty_config(); rcut=get_rcut(conf), grid_size=get_grid_size(conf))</code></pre><p>Create a <code>Structure</code> instance from atomic information.</p><p><strong>Arguments</strong></p><ul><li><code>Rs</code>: A 3xNR matrix representing the set of lattice translation vectors.</li><li><code>rs_ion</code>: A 3xNion matrix representing the coordinates of the ions in the unit cell.</li><li><code>δrs_ion</code>: (Optional) A 3xNion matrix representing atomic displacements from <code>rs_ion</code>. Defaults to a zeros.</li><li><code>ion_types</code>: A vector representing the types of ions in the unit cell.</li><li><code>lattice</code>: A 3x3 matrix representing the lattice vectors of the crystal.</li><li><code>conf</code>: (Optional) A <code>Config</code> instance.</li><li><code>rcut</code>: The cutoff radius for interactions to be taken into account.</li><li><code>grid_size</code>: The size of the grid used in the <code>PointGrid</code> for efficient neighbor searching.</li></ul><p><strong>Returns</strong></p><ul><li><code>Structure</code>: A <code>Structure</code> instance.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/structure.jl#L48-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_config_index_sample" href="#Hamster.get_config_index_sample"><code>Hamster.get_config_index_sample</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_config_index_sample(conf=get_empty_config(); Nconf=get_Nconf(conf), Nconf_min=get_Nconf_min(conf), Nconf_max=get_Nconf_max(conf), val_ratio=get_val_ratio(conf))</code></pre><p>Randomly selects training and validation configuration indices from a given range of configurations.</p><p><strong>Arguments</strong></p><ul><li><code>conf</code>: (Optional) A configuration object from which all other parameters may be derived. Defaults to an empty configuration.</li><li><code>Nconf</code>: (Optional) The number of configurations to sample for training. Derived from <code>conf</code> if not specified.</li><li><code>Nconf_min</code>: (Optional) The minimum configuration index. Derived from <code>conf</code> if not specified.</li><li><code>Nconf_max</code>: (Optional) The maximum configuration index. Derived from <code>conf</code> if not specified.</li><li><code>validate</code>: (Optional) Boolean flag indicating whether validation should be performed. Derived from <code>conf</code> if not specified.</li><li><code>val_ratio</code>: (Optional) Ratio of validation configurations to training configurations. Used only if <code>train_mode == val_mode</code>.</li><li><code>train_mode</code>: (Optional) Mode identifier for training configurations. Derived from <code>conf</code>.</li><li><code>val_mode</code>: (Optional) Mode identifier for validation configurations. Derived from <code>conf</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>train_config_inds</code>: A vector of indices for training configurations.</li><li><code>val_config_inds</code>: A vector of indices for validation configurations.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/supercell.jl#L69-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_structures" href="#Hamster.get_structures"><code>Hamster.get_structures</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_structures(conf=get_empty_config(); index_file=&quot;config_inds.dat&quot;, xdatcar=get_xdatcar(conf), sc_poscar=get_sc_poscar(conf))</code></pre><p>Generates a list of <code>Structure</code> objects based on the configurations from an XDATCAR file (or an h5 file) and the initial POSCAR structure. </p><p><strong>Arguments</strong></p><ul><li><code>conf</code>: A configuration object, typically used to store simulation parameters. By default, it calls <code>get_empty_config()</code>.</li><li><code>index_file</code>: A string specifying the filename containing the configuration indices. If this file exists, the configuration indices are read from it. If not, they are sampled using <code>get_config_index_sample()</code>.</li><li><code>xdatcar</code>: The path to the XDATCAR file, containing configuration data for the system. </li><li><code>sc_poscar</code>: The path to the POSCAR file, representing the initial supercell structure.</li></ul><p><strong>Returns</strong></p><ul><li><code>strcs</code>: A vector of <code>Structure</code> objects. Each structure represents the ion positions and their displacements relative to the initial configuration.</li><li><code>config_indices</code>: The indices of the configurations used to create the structures.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/supercell.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.split_indices_into_chunks-Union{Tuple{T}, Tuple{AbstractVector{T}, Any}} where T" href="#Hamster.split_indices_into_chunks-Union{Tuple{T}, Tuple{AbstractVector{T}, Any}} where T"><code>Hamster.split_indices_into_chunks</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">split_indices_into_chunks(indices, nchunks; rank=0)</code></pre><p>Splits a collection of indices into <code>nchunks</code> approximately equal-sized chunks and returns the chunk corresponding to the specified <code>rank</code>.</p><p><strong>Arguments</strong></p><ul><li><code>indices::AbstractVector</code>: The collection of indices to be split.</li><li><code>nchunks::Int</code>: The number of chunks to divide the indices into.</li><li><code>rank::Int=0</code>: The rank (0-based) specifying which chunk to return. Defaults to <code>0</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>AbstractVector</code>: The chunk of indices corresponding to the specified <code>rank</code>. If the <code>rank</code> exceeds the number of chunks, an empty array of type <code>Int64[]</code> is returned.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/supercell.jl#L134-L146">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.calc_angle-Tuple{Any, Any}" href="#Hamster.calc_angle-Tuple{Any, Any}"><code>Hamster.calc_angle</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_angle(v1, v2; ϵ=1e-5)</code></pre><p>Calculate the angle between two vectors <code>v1</code> and <code>v2</code> in radians. </p><p><strong>Arguments:</strong></p><ul><li><code>v1</code>: First vector (can be any dimensionality as long as it matches <code>v2</code>).</li><li><code>v2</code>: Second vector (same dimensionality as <code>v1</code>).</li><li><code>ϵ</code>: Small tolerance value to ensure that the norm of the vectors is sufficiently large to avoid division by zero (default: <code>1e-5</code>).</li></ul><p><strong>Returns:</strong></p><ul><li>The angle in radians between <code>v1</code> and <code>v2</code>, calculated using the dot product.  If either vector&#39;s norm is less than <code>ϵ</code>, the function returns <code>0.</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/vec.jl#L135-L148">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_rotated_angles-Tuple{Any, Any}" href="#Hamster.get_rotated_angles-Tuple{Any, Any}"><code>Hamster.get_rotated_angles</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_rotated_angles(Û, r⃗)</code></pre><p>Calculate the spherical angles (θ, φ) for a vector <code>r⃗</code> after it is rotated by the matrix <code>Û</code>.</p><p><strong>Arguments</strong></p><ul><li><code>Û::AbstractMatrix{T}</code>: A 3x3 rotation matrix that transforms the vector <code>r⃗</code>.</li><li><code>r⃗::AbstractVector{T}</code>: A 3D vector to be rotated, where <code>T</code> is a numeric type.</li></ul><p><strong>Returns</strong></p><ul><li><code>θ::T</code>: The polar (zenith) angle, measured from the z-axis, in radians.</li><li><code>φ::T</code>: The azimuthal angle, measured from the x-axis in the xy-plane, in radians.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/vec.jl#L157-L169">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.normdiff-Union{Tuple{W}, Tuple{V}, Tuple{V, W}} where {V, W&lt;:(AbstractVector)}" href="#Hamster.normdiff-Union{Tuple{W}, Tuple{V}, Tuple{V, W}} where {V, W&lt;:(AbstractVector)}"><code>Hamster.normdiff</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normdiff(v⃗::AbstractVector, w⃗::AbstractVector)
normdiff(v⃗::AbstractVector, w⃗::AbstractVector, t⃗::AbstractVector)
normdiff(v⃗::AbstractVector, w⃗::AbstractVector, δv⃗::AbstractVector, δw⃗::AbstractVector, t⃗::AbstractVector)</code></pre><p>Compute the Euclidean norm (L2 distance) between two vectors <code>v⃗</code> and <code>w⃗</code>, optionally with displacement vectors <code>δv⃗</code> and <code>δw⃗</code> and lattice translation vector <code>t⃗</code>.</p><p><strong>Arguments</strong></p><ul><li><code>v⃗::AbstractVector</code>: The first vector.</li><li><code>w⃗::AbstractVector</code>: The second vector.</li><li><code>δv⃗::AbstractVector</code>: The first displacement vector.</li><li><code>δw⃗::AbstractVector</code>: The second displacement vector.</li><li><code>t⃗::AbstractVector</code>: The lattice translation vector.</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: The Euclidean norm of the difference between vectors <code>v</code> and <code>w</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/vec.jl#L74-L90">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.proj-Tuple{Any, Any}" href="#Hamster.proj-Tuple{Any, Any}"><code>Hamster.proj</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">proj(u⃗, v⃗)</code></pre><p>Calculate the projection of the vector <code>v⃗</code> onto the vector <code>u⃗</code>.</p><p><strong>Arguments</strong></p><ul><li><code>u⃗::AbstractVector</code>: The vector onto which the projection is calculated.</li><li><code>v⃗::AbstractVector</code>: The vector being projected onto <code>u⃗</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>AbstractVector</code>: The projection of <code>v⃗</code> onto <code>u⃗</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/vec.jl#L115-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.transform_basis-Tuple{Any, Any}" href="#Hamster.transform_basis-Tuple{Any, Any}"><code>Hamster.transform_basis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform_basis(r⃗::AbstractVector, Ê::AbstractMatrix) -&gt; AbstractVector</code></pre><p>Transforms a vector to a new basis using a given transformation matrix.</p><p>This function takes a vector <code>r⃗</code> and transforms it into a new basis by applying the transformation matrix <code>Ê</code>. The transformation is performed by multiplying the matrix <code>Ê</code> with the vector <code>r⃗</code>, yielding the transformed vector.</p><p><strong>Arguments:</strong></p><ul><li><code>r⃗::AbstractVector</code>: The vector to be transformed. This represents coordinates or a state in the original basis.</li><li><code>Ê::AbstractMatrix</code>: The transformation matrix that defines the new basis. This matrix should have dimensions compatible with the vector <code>r⃗</code>.</li></ul><p><strong>Returns:</strong></p><ul><li><code>AbstractVector</code>: The transformed vector in the new basis, obtained by multiplying <code>Ê</code> with <code>r⃗</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/vec.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.transform_to_spherical-Tuple{AbstractMatrix{Float64}}" href="#Hamster.transform_to_spherical-Tuple{AbstractMatrix{Float64}}"><code>Hamster.transform_to_spherical</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform_to_spherical(r⃗::AbstractArray{Float64, 2}; origin=[0, 0, 0]) -&gt; AbstractMatrix{Float64}</code></pre><p>Converts a set of Cartesian coordinates to spherical coordinates relative to a specified origin.</p><p>This function takes a 3xN matrix <code>r⃗</code>, where each column represents a point in Cartesian coordinates (x, y, z), and transforms these points into spherical coordinates (r, θ, φ). The transformation is performed relative to a specified origin.</p><p><strong>Arguments:</strong></p><ul><li><code>r⃗::AbstractArray{Float64, 2}</code>: A 3xN matrix where each column represents Cartesian coordinates <code>[x, y, z]</code> of a point.</li><li><code>origin::AbstractVector{Float64}</code>: A 3-element vector specifying the origin relative to which the spherical coordinates are computed. Default is <code>[0, 0, 0]</code>.</li></ul><p><strong>Returns:</strong></p><ul><li><code>AbstractMatrix{Float64}</code>: An N×3 matrix where each row contains the spherical coordinates <code>(r, θ, φ)</code> for the corresponding point in the input.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/vec.jl#L47-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.transform_to_spherical-Tuple{AbstractVector{Float64}}" href="#Hamster.transform_to_spherical-Tuple{AbstractVector{Float64}}"><code>Hamster.transform_to_spherical</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform_to_spherical(r⃗::AbstractArray{Float64, 1}) -&gt; Tuple{Float64, Float64, Float64}</code></pre><p>Converts Cartesian coordinates to spherical coordinates.</p><p>This function takes a 3D vector <code>r⃗</code> in Cartesian coordinates (x, y, z) and transforms it into spherical coordinates (r, θ, φ). The spherical coordinates are defined as follows:</p><ul><li><code>r</code>: The radial distance from the origin.</li><li><code>θ</code>: The polar angle, measured from the positive z-axis.</li><li><code>φ</code>: The azimuthal angle, measured from the positive x-axis in the xy-plane.</li></ul><p><strong>Arguments:</strong></p><ul><li><code>r⃗::AbstractArray{Float64, 1}</code>: A 3-element vector representing the Cartesian coordinates <code>[x, y, z]</code>.</li></ul><p><strong>Returns:</strong></p><ul><li><code>Tuple{Float64, Float64, Float64}</code>: A tuple containing the spherical coordinates <code>(r, θ, φ)</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/strc/vec.jl#L21-L38">source</a></section></article><h1 id="TB"><a class="docs-heading-anchor" href="#TB">TB</a><a id="TB-1"></a><a class="docs-heading-anchor-permalink" href="#TB" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.copy_params!-Union{Tuple{H2}, Tuple{H1}, Tuple{H1, H2}} where {H1, H2&lt;:EffectiveHamiltonian}" href="#Hamster.copy_params!-Union{Tuple{H2}, Tuple{H1}, Tuple{H1, H2}} where {H1, H2&lt;:EffectiveHamiltonian}"><code>Hamster.copy_params!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">copy_params!(receiving_ham::H1, sending_ham::H2) where {H1,H2&lt;:EffectiveHamiltonian}</code></pre><p>Copy parameters from one EffectiveHamiltonian (<code>sending_ham</code>) to another (<code>receiving_ham</code>).</p><p><strong>Arguments</strong></p><ul><li><code>receiving_ham</code>: The Hamiltonian object that will receive the parameters.</li><li><code>sending_ham</code>: The Hamiltonian object providing the parameters to be copied.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/eff_ham.jl#L116-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_hamiltonian-Tuple{EffectiveHamiltonian, Any, Any}" href="#Hamster.get_hamiltonian-Tuple{EffectiveHamiltonian, Any, Any}"><code>Hamster.get_hamiltonian</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_hamiltonian(ham::EffectiveHamiltonian, index, ks)</code></pre><p>Construct the Hamiltonian matrix for given k-points <code>ks</code> from the real-space Hamiltonian and lattice vectors.</p><p><strong>Arguments</strong></p><ul><li><code>ham::EffectiveHamiltonian</code>: The effective Hamiltonian object.</li><li><code>index::Int</code>: The index of the structure for which the Hamiltonian is to be calculated.</li><li><code>ks</code>: The k-points for which the Hamiltonian matrix is to be calculated.</li><li><code>comm</code> (optional): The MPI communicator.</li></ul><p><strong>Returns</strong></p><ul><li><code>Hk</code>: The Hamiltonian matrix in reciprocal space corresponding to the given k-points.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/eff_ham.jl#L51-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_hr-Tuple{EffectiveHamiltonian, Any}" href="#Hamster.get_hr-Tuple{EffectiveHamiltonian, Any}"><code>Hamster.get_hr</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_hr(ham::EffectiveHamiltonian, index)</code></pre><p>Retrieve the real-space Hamiltonian (<code>Hr</code>) by combining contributions from individual models within the <code>EffectiveHamiltonian</code>.</p><p><strong>Arguments</strong></p><ul><li><code>ham::EffectiveHamiltonian</code>: The effective Hamiltonian object.</li><li><code>index::Int</code>: The index of the structure for which the Hamiltonian is to be calculated.</li></ul><p><strong>Returns</strong></p><ul><li><code>Hr</code>: The combined real-space Hamiltonian matrix, obtained by summing the Hamiltonians of all the models in the <code>ham.models</code> tuple.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/eff_ham.jl#L78-L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_sparse_iterator" href="#Hamster.get_sparse_iterator"><code>Hamster.get_sparse_iterator</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_sparse_iterator(strc, basis, conf=get_empty_config(), rcut=get_rcut(conf))</code></pre><p>Constructs an iterator that generates sparse matrix indices for interactions within a specified cutoff radius.</p><p><strong>Arguments</strong></p><ul><li><code>strc</code>: A structure object containing information about ions, positions, lattice, and grid points.</li><li><code>basis</code>: A basis object, containing the orbitals associated with each ion.</li><li><code>conf</code>: Configuration object, which contains relevant simulation parameters.</li><li><code>rcut</code>: A cutoff radius, that defines the maximum distance for interactions to be included.</li></ul><p><strong>Returns</strong></p><ul><li><code>indices</code>: A vector of vectors, where each sub-vector corresponds to a specific grid point (denoted by <code>R</code>)  and contains tuples <code>(i, j)</code> representing the sparse matrix indices for interactions within the cutoff radius.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/eff_ham.jl#L157-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.update!-Tuple{EffectiveHamiltonian, Any, Any}" href="#Hamster.update!-Tuple{EffectiveHamiltonian, Any, Any}"><code>Hamster.update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update!(ham::EffectiveHamiltonian, opt, dL_dHr)</code></pre><p>Update the parameters of each model within the <code>EffectiveHamiltonian</code> object using a provided update rule.</p><p><strong>Arguments</strong></p><ul><li><code>ham::EffectiveHamiltonian</code>: The effective Hamiltonian object containing multiple models.</li><li><code>opt</code>: An optimizer object specifying the update rule (e.g., ADAM).</li><li><code>model_grad</code>: The gradient of the loss w.r.t. the model parameters.</li></ul><p><strong>Returns</strong></p><ul><li>This function modifies the <code>ham</code> object in place, updating the parameters of each model it contains.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/eff_ham.jl#L97-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.write_params" href="#Hamster.write_params"><code>Hamster.write_params</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_params(eff_ham::EffectiveHamiltonian, conf)</code></pre><p>Writes the parameters of all models contained within an <code>EffectiveHamiltonian</code>.</p><p><strong>Arguments</strong></p><ul><li><code>eff_ham::EffectiveHamiltonian</code>: An EffectiveHamiltonian model.</li><li><code>conf::Config</code>: A configuration object.</li></ul><p><strong>Behavior</strong></p><ul><li>Iterates through all models within <code>eff_ham</code> and calls <code>write_params(model)</code> for each.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/eff_ham.jl#L131-L142">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.apply_spin_basis-Tuple{AbstractMatrix}" href="#Hamster.apply_spin_basis-Tuple{AbstractMatrix}"><code>Hamster.apply_spin_basis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_spin_basis(H::AbstractMatrix; alternating_order=false)</code></pre><p>Extends a given matrix <code>H</code> to a spin basis (up/down) representation by applying the tensor product with the identity matrix. The order of the tensor product application is controlled by the <code>alternating_order</code> flag which affects the order of spin states in the basis.</p><p><strong>Arguments:</strong></p><ul><li><code>H::AbstractMatrix</code>: The input matrix to be extended to the spin basis. It should be a square matrix or generally a 2D array.</li><li><code>alternating_order::Bool=false</code>: A boolean flag that determines the order of applying the spin basis. If <code>true</code>, the order is, e.g., up,down,up,down. If <code>false</code>, the order is, e.g., up,up,down,down.</li></ul><p><strong>Returns:</strong></p><ul><li>A matrix in the spin basis in the specified order.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/ham.jl#L187-L198">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.diagonalize-Tuple{AbstractMatrix}" href="#Hamster.diagonalize-Tuple{AbstractMatrix}"><code>Hamster.diagonalize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">diagonalize(Hk::AbstractMatrix; Neig=size(Hk, 1), target=0, method=&quot;shift-invert&quot;)</code></pre><p>Fully diagonalizes a Hermitian Hamiltonian matrix <code>Hk</code> and returns the eigenvalues and eigenvectors.</p><p><strong>Arguments:</strong></p><ul><li><code>Hk::AbstractMatrix</code>: A Hermitian matrix (Hamiltonian) to be diagonalized. The matrix should be square and typically complex-valued.</li><li><code>Neig::Int=size(Hk, 1)</code>: The number of eigenvalues and corresponding eigenvectors to compute. Not used.</li><li><code>target::Real=0</code>: The target eigenvalue around which to focus the computation. Not used.</li><li><code>method::String</code>: The method to be used for calculating eigenvalues of a sparse matrix.</li></ul><p><strong>Returns:</strong></p><ul><li><code>real_values::Vector{Float64}</code>: A vector containing the real parts of the eigenvalues of <code>Hk</code>. The eigenvalues are computed using the Hermitian matrix, so they are guaranteed to be real.</li><li><code>eigenvectors::Matrix{ComplexF64}</code>: A matrix where each column is an eigenvector corresponding to an eigenvalue of <code>Hk</code>. The eigenvectors are computed in the standard basis and are complex-valued.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/ham.jl#L69-L83">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.diagonalize-Tuple{SparseArrays.SparseMatrixCSC}" href="#Hamster.diagonalize-Tuple{SparseArrays.SparseMatrixCSC}"><code>Hamster.diagonalize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">diagonalize(Hk::SparseMatrixCSC; Neig=6, target=0, method=&quot;shift-invert&quot;)</code></pre><p>Diagonalizes a sparse Hermitian matrix <code>Hk</code> to find a specified number of eigenvalues and eigenvectors, optionally focusing on eigenvalues near a given target.</p><p><strong>Arguments:</strong></p><ul><li><code>Hk::SparseMatrixCSC</code>: A sparse Hermitian matrix in compressed sparse column format to be diagonalized. The matrix should be square and Hermitian.</li><li><code>Neig::Int=6</code>: The number of eigenvalues and corresponding eigenvectors to compute. Defaults to <code>6</code>, but can be adjusted based on the required precision or size of the spectrum.</li><li><code>target::Real=0</code>: The target eigenvalue around which to focus the computation. This is used to prioritize finding eigenvalues closest to this value. Defaults to <code>0</code>.</li><li><code>method::String</code>: The method to be used for calculating eigenvalues of a sparse matrix.</li></ul><p><strong>Returns:</strong></p><ul><li><code>eigenvalues::Vector{Float64}</code>: A vector of the real parts of the computed eigenvalues, focusing on those closest to the target. The number of eigenvalues returned is equal to <code>Neig</code>.</li><li><code>eigenvectors::Matrix{ComplexF64}</code>: A matrix where each column is an eigenvector corresponding to one of the computed eigenvalues.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/ham.jl#L93-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.diagonalize-Tuple{Vector{&lt;:AbstractMatrix}}" href="#Hamster.diagonalize-Tuple{Vector{&lt;:AbstractMatrix}}"><code>Hamster.diagonalize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">diagonalize(Hk::Vector{&lt;:AbstractMatrix}; Neig=size(Hk[1], 1), target=0, method=&quot;shift-invert&quot;)</code></pre><p>Diagonalizes a vector of Hamiltonian matrices <code>Hk</code> and returns the specified number of eigenvalues and eigenvectors for each matrix.</p><p><strong>Arguments:</strong></p><ul><li><code>Hk::Vector{&lt;:AbstractMatrix}</code>: A vector of Hamiltonian matrices to be diagonalized. Each matrix typically corresponds to a different momentum <code>k</code> in a band structure calculation.</li><li><code>Neig::Int=size(Hk[1], 1)</code>: The number of eigenvalues and corresponding eigenvectors to compute for each Hamiltonian matrix. Defaults to the full diagonalization (<code>size(Hk[1], 1)</code>).</li><li><code>target::Real=0</code>: The target eigenvalue when computing eigenvalues of a sparse matrix.</li><li><code>method::String</code>: The method to be used for calculating eigenvalues of a sparse matrix.</li></ul><p><strong>Returns:</strong></p><ul><li><code>Es::Matrix{Float64}</code>: A matrix where each column <code>Es[:, k]</code> contains the <code>Neig</code> eigenvalues of the <code>k</code>-th Hamiltonian matrix in <code>Hk</code>.</li><li><code>vs::Array{ComplexF64, 3}</code>: A 3D array where each <code>vs[:, :, k]</code> contains the <code>Neig</code> eigenvectors corresponding to the <code>k</code>-th Hamiltonian matrix in <code>Hk</code>. The dimensions of <code>vs</code> are <code>(Nε, Neig, Nk)</code>, where <code>Nε</code> is the size of each Hamiltonian matrix, <code>Neig</code> is the number of eigenvectors, and <code>Nk</code> is the number of Hamiltonian matrices.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/ham.jl#L41-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.exp_2πi-Tuple{Any, Any}" href="#Hamster.exp_2πi-Tuple{Any, Any}"><code>Hamster.exp_2πi</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">exp_2πi(k⃗, R⃗)</code></pre><p>Calculate the phase factor exp(2πik⃗⋅R⃗).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/ham.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_hamiltonian" href="#Hamster.get_hamiltonian"><code>Hamster.get_hamiltonian</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_hamiltonian(Hr::Vector{&lt;:AbstractMatrix}, Rs, ks, mode=Dense(), weights=ones(size(Rs, 2)))</code></pre><p>Constructs a vector of Hamiltonian matrices by combining a vector of matrices <code>Hr</code> with phase factors determined by <code>Rs</code> and <code>ks</code>.</p><p><strong>Arguments:</strong></p><ul><li><code>Hr::Vector{&lt;:AbstractMatrix}</code>: A vector of matrices where each matrix represents a component of the Hamiltonian. These matrices must be compatible in size for the operations performed.</li><li><code>Rs</code>: A matrix or array containing positional information used to calculate phase factors.</li><li><code>ks</code>: A matrix of momentum values used in conjunction with <code>Rs</code> to compute phase factors.</li><li><code>mode::Dense()</code>: Indicates whether to construct a sparse or dense Hamiltonian. Defaults to <code>Dense</code>.</li><li><code>weights::Vector=ones(size(Rs, 2))</code>: A vector of weights used in the summation of phase factors. The length of this vector should match the number of columns in <code>Rs</code>. These are the degeneracies for the Wannier90 Hamiltonians.</li></ul><p><strong>Returns:</strong></p><ul><li>A vector of Hamiltonian matrices <code>Hk</code>, where each matrix is constructed by combining <code>Hr</code> with phase factors and optionally transformed into a spin basis.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/ham.jl#L13-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_sparsity-Tuple{AbstractArray}" href="#Hamster.get_sparsity-Tuple{AbstractArray}"><code>Hamster.get_sparsity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_sparsity(H::AbstractArray; sp_tol=1e-10)</code></pre><p>Calculates the sparsity of a matrix or array by determining the fraction of elements that are considered effectively zero based on a specified numerical tolerance.</p><p><strong>Arguments:</strong></p><ul><li><code>H::AbstractArray</code>: The input matrix or array for which sparsity is to be calculated. It can be a dense or sparse matrix, or any array-like structure.</li><li><code>sp_tol::Real=1e-10</code>: The numerical tolerance used to determine whether an element is considered zero. Elements with both real and imaginary parts less than <code>sp_tol</code> in magnitude are considered zero.</li></ul><p><strong>Returns:</strong></p><ul><li><code>sparsity::Float64</code>: The fraction of elements in <code>H</code> that are considered zero according to the specified tolerance. This value lies between <code>0.0</code> (no zero elements) and <code>1.0</code> (all elements are effectively zero).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/ham.jl#L126-L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_sparsity-Tuple{Vector{&lt;:AbstractArray}}" href="#Hamster.get_sparsity-Tuple{Vector{&lt;:AbstractArray}}"><code>Hamster.get_sparsity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_sparsity(H::Vector{AbstractArray}; sp_tol=1e-10)</code></pre><p>Calculates the sparsity of a vector of arrays by determining the fraction of elements across all arrays that are considered effectively zero based on a specified numerical tolerance.</p><p><strong>Arguments:</strong></p><ul><li><code>H::Vector{AbstractArray}</code>: A vector containing arrays (e.g., matrices) for which sparsity is to be calculated. Each element of <code>H</code> should be an array of the same size.</li><li><code>sp_tol::Real=1e-10</code>: The numerical tolerance used to determine whether an element is considered zero. Elements with both real and imaginary parts less than <code>sp_tol</code> in magnitude are considered zero.</li></ul><p><strong>Returns:</strong></p><ul><li><code>sparsity::Float64</code>: The fraction of elements across all arrays in <code>H</code> that are considered zero according to the specified tolerance. This value lies between <code>0.0</code> (no zero elements) and <code>1.0</code> (all elements are effectively zero).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/ham.jl#L149-L160">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.gradient_apply_spin_basis-Tuple{AbstractMatrix}" href="#Hamster.gradient_apply_spin_basis-Tuple{AbstractMatrix}"><code>Hamster.gradient_apply_spin_basis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gradient_apply_spin_basis(dHr::AbstractMatrix; alternating_order=false)</code></pre><p>Calculate the gradient of the spin basis applied to a given matrix <code>dHr</code>. The output matrix is of size <code>(Nε/2, Nε/2)</code>.</p><p>This function reshapes the input matrix <code>dHr</code>, which is expected to represent a gradient in a spin system, into a form suitable for applying the spin basis transformation. The transformation is performed using the Kronecker product, and the output is computed depending on the specified order of application.</p><p><strong>Arguments</strong></p><ul><li><code>dHr::AbstractMatrix</code>: An abstract matrix containing the gradient data to be transformed. It should have a shape that is compatible with the spin basis operations.</li><li><code>alternating_order::Bool</code>: A flag that determines the order of the spin basis application. If <code>false</code>, the function applies the transformation as <code>kron(H, I_spin)</code>. If <code>true</code>, it applies the transformation as <code>kron(I_spin, H)</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/ham.jl#L204-L214">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.reshape_and_sparsify_eigenvectors-Tuple{Any, Hamster.Dense}" href="#Hamster.reshape_and_sparsify_eigenvectors-Tuple{Any, Hamster.Dense}"><code>Hamster.reshape_and_sparsify_eigenvectors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reshape_and_sparsify_eigenvectors(vs, mode::SparsityMode; sp_tol=1e-10) -&gt; Matrix</code></pre><p>Reshapes and optionally sparsifies a 3D array of eigenvectors <code>vs</code> into a 2D matrix of vectors,  depending on the specified <code>SparsityMode</code>. </p><p>The input <code>vs</code> is assumed to have dimensions <code>(n, m, k)</code>, where:</p><ul><li><code>n</code> represents the size of each eigenvector.</li><li><code>m</code> and <code>k</code> represent the number of eigenvector groups along two axes.</li></ul><p><strong>Arguments</strong></p><ul><li><code>vs::Array</code>: A 3D array of eigenvectors, where <code>vs[:, m, k]</code> corresponds to the eigenvector at position <code>(m, k)</code>.</li><li><code>mode::SparsityMode</code>: Specifies the sparsity mode. Must be either:<ul><li><code>Dense</code>: Produces a dense matrix where each element is a dense vector.</li><li><code>Sparse</code>: Produces a sparse matrix where each element is a sparse vector.</li></ul></li><li><code>sp_tol::Float64=1e-10</code>: (Optional) The tolerance below which elements of the eigenvectors are dropped when  <code>Sparse</code> mode is selected. Defaults to <code>1e-10</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>Matrix{Vector{ComplexF64}}</code> if <code>mode</code> is <code>Dense</code>: A 2D matrix of dense vectors corresponding to eigenvectors in <code>vs</code>.</li><li><code>Matrix{SparseVector{ComplexF64, Int64}}</code> if <code>mode</code> is <code>Sparse</code>: A 2D matrix of sparse vectors, where elements smaller  than <code>sp_tol</code> are removed.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/ham.jl#L228-L250">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SparseArrays.droptol!" href="#SparseArrays.droptol!"><code>SparseArrays.droptol!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">droptol!(H::Vector{AbstractSparseMatrix}, tol=1e-10)</code></pre><p>Applies a tolerance to drop small elements from a vector of sparse matrices, modifying the matrices in place.</p><p><strong>Arguments:</strong></p><ul><li><code>H::Vector{AbstractSparseMatrix}</code>: A vector of sparse matrices where small elements will be dropped. The matrices are modified in place.</li><li><code>tol::Real=1e-8</code>: The numerical tolerance used to determine which elements are considered too small and should be dropped. Elements with absolute values less than <code>tol</code> are removed from the sparse matrices.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/ham.jl#L172-L180">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.chain_rule-Tuple{Any, Any, Any}" href="#Hamster.chain_rule-Tuple{Any, Any, Any}"><code>Hamster.chain_rule</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">chain_rule(dL_dE, dE_dHr, mode)</code></pre><p>Applies the chain rule to compute the gradient of the loss with respect to the real-space Hamiltonian matrix elements by combining partial derivatives <code>dL_dE</code> and <code>dE_dHr</code>.</p><p><strong>Arguments</strong></p><ul><li><code>dL_dE</code>: An array containing the partial derivatives of the loss with respect to the eigenvalues, with shape <code>(m, k)</code>, where <code>m</code> is the eigenvalue index and <code>k</code> is the k-point index.</li><li><code>dE_dHr</code>: A 3D array of Matrices containing the partial derivatives of the eigenvalues with respect to the Hamiltonian in real-space coordinates, with shape <code>(R, m, k)</code>, where <code>R</code> is the lattice vector index.</li><li><code>mode</code>: Specifies whether the Hamiltonian is sparse or dense, determining the data structure of the result.</li></ul><p><strong>Returns</strong></p><ul><li><code>dL_dHr</code>: A real-space Hamiltonian gradient array, where each element contains the accumulated gradient for a specific lattice vector in <code>R</code>. Its shape is determined by the Hamiltonian structure and <code>mode</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/ham_grad.jl#L95-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_eigenvalue_gradient" href="#Hamster.get_eigenvalue_gradient"><code>Hamster.get_eigenvalue_gradient</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_eigenvalue_gradient(vs, Rs, ks, sp_mode, sp_iterator; nthreads_bands, nthreads_kpoints)</code></pre><p>Compute the gradient <code>dE_dHr</code> of each energy eigenvalue at each k-point w.r.t. the real-space Hamiltonian matrix elements.</p><p><strong>Arguments</strong></p><p>-<code>vs</code>: Matrix that contains the (sparse) eigenvectors of each eigenvalue <code>(m, k)</code>.</p><ul><li><code>Rs::Matrix{Int64}</code>: Lattice translation vectors in units of the lattice vectors.</li><li><code>ks::Matrix{Float64}</code>: The coordinates of each k-point in units of the reciprocal lattice vectors.</li><li><code>sp_mode</code>: Either <code>Dense</code> or <code>Sparse</code>, determines whether the gradients are sparsified.</li><li><code>sp_iterator</code>: Special iterator to optimize iteration over <code>i, j, R</code> for very sparse systems.</li></ul><p><strong>Returns</strong></p><ul><li><code>dE_dHr</code>: An array of shape <code>(NR, Nε, Nk)</code> that contains (sparse) matrices of shape <code>(Nε, Nε)</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/ham_grad.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.hellman_feynman!-Tuple{Any, Any, Any}" href="#Hamster.hellman_feynman!-Tuple{Any, Any, Any}"><code>Hamster.hellman_feynman!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hellman_feynman!(dE_dλ, Ψ_i, dHk_ij)</code></pre><p>Compute the gradient of the eigenvalues using the Hellmann-Feynman theorem and store the results in <code>dE_dλ</code>.</p><p><strong>Arguments</strong></p><ul><li><code>dE_dλ::AbstractArray</code>: Pre-allocated array to store the computed gradients (as Nε×Nε matrix), typically of size <code>(NR, Nε, Nk)</code>. </li><li><code>Ψ_i::AbstractArray</code>: Array of eigenvectors (wavefunctions), typically of size <code>(Nε, Nk)</code>.</li><li><code>dHk_ij::AbstractArray</code>: Array representing the derivative of the Hamiltonian with respect some <code>λ</code> for each lattice vector and k-point. Its size is typically <code>(NR, Nk)</code>.</li></ul><p><strong>Details</strong></p><p>For each k-point <code>k</code> and eigenstate <code>m</code>, this function computes the matrix element of the form:</p><pre><code class="nohighlight hljs">⟨Ψ_i[m, k] | dHk_ij[R, k] | Ψ_i[m, k]⟩</code></pre><p>and stores the real part of this value in <code>dE_dλ[R, m, k]</code>. This is done for each lattice vector <code>R</code>, eigenstate <code>m</code>, and k-point <code>k</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/ham_grad.jl#L37-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.read_ham" href="#Hamster.read_ham"><code>Hamster.read_ham</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_ham(comm, ind=0; filename=&quot;ham.h5&quot;, space=&quot;k&quot;)</code></pre><p>Read a Hamiltonian and associated vectors from an HDF5 file previously written with <code>write_ham</code>.</p><p><strong>Arguments</strong></p><ul><li><code>comm::MPI.Comm</code>: MPI communicator used to open the HDF5 file in parallel mode.</li><li><code>ind::Int=0</code>: Optional index to identify which Hamiltonian group to read.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>filename::AbstractString=&quot;ham.h5&quot;</code>: Name of the HDF5 file to read from.</li><li><code>space::AbstractString=&quot;k&quot;</code>: Label used in the Hamiltonian group name (e.g., <code>&quot;Hk&quot;</code> or <code>&quot;Hk_1&quot;</code>).</li></ul><p><strong>Returns</strong></p><ul><li><code>H::Vector{SparseMatrixCSC}</code>: Vector of Hamiltonian blocks reconstructed as sparse matrices.</li><li><code>vecs::Array</code>: The stored array of vectors associated with the Hamiltonian.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/ham_write.jl#L136-L152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.read_hr" href="#Hamster.read_hr"><code>Hamster.read_hr</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_hr(filename=&quot;hamster_hr.dat&quot;; sp_mode=false, verbose=1)</code></pre><p>Reads Hamiltonian data and corresponding lattice vectors from a file, reconstructing the Hamiltonian matrices and lattice vectors.</p><p><strong>Arguments:</strong></p><ul><li><code>filename::String=&quot;hamster_hr.dat&quot;</code>: The name of the file containing the Hamiltonian data. The default file name is <code>&quot;hamster_hr.dat&quot;</code>.</li><li><code>sp_mode::Bool=false</code>: If <code>true</code>, enables sparse matrix storage mode for the Hamiltonians. This is useful for large, sparse Hamiltonians to save memory.</li><li><code>verbose::Int64</code>: Sets the verbosity. <code>verbose=0</code> deactivates print statements.</li></ul><p><strong>Returns:</strong></p><ul><li><code>Hr</code>: A vector of 2D arrays where each element <code>Hr[R]</code> is a Hamiltonian matrix corresponding to the lattice vector <code>Rs[:, R]</code>. Each <code>Hr[R]</code> is a 2D array of size <code>(Nε, Nε)</code>, where <code>Nε</code> is the size of the Hamiltonian matrices.</li><li><code>Rs</code>: A 2D array where each column is a lattice vector corresponding to the Hamiltonians in <code>Hr</code>. The array has dimensions <code>(3, NR)</code>, representing the lattice vectors in 3D space.</li></ul><p><strong>Behavior:</strong></p><ul><li>The function reads the Hamiltonian data from the specified file.</li><li>The first line of the file specifies the size of the Hamiltonian matrix (<code>Nε</code>).</li><li>The second line specifies the number of lattice vectors (<code>NR</code>).</li><li>The function reads the subsequent lines to extract the Hamiltonian elements and their corresponding lattice vectors.</li><li>If <code>sp_mode</code> is <code>true</code>, the Hamiltonians are stored in a sparse format. Otherwise, a dense format is used.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/ham_write.jl#L54-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.write_ham" href="#Hamster.write_ham"><code>Hamster.write_ham</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_ham(H, vecs, comm, ind=0; filename=&quot;ham.h5&quot;, space=&quot;k&quot;)</code></pre><p>Write a Hamiltonian, represented as a vector of sparse matrices, into an HDF5 file in a parallel MPI setting.</p><p><strong>Arguments</strong></p><ul><li><code>H::Vector{SparseMatrixCSC}</code>: Vector of sparse matrices that form the Hamiltonian blocks.</li><li><code>vecs::AbstractArray</code>: Array of vectors with one vector per block (k or R vectors).</li><li><code>comm::MPI.Comm</code>: MPI communicator used to open the HDF5 file in parallel mode.</li><li><code>ind::Int=0</code>: Optional index label (e.g., for each atomic configuration).</li></ul><p><strong>File structure</strong></p><p>The Hamiltonian is stored under a group named:</p><ul><li><code>&quot;H$space&quot;</code> if <code>ind == 0</code></li><li><code>&quot;H${space}_$ind&quot;</code> otherwise</li></ul><p>Inside this group:</p><ul><li><code>&quot;vecs&quot;</code>: dataset containing the supplied <code>vecs</code> (k or R vectors).</li><li>Subgroups <code>&quot;1&quot;</code>, <code>&quot;2&quot;</code>, …, one for each block in <code>H</code>, containing:<ul><li><code>&quot;rowval&quot;</code>, <code>&quot;colptr&quot;</code>, <code>&quot;nzval&quot;</code>: the CSC representation of the sparse matrix.</li><li><code>&quot;m&quot;</code>, <code>&quot;n&quot;</code>: matrix dimensions.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/ham_write.jl#L96-L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.write_hr-Tuple{Any, Any}" href="#Hamster.write_hr-Tuple{Any, Any}"><code>Hamster.write_hr</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_hr(Hr, Rs; filename=&quot;hamster_hr&quot;, tol=1e-8, verbose=1)</code></pre><p>Writes Hamiltonian data <code>Hr</code> and corresponding lattice vectors <code>Rs</code> to a file.</p><p><strong>Arguments:</strong></p><ul><li><code>Hr</code>: A vector of matrices where each <code>Hr[R]</code> contains the Hamiltonian elements corresponding to the lattice vector <code>Rs[:, R]</code>.</li><li><code>Rs</code>: A 2D array where each column is a lattice vector corresponding to the Hamiltonian elements in <code>Hr</code>. The array has dimensions <code>(3, NR)</code>, representing the lattice vectors in 3D space.</li><li><code>filename::String=&quot;hamster_hr&quot;</code>: The base name of the output file. The function appends <code>.dat</code> to this base name to create the final output file name.</li><li><code>tol::Float64=1e-8</code>: A tolerance threshold for determining whether a Hamiltonian element should be considered non-zero and written to the file. Elements with absolute values below this threshold are omitted from the output.</li><li><code>verbose::Int64</code>: Sets the verbosity. <code>verbose=0</code> deactivates print statements.</li></ul><p><strong>Behavior:</strong></p><ul><li>The function writes the Hamiltonian data to a file named <code>filename.dat</code>.</li><li>The first line of the file contains the size of the Hamiltonian matrix (<code>Nε</code>).</li><li>The second line contains the number of lattice vectors (<code>NR</code>).</li><li>The function writes only the non-zero elements of <code>Hr</code> (as determined by <code>tol</code>) to the file, along with their corresponding lattice vector indices and matrix indices.</li><li>The output file format aligns the numeric values to fixed-width columns for readability.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/ham_write.jl#L1-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.TBModel" href="#Hamster.TBModel"><code>Hamster.TBModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TBModel</code></pre><p>A mutable struct representing a tight-binding model.</p><p><strong>Fields</strong></p><ul><li><code>h::Matrix{SparseMatrixCSC{Float64, Int64}}</code>: A matrix where each element is a sparse matrix representing the geometry tensor.</li><li><code>parameter_labels::Vector</code>: A vector containing the label for each parameter.</li><li><code>V::Vector{Float64}</code>: A vector containing the model&#39;s parameters.</li><li><code>update::Bool</code>: A boolean flag indicating whether the model&#39;s parameters <code>V</code> should be updated during optimization or kept fixed.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/model.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.TBModel" href="#Hamster.TBModel"><code>Hamster.TBModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TBModel(strc::Structure, basis::Basis, conf=get_empty_config(); update_tb, initas)</code></pre><p>Constructs a <code>TBModel</code> for the given structure <code>strc</code> and basis <code>basis</code>, based on the configuration <code>conf</code>.</p><p><strong>Arguments</strong></p><ul><li><code>strc::Structure</code>: The structure of the material or system being modeled.</li><li><code>basis::Basis</code>: The basis functions or orbitals used to describe the electronic states in the tight-binding model.</li><li><code>conf</code>: (Optional) A configuration object that contains various settings and parameters for building the model.</li><li><code>update_tb</code>: (Optional) A flag indicating whether the model&#39;s parameters should be updated during optimization. Defaults to <code>get_update_tb(conf)</code>.</li><li><code>initas</code>: (Optional) Initialization parameters for the model. Defaults to <code>get_init_params(conf)</code>.</li></ul><p><strong>Returns</strong></p><ul><li>A <code>TBModel</code> object with the geometry tensor <code>h</code> and the model&#39;s parameters set via <code>init_params!</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/model.jl#L19-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_hr" href="#Hamster.get_hr"><code>Hamster.get_hr</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_hr(h, V=model.V, mode=Val{:dense})</code></pre><p>Construct the real-space Hamiltonian (<code>Hr</code>) by multiplying the geometry tensor <code>h</code> with the parameters <code>V</code>.</p><p><strong>Arguments</strong></p><ul><li><code>h</code>: A 2D array of matrices where each element <code>h[v, R]</code> represents a Hamiltonian block associated with parameter <code>v</code> and lattice vector <code>R</code>.</li><li><code>V</code>: A vector of parameters.</li><li><code>mode</code>: Optional argument that specifies the format of the resulting Hamiltonian (<code>Hr</code>). Defaults to <code>Val{:dense}</code>, but can be other types such as sparse.</li></ul><p><strong>Returns</strong></p><ul><li><code>Hr</code>: The resulting real-space Hamiltonian matrix (or array of matrices), constructed by summing the weighted Hamiltonian blocks for each lattice vector <code>R</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/model.jl#L50-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_model_gradient-Tuple{Any, Vector{&lt;:AbstractMatrix}}" href="#Hamster.get_model_gradient-Tuple{Any, Vector{&lt;:AbstractMatrix}}"><code>Hamster.get_model_gradient</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_model_gradient(model, dL_dHr)</code></pre><p>Computes the gradient of the model&#39;s parameters using the given derivative of the Hamiltonian dL<em>dHr. If dL</em>dHr is not a vector of matrices (i.e., it represents multiple structures),  the function assumes it contains gradients for multiple structures and returns the average gradient across these structures.</p><p><strong>Arguments</strong></p><ul><li><code>model</code>: A model object containing the parameters <code>V</code> and the geometry tensor <code>h</code>.</li><li><code>dL_dHr</code>: A matrix or array representing the derivative of the loss w.r.t. real-space Hamiltonian matrix elements.</li></ul><p><strong>Returns</strong></p><ul><li>The gradients for each parameter in <code>model.V</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/model.jl#L91-L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_model_gradient-Tuple{TBModel, Any, Any, Any}" href="#Hamster.get_model_gradient-Tuple{TBModel, Any, Any, Any}"><code>Hamster.get_model_gradient</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_model_gradient(ham::EffectiveHamiltonian, indices, reg, dL_dHr)</code></pre><p>Computes the gradient of the loss w.r.t. the model parameters.</p><p><strong>Arguments</strong></p><ul><li><code>ham::EffectiveHamiltonian</code>: The effective Hamiltonian model.</li><li><code>indices::AbstractVector</code>: A set of structure indices.</li><li><code>reg</code>: A regularization term or parameter used in the gradient computation.</li><li><code>dL_dHr</code>: The derivative of the loss function with respect to the Hamiltonian.</li></ul><p><strong>Returns</strong></p><ul><li><code>AbstractVector</code>: A collection of gradients, one for each model in the <code>ham.models</code>, computed using the provided indices, regularization term, and loss derivative.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/model.jl#L118-L131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_params-Tuple{TBModel}" href="#Hamster.get_params-Tuple{TBModel}"><code>Hamster.get_params</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_params(model::TBModel)</code></pre><p>Retrieve the parameters associated with a <code>TBModel</code>.</p><p><strong>Arguments</strong></p><ul><li><code>model::TBModel</code>: The tight-binding model instance from which to extract parameters.</li></ul><p><strong>Returns</strong></p><ul><li>The parameters stored in the <code>V</code> field of the given <code>TBModel</code> instance.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/model.jl#L181-L191">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.init_params!" href="#Hamster.init_params!"><code>Hamster.init_params!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">init_params!(model, basis, conf=get_empty_config(); initas=get_init_params(conf))</code></pre><p>Initialize the parameters of a <code>model</code> based on the provided configuration and initialization method.</p><p><strong>Arguments</strong></p><ul><li><code>model</code>: The model whose parameter array <code>V</code> will be initialized.</li><li><code>basis</code>: The <code>Basis</code> structure containing orbital and overlap information, as well as the parameters that will be initialized in the model.</li><li><code>conf</code>: Configuration settings that can be used to customize how parameters are initialized. By default, an empty configuration is used.</li><li><code>initas</code>: Initialization method (e.g., <code>ones</code>, <code>random</code> or a file).</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>conf</code>: Configuration settings.</li><li><code>initas</code>: The initialization method or file path for parameters. Defaults to <code>ones</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/model.jl#L148-L162">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.set_params!-Tuple{TBModel, Any}" href="#Hamster.set_params!-Tuple{TBModel, Any}"><code>Hamster.set_params!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_params!(model::TBModel, V)</code></pre><p>Set the parameters of a <code>TBModel</code> instance while ensuring consistency with the model&#39;s structure.</p><p><strong>Arguments</strong></p><ul><li><code>model::TBModel</code>: The tight-binding model whose parameters are to be updated.</li><li><code>V</code>: The new parameter vector to assign to the model&#39;s <code>V</code> field.</li></ul><p><strong>Error Conditions</strong></p><ul><li>Throws an error if the parameter vector <code>V</code> is not of the correct size.</li></ul><p><strong>Returns</strong></p><ul><li>Updates the <code>V</code> field of the <code>model</code> in place if the consistency checks pass.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/model.jl#L205-L219">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.update!-Tuple{TBModel, Any, Any}" href="#Hamster.update!-Tuple{TBModel, Any, Any}"><code>Hamster.update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update!(model::TBModel, opt, dV)</code></pre><p>Updates the parameters of the given TB model <code>model</code> using the provided optimizer <code>opt</code> and the gradient <code>dV</code>.</p><p><strong>Arguments</strong></p><ul><li><code>model</code>: A <code>TBModel</code> object that contains the parameters to be updated.</li><li><code>opt</code>: An optimization algorithm or method used to update the model&#39;s parameters.</li><li><code>dV</code>: The gradient of the loss w.r.t. to the model parameters.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/model.jl#L77-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.write_params" href="#Hamster.write_params"><code>Hamster.write_params</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_params(model::TBModel, conf=get_empty_config())</code></pre><p>Writes the parameters of a <code>TBModel</code> using its parameter labels and values.</p><p><strong>Arguments</strong></p><ul><li><code>model::TBModel</code>: The tight-binding model whose parameters need to be written.</li><li><code>conf</code>: (Optional) Configuration settings, defaults to an empty configuration.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/model/model.jl#L194-L202">source</a></section></article><h1 id="SOC"><a class="docs-heading-anchor" href="#SOC">SOC</a><a id="SOC-1"></a><a class="docs-heading-anchor-permalink" href="#SOC" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Mtrans" href="#Hamster.Mtrans"><code>Hamster.Mtrans</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><ul><li><code>Mtrans</code>: Dictionary mapping the type of orbital (&quot;s&quot;, &quot;p&quot;, &quot;d&quot;) to its corresponding  transformation matrix (Ms, Mp, Md).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_matrix.jl#L91-L94">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.gen_permutation_matrix-Tuple{Vector{String}, Vector{String}}" href="#Hamster.gen_permutation_matrix-Tuple{Vector{String}, Vector{String}}"><code>Hamster.gen_permutation_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gen_permutation_matrix(initial_order::Vector{String}, desired_order::Vector{String}) -&gt; Array{Int, 2}</code></pre><p>Generate a permutation matrix <code>P</code> that will reorder elements from <code>initial_order</code> to <code>desired_order</code>.</p><p><strong>Arguments</strong></p><ul><li><code>initial_order</code>: A vector of strings representing the initial order of elements.</li><li><code>desired_order</code>: A vector of strings representing the desired order of elements.</li></ul><p><strong>Returns</strong></p><ul><li>The permutation matrix <code>P</code> that reorders <code>initial_order</code> to <code>desired_order</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_matrix.jl#L116-L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_Msoc_d" href="#Hamster.get_Msoc_d"><code>Hamster.get_Msoc_d</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_Msoc_d(output_basis_order::Vector{String} = [&quot;dz2↑&quot;, &quot;dxz↑&quot;, &quot;dyz↑&quot;, &quot;dx2-y2↑&quot;, &quot;dxy↑&quot;, &quot;dz2↓&quot;, &quot;dxz↓&quot;, &quot;dyz↓&quot;, &quot;dx2-y2↓&quot;, &quot;dxy↓&quot;]) -&gt; Matrix{Complex{Float64}}</code></pre><p>Construct the spin-orbit coupling matrix for <code>d</code> orbitals in the spatial basis. This function starts by generating the basis in the |lm,s&gt; representation, calculates the spin-orbit coupling matrix in this basis, and then transforms it to the spatial basis. A permutation is applied to align with the specified output basis order, and numerical tolerance is used to set small values effectively to zero.</p><p><strong>Arguments</strong></p><ul><li><code>output_basis_order</code>: The order of orbitals and spins in the output matrix, provided as an array of strings.                       The default order is the one given in the thesis.</li></ul><p><strong>Returns</strong></p><ul><li>The spin-orbit coupling matrix for <code>d</code> orbitals, ordered according to <code>output_basis_order</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_matrix.jl#L176-L190">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_Msoc_ho-Tuple{Any}" href="#Hamster.get_Msoc_ho-Tuple{Any}"><code>Hamster.get_Msoc_ho</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_Msoc_ho(axes; mode=&quot;sp3dr2&quot;) -&gt; BlockDiagonal</code></pre><p>Calculate the spin-orbit coupling (SOC) matrix for a given atomic axes and hybridization mode.</p><p><strong>Arguments</strong></p><ul><li><code>axes::Matrix{Float64}</code>: The orientation axes of the current atom.</li><li><code>mode::String</code>: The hybridization mode, either &quot;sp3&quot; or &quot;sp3dr2&quot; (default: &quot;sp3dr2&quot;).</li></ul><p><strong>Returns</strong></p><ul><li><code>BlockDiagonal</code>: The SOC matrix in the hybridized basis.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_matrix.jl#L201-L212">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_Msoc_p" href="#Hamster.get_Msoc_p"><code>Hamster.get_Msoc_p</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_Msoc_p(output_basis_order::Vector{String} = [&quot;pz↑&quot;, &quot;px↑&quot;, &quot;py↑&quot;, &quot;pz↓&quot;, &quot;px↓&quot;, &quot;py↓&quot;]) -&gt; Matrix{Complex{Float64}}</code></pre><p>Calculate the spin-orbit coupling matrix for <code>p</code> orbitals. The function constructs the matrix in the |lm,s&gt; basis, transforms it to the spatial basis for <code>p</code> orbitals, applies a permutation to match the specified output basis order, and then applies numerical tolerance to trim small values.</p><p><strong>Arguments</strong></p><ul><li><code>output_basis_order</code>: A vector of strings that defines the order of the orbital and spin basis in the output matrix.                       The default order is the one given in the thesis.</li></ul><p><strong>Returns</strong></p><ul><li>A matrix representing the spin-orbit coupling in the spatial basis with the specified output order.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_matrix.jl#L152-L165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_Msoc_s" href="#Hamster.get_Msoc_s"><code>Hamster.get_Msoc_s</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_Msoc_s() -&gt; zeros(Complex{Float64}, 2, 2)</code></pre><p>Calculate the spin-orbit coupling matrix for the s orbitals / a zero matrix.</p><p><strong>Returns</strong></p><ul><li>The spin-orbit coupling matrix <code>Msoc_s</code> for s orbitals.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_matrix.jl#L142-L149">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_hybrid_coefficient_matrix-Tuple{Any}" href="#Hamster.get_hybrid_coefficient_matrix-Tuple{Any}"><code>Hamster.get_hybrid_coefficient_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_hybrid_coefficient_matrix(axes; mode=&quot;sp3dr2&quot;) -&gt; Matrix{ComplexF64}</code></pre><p>Calculate the hybrid coefficient matrix for given axes and mode.</p><p><strong>Arguments</strong></p><ul><li><code>axes::Matrix{Float64}</code>: The axes for the atom.</li><li><code>mode::String</code>: The hybridization mode, either &quot;sp3&quot; or &quot;sp3dr2&quot; (default: &quot;sp3dr2&quot;).</li></ul><p><strong>Returns</strong></p><ul><li><code>Matrix{ComplexF64}</code>: The hybrid coefficient matrix.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_matrix.jl#L265-L276">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_soc_matrices" href="#Hamster.get_soc_matrices"><code>Hamster.get_soc_matrices</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_soc_matrices(strc::Structure) -&gt; Vector{BlockDiagonal}</code></pre><p>Precompute the spin-orbit coupling (SOC) matrices for a given structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_matrix.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_sp3_expansion_coefficients-Tuple{Any, Any}" href="#Hamster.get_sp3_expansion_coefficients-Tuple{Any, Any}"><code>Hamster.get_sp3_expansion_coefficients</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_sp3_expansion_coefficients(θ, φ; Nspd=[1, 3, 0]) -&gt; Vector{Float64}</code></pre><p>Calculate the sp3 expansion coefficients for given angles θ and φ.</p><p><strong>Arguments</strong></p><ul><li><code>θ::Float64</code>: Polar angle.</li><li><code>φ::Float64</code>: Azimuthal angle.</li><li><code>Nspd::Vector{Int}</code>: Relative proportions of s, p, and d orbitals (default: [1, 3, 0]).</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Float64}</code>: The expansion coefficients in the order: s, px, py, pz.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_matrix.jl#L238-L250">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.trans_lm_spatial-Union{Tuple{T}, Tuple{String, Matrix{T}}} where T" href="#Hamster.trans_lm_spatial-Union{Tuple{T}, Tuple{String, Matrix{T}}} where T"><code>Hamster.trans_lm_spatial</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">trans_lm_spatial(orb::String, Msoc::Array{T, 2}) where T -&gt; Array{T, 2}</code></pre><p>Transform the spin-orbit coupling matrix <code>Msoc</code> from the spin basis to the spatial basis for the given orbital type <code>orb</code>.</p><p><strong>Arguments</strong></p><ul><li><code>orb</code>: Orbital type as a string (&quot;s&quot;, &quot;p&quot;, or &quot;d&quot;).</li><li><code>Msoc</code>: Matrix representing the spin-orbit coupling in the spin basis.</li></ul><p><strong>Returns</strong></p><ul><li>The transformed spin-orbit coupling matrix in the spatial basis.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_matrix.jl#L98-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.SOCModel" href="#Hamster.SOCModel"><code>Hamster.SOCModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct SOCModel{M}</code></pre><p>A mutable struct representing a model for Spin-Orbit Coupling (SOC) effects.</p><p><strong>Fields:</strong></p><ul><li><code>params::Vector{Float64}</code>: A vector of model parameters.</li><li><code>unique_ion_types::Vector{String}</code>: A vector of unique ion types involved in the system, represented as strings.</li><li><code>all_type_types::Vector{String}</code>: A vector containing all ion types, possibly with repetitions, represented as strings.</li><li><code>matrices::Vector{M}</code>: A vector of matrices that describe the SOC interactions for the given orbital basis.</li><li><code>Rs::Matrix{Float64}</code>: A matrix that contains the lattice translation vectors.</li><li><code>update::Bool</code>: A boolean flag indicating whether the model is set to update its parameters or not.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_model.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_hr-Tuple{SOCModel, Any, Any}" href="#Hamster.get_hr-Tuple{SOCModel, Any, Any}"><code>Hamster.get_hr</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_hr(soc_model::SOCModel, sp_mode, index; apply_soc=true) -&gt; BlockDiagonal</code></pre><p>Constructs the Hamiltonian representation for a given spin-orbit coupling (SOC) model.</p><p><strong>Arguments</strong></p><ul><li><code>soc_model::SOCModel</code>: The spin-orbit coupling model containing ion types, parameters, and matrices.</li><li><code>sp_mode</code>: Unused parameter (possibly reserved for future functionality).</li><li><code>index</code>: The index of the ion type for parameter retrieval.</li><li><code>apply_soc::Bool</code> (default: <code>true</code>): If <code>true</code>, applies SOC-related modifications (not explicitly used in this function).</li></ul><p><strong>Returns</strong></p><ul><li>A <code>BlockDiagonal</code> matrix where each block corresponds to an ion type, with parameters expanded and applied to SOC matrices.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_model.jl#L30-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_model_gradient-Tuple{SOCModel, Any, Any, Any}" href="#Hamster.get_model_gradient-Tuple{SOCModel, Any, Any, Any}"><code>Hamster.get_model_gradient</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_model_gradient(soc_model::SOCModel, indices, reg, dL_dHr)</code></pre><p>Computes the gradient of loss w.r.t. the SOC model&#39;s parameters.</p><p><strong>Arguments:</strong></p><ul><li><code>soc_model::SOCModel</code>: The SOC model.</li><li><code>indices</code>: The structure indices (not used here).</li><li><code>reg</code>: A regularization term that penalizes certain parameter values to avoid overfitting or enforce specific behavior.</li><li><code>dL_dHr</code>: Gradient of the loss w.r.t. the Hamiltonian matrix elements.</li></ul><p><strong>Returns:</strong></p><ul><li><code>dparams</code>: A vector containing the gradient of the loss w.r.t. the model parameters.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_model.jl#L70-L83">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_params-Tuple{SOCModel}" href="#Hamster.get_params-Tuple{SOCModel}"><code>Hamster.get_params</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_params(soc_model::SOCModel) -&gt; Vector</code></pre><p>Retrieves the parameters of a given spin-orbit coupling (SOC) model.</p><p><strong>Arguments</strong></p><ul><li><code>soc_model::SOCModel</code>: The SOC model containing the parameter set.</li></ul><p><strong>Returns</strong></p><ul><li>A vector of parameters associated with the SOC model.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_model.jl#L136-L146">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.init_soc_params" href="#Hamster.init_soc_params"><code>Hamster.init_soc_params</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">init_soc_params(ions, conf=get_empty_config(); initas=get_soc_init_params(conf)) -&gt; Vector{Float64}</code></pre><p>Initializes spin-orbit coupling (SOC) parameters for a given set of ions based on the specified initialization method.</p><p><strong>Arguments</strong></p><ul><li><code>ions</code>: A collection of ion objects.</li><li><code>conf</code>: (Optional) Configuration object used for consistency checks. Defaults to <code>get_empty_config()</code>.</li><li><code>initas</code>: (Optional) Specifies the initialization method:<ul><li><code>&#39;z&#39;</code>: Initializes all parameters to zero.</li><li><code>&#39;o&#39;</code>: Initializes all parameters to one.</li><li><code>&#39;r&#39;</code>: Initializes parameters with random values.</li><li>File path or identifier: Reads SOC parameters from an external source.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_model.jl#L105-L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.set_params!-Tuple{SOCModel, Any}" href="#Hamster.set_params!-Tuple{SOCModel, Any}"><code>Hamster.set_params!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_params!(soc_model::SOCModel, params) -&gt; Nothing</code></pre><p>Updates the parameters of a spin-orbit coupling (SOC) model.</p><p><strong>Arguments</strong></p><ul><li><code>soc_model::SOCModel</code>: The SOC model whose parameters will be updated.</li><li><code>params</code>: A vector of new parameters to assign to the model.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_model.jl#L149-L157">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.update!-Tuple{SOCModel, Any, Any}" href="#Hamster.update!-Tuple{SOCModel, Any, Any}"><code>Hamster.update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update!(soc_model::SOCModel, opt, dparams) -&gt; Nothing</code></pre><p>Updates the parameters of a spin-orbit coupling (SOC) model using an optimization routine.</p><p><strong>Arguments</strong></p><ul><li><code>soc_model::SOCModel</code>: The SOC model whose parameters will be updated.</li><li><code>opt</code>: The optimizer or update rule to apply to the parameters.</li><li><code>dparams</code>: The parameter updates (e.g., gradients or step values).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_model.jl#L56-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.write_params" href="#Hamster.write_params"><code>Hamster.write_params</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_params(soc_model::SOCModel, conf=get_empty_config()) -&gt; Nothing</code></pre><p>Writes the parameters of a spin-orbit coupling (SOC) model to a file.</p><p><strong>Arguments</strong></p><ul><li><code>soc_model::SOCModel</code>: The SOC model whose parameters will be written.</li><li><code>conf</code>: Configuration settings (default: an empty configuration from <code>get_empty_config()</code>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_model.jl#L167-L175">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.convert_block_matrix_to_sparse-Tuple{BlockDiagonals.BlockDiagonal}" href="#Hamster.convert_block_matrix_to_sparse-Tuple{BlockDiagonals.BlockDiagonal}"><code>Hamster.convert_block_matrix_to_sparse</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">convert_block_matrix_to_sparse(M::BlockDiagonal; sp_tol=1e-10) -&gt; SparseMatrixCSC</code></pre><p>Converts a <code>BlockDiagonal</code> matrix <code>M</code> to a <code>SparseMatrixCSC</code> by iterating through each block and collecting the nonzero entries (within a given tolerance).</p><p><strong>Arguments</strong></p><ul><li><code>M::BlockDiagonal</code>: A block diagonal matrix, typically from <code>BlockDiagonals.jl</code> or similar libraries.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_utils.jl#L171-L179">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_lms_basis-Tuple{String}" href="#Hamster.get_lms_basis-Tuple{String}"><code>Hamster.get_lms_basis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_basis_lm(orb::String) -&gt; Vector{Vector{Int64}}</code></pre><p>Create the basis set in the |lm,s&gt; representation for a given type of orbital specified by <code>orb</code>. This function asserts that <code>orb</code> is one of the strings &quot;s&quot;, &quot;p&quot;, or &quot;d&quot;, which correspond to  the different orbital types. It uses the <code>num_mdict</code> to fetch the corresponding <code>m</code> values and constructs a basis set with <code>l</code>, <code>m</code>, and <code>spin</code> quantum numbers.</p><p><strong>Arguments</strong></p><ul><li><code>orb</code>: A string specifying the orbital type (&quot;s&quot;, &quot;p&quot;, or &quot;d&quot;).</li></ul><p><strong>Returns</strong></p><ul><li><code>basis</code>: A vector of vectors, with each sub-vector containing the quantum numbers <code>[l, m, spin]</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_utils.jl#L11-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_matrix_lmbasis-Tuple{Vector{Vector{Int64}}}" href="#Hamster.get_matrix_lmbasis-Tuple{Vector{Vector{Int64}}}"><code>Hamster.get_matrix_lmbasis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_matrix_lmbasis(basis::Vector{Vector{Int}}) -&gt; Matrix{Complex{Float64}}</code></pre><p>Construct the spin-orbit coupling matrix in the |lm,s&gt; basis. This matrix represents the dot product of the angular momentum operators with the spin operators.</p><p><strong>Arguments</strong></p><ul><li><code>basis</code>: A vector of basis sets, each represented by a vector of quantum numbers <code>[l, m, spin]</code>.</li></ul><p><strong>Returns</strong></p><ul><li>A matrix of type <code>Complex{Float64}</code> representing the spin-orbit coupling in the given basis.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_utils.jl#L104-L115">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.mapLmSp-Tuple{Vector{Int64}}" href="#Hamster.mapLmSp-Tuple{Vector{Int64}}"><code>Hamster.mapLmSp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mapLmSp(lms::Vector{Int}) -&gt; Tuple{Float64, Vector{Int}}</code></pre><p>Map the |lm,s&gt; state to another state with the momentum and spin ladder operator L-S+. The function calculates the coefficient for the operation and the resulting state.</p><p><strong>Arguments</strong></p><ul><li><code>lms</code>: A vector of quantum numbers <code>[l, m, s]</code>.</li></ul><p><strong>Returns</strong></p><ul><li>A tuple of the coefficient of the operation and the new quantum numbers <code>[l, m-1, s+2]</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_utils.jl#L64-L75">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.mapLpSm-Tuple{Vector{Int64}}" href="#Hamster.mapLpSm-Tuple{Vector{Int64}}"><code>Hamster.mapLpSm</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mapLpSm(lms::Vector{Int}) -&gt; Tuple{Float64, Vector{Int}}</code></pre><p>Map the |lm,s&gt; state to another state with the momentum and spin ladder operator L+S-. The function calculates the coefficient for the operation and the resulting state.</p><p><strong>Arguments</strong></p><ul><li><code>lms</code>: A vector of quantum numbers <code>[l, m, s]</code>.</li></ul><p><strong>Returns</strong></p><ul><li>A tuple of the coefficient of the operation and the new quantum numbers <code>[l, m+1, s-2]</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_utils.jl#L41-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.mapLzSz-Tuple{Vector{Int64}}" href="#Hamster.mapLzSz-Tuple{Vector{Int64}}"><code>Hamster.mapLzSz</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mapLzSz(lms::Vector{Int}) -&gt; Tuple{Int, Vector{Int}}</code></pre><p>Map the |lm,s&gt; state to itself while calculating the coefficient for the LzSz operation.</p><p><strong>Arguments</strong></p><ul><li><code>lms</code>: A vector of quantum numbers <code>[l, m, s]</code>.</li></ul><p><strong>Returns</strong></p><ul><li>A tuple of the coefficient m for s=1 or -m for s=-1, and the unchanged quantum numbers <code>[l, m, s]</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_utils.jl#L87-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.separate_spin_secs-Tuple{Any}" href="#Hamster.separate_spin_secs-Tuple{Any}"><code>Hamster.separate_spin_secs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">separate_spin_secs(orb_order::Vector{String}) -&gt; Vector{String}</code></pre><p>Reorder the basis by separating the spin components. This function does not alter  the order of spatial dimensions (e.g., s, py, sp3₁), but sorts the spin sector such  that all up-spin (↑) components appear before all down-spin (↓) components.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_utils.jl#L158-L164">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.thresholding" href="#Hamster.thresholding"><code>Hamster.thresholding</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">thresholding(c::Complex, real_threshold::Real=1e-15) -&gt; Complex</code></pre><p>Apply thresholding to a complex number, setting real and imaginary parts below the threshold to zero.</p><p><strong>Arguments</strong></p><ul><li><code>c::Complex</code>: The complex number to threshold.</li><li><code>real_threshold::Real</code>: The threshold value for the real and imaginary parts (default: 1e-15).</li></ul><p><strong>Returns</strong></p><ul><li><code>Complex</code>: The thresholded complex number.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/soc/soc_utils.jl#L140-L151">source</a></section></article><h1 id="ML"><a class="docs-heading-anchor" href="#ML">ML</a><a id="ML-1"></a><a class="docs-heading-anchor-permalink" href="#ML" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.decide_orbswap-NTuple{6, Any}" href="#Hamster.decide_orbswap-NTuple{6, Any}"><code>Hamster.decide_orbswap</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">decide_orbswap(itype, jtype, l_i, m_i, l_j, m_j) -&gt; Bool</code></pre><p>Determines whether two orbitals should be swapped to enforce a consistent ordering, based on their associated ion types and quantum numbers. The ordering is determined by:</p><ol><li>Comparing element types using a periodic table-based numerical ordering (<code>element_to_number</code>).</li><li>If element types are the same, comparing orbital angular momentum quantum numbers (<code>l_i</code>, <code>l_j</code>).</li><li>If <code>l</code> values are equal, comparing magnetic quantum numbers (<code>m_i</code>, <code>m_j</code>).</li></ol><p>This helps maintain consistent descriptor or feature vector construction in systems involving atomic orbitals.</p><p><strong>Arguments</strong></p><ul><li><code>itype</code>: Symbol or string representing the first ion type (e.g., <code>:H</code>, <code>&quot;O&quot;</code>).</li><li><code>jtype</code>: Symbol or string representing the second ion type.</li><li><code>l_i</code>: Orbital angular momentum quantum number of the first orbital.</li><li><code>m_i</code>: Magnetic quantum number of the first orbital.</li><li><code>l_j</code>: Orbital angular momentum quantum number of the second orbital.</li><li><code>m_j</code>: Magnetic quantum number of the second orbital.</li></ul><p><strong>Returns</strong></p><ul><li><code>true</code> if the orbitals should be swapped to maintain ordering; <code>false</code> otherwise.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/mlham/descriptor.jl#L87-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.farthest_point_sampling-Tuple{Any, Any, Any}" href="#Hamster.farthest_point_sampling-Tuple{Any, Any, Any}"><code>Hamster.farthest_point_sampling</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">farthest_point_sampling(descriptors, cluster_indices, num_to_take)</code></pre><p>Selects <code>num_to_take</code> diverse points from a subset of data specified by <code>cluster_indices</code> using greedy farthest-point sampling based on Euclidean distance.</p><p><strong>Arguments</strong></p><ul><li><code>descriptors::AbstractMatrix{&lt;:Real}</code>: A matrix of feature vectors where each column corresponds to a data point.</li><li><code>cluster_indices::Vector{Int}</code>: Indices of the points in <code>descriptors</code> that belong to the cluster to sample from.</li><li><code>num_to_take::Int</code>: Number of points to select.</li></ul><p><strong>Returns</strong></p><ul><li><code>selected::Vector{Int}</code>: Indices of the selected points (subset of <code>cluster_indices</code>) representing a diverse subset.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/mlham/descriptor.jl#L248-L261">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_angular_descriptors-NTuple{4, Any}" href="#Hamster.get_angular_descriptors-NTuple{4, Any}"><code>Hamster.get_angular_descriptors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_angular_descriptors(itype, jtype, ri, rj, iaxis, jaxis, orbswap)</code></pre><p>Computes angular descriptors based on the relative positions and orbital orientations of two atoms.</p><p><strong>Arguments</strong></p><ul><li><code>itype, jtype</code>: Atomic types of the two atoms.</li><li><code>ri, rj</code>: Position vectors of the two atoms.</li><li><code>iaxis, jaxis</code>: Axes defining the local orbital orientation for each atom.</li></ul><p><strong>Returns</strong></p><ul><li><code>φ::Float64</code>: The angle between the two orbital axes.</li><li><code>θs::Vector{Float64}</code>: A sorted or conditionally reversed list of angles between each axis and the bond direction.</li></ul><p><strong>Behavior</strong></p><ul><li>Computes the normalized bond direction <code>Δrij</code> and <code>Δrji</code> depending on the distance between the atoms.</li><li>Determines the angle <code>φ</code> between the two orbital axes.</li><li>Computes <code>θs</code>, the angles between each axis (<code>iaxis</code>, <code>jaxis</code>) and the respective bond directions.</li><li>Ensures consistent ordering of <code>θs</code> based on atomic types and orbital swapping rules.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/mlham/descriptor.jl#L112-L131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_environmental_descriptor-Tuple{Any, Any, Any, Any, Config}" href="#Hamster.get_environmental_descriptor-Tuple{Any, Any, Any, Any, Config}"><code>Hamster.get_environmental_descriptor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_environmental_descriptor(h, V, strc, basis, conf::Config; apply_params=false, rcut=get_ml_rcut(conf))</code></pre><p>Computes the environmental descriptor for a given structure, basis, and configuration object.</p><p><strong>Arguments</strong></p><ul><li><code>h</code>: The geometry tensor for the given structure.</li><li><code>V</code>: A vector of interaction parameters.</li><li><code>strc</code>: The structure containing lattice and atomic positions.</li><li><code>basis</code>: The basis set defining the system&#39;s orbitals.</li><li><code>conf::Config</code>: Configuration object.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>apply_params</code>: If <code>true</code>, uses <code>V</code> as given; otherwise, is set to ones.</li><li><code>rcut</code>: Cut-off radius for interactions, defaults to <code>get_ml_rcut(conf)</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>env</code>: A vector representing the environmental descriptor.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/mlham/descriptor.jl#L141-L159">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_tb_descriptor-Tuple{Any, Any, Structure, Any, Config}" href="#Hamster.get_tb_descriptor-Tuple{Any, Any, Structure, Any, Config}"><code>Hamster.get_tb_descriptor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_tb_descriptor(model, strc, conf)</code></pre><p>Calculate the TB descriptor for a given a TB <code>model</code>, a structure <code>strc</code> and a TBConfig file <code>conf</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/mlham/descriptor.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.reshape_structure_descriptors-Tuple{Any}" href="#Hamster.reshape_structure_descriptors-Tuple{Any}"><code>Hamster.reshape_structure_descriptors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reshape_structure_descriptors(descriptors) -&gt; Matrix{Float64}</code></pre><p>Reshapes a nested structure of sparse descriptors into a dense matrix (to be used as input for kmeans).</p><p><strong>Arguments</strong></p><ul><li><code>descriptors</code>: A nested collection of sparse matrices representing structure descriptors.</li></ul><p><strong>Returns</strong></p><ul><li>A matrix (<code>Matrix{Float64}</code>) where each column corresponds to a flattened descriptor.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/mlham/descriptor.jl#L71-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.sample_structure_descriptors-Tuple{Any}" href="#Hamster.sample_structure_descriptors-Tuple{Any}"><code>Hamster.sample_structure_descriptors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sample_structure_descriptors(descriptors; Ncluster=1, Npoints=1, alpha=0.5, ml_sampling=&quot;random&quot;)</code></pre><p>Selects a subset of descriptor vectors using K-Means clustering, weighted by cluster size and spread.</p><p><strong>Arguments</strong></p><ul><li><code>descriptors</code>: A matrix where each column represents a descriptor vector.</li><li><code>Ncluster::Int=1</code>: The number of clusters for K-Means.</li><li><code>Npoints::Int=1</code>: The total number of descriptor vectors to select.</li><li><code>alpha::Float64=0.5</code>: A weighting factor (0 ≤ α ≤ 1) that balances selection between cluster size (α → 1) and spread (α → 0).</li><li><code>ml_sampling::String</code>: Determines how points are selected from each cluster. Defaults to random.</li></ul><p><strong>Returns</strong></p><ul><li>A matrix of selected descriptor vectors with <code>Npoints</code> columns.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/mlham/descriptor.jl#L184-L198">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.HamiltonianKernel" href="#Hamster.HamiltonianKernel"><code>Hamster.HamiltonianKernel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HamiltonianKernel(strcs, bases, model, conf)</code></pre><p>Constructor for a HamiltonianKernel model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/mlham/kernel.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.HamiltonianKernel" href="#Hamster.HamiltonianKernel"><code>Hamster.HamiltonianKernel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct HamiltonianKernel{T1, T2}</code></pre><p>A kernel structure used for computing weighted similarity functions.</p><p><strong>Fields</strong></p><ul><li><code>ws :: Vector{Float64}</code>: Weights for each sample point.</li><li><code>xs :: Vector{T1}</code>: Sample points.</li><li><code>sim_params :: T2</code>: Parameters for the similarity function.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/mlham/kernel.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_hr-Tuple{HamiltonianKernel, Hamster.Dense, Any}" href="#Hamster.get_hr-Tuple{HamiltonianKernel, Hamster.Dense, Any}"><code>Hamster.get_hr</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_hr(kernel::HamiltonianKernel, mode, index; apply_soc=false) -&gt; Vector{Matrix{Float64}}</code></pre><p>Constructs a set of real-space Hamiltonians from a <code>HamiltonianKernel</code>.</p><p><strong>Arguments</strong></p><ul><li><code>kernel::HamiltonianKernel</code>: The Hamiltonian kernel used for computing matrix elements.</li><li><code>mode</code>: Specifies the sparsity mode.</li><li><code>index</code>: Index specifying which structure to evaluate.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>apply_soc</code>: If <code>true</code>, applies the spin-orbit coupling (SOC) basis transformation.</li></ul><p><strong>Returns</strong></p><ul><li>A vector of real-space Hamiltonian matrices, optionally modified with SOC transformations.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/mlham/kernel.jl#L63-L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_model_gradient-Tuple{HamiltonianKernel, Any, Any, Any}" href="#Hamster.get_model_gradient-Tuple{HamiltonianKernel, Any, Any, Any}"><code>Hamster.get_model_gradient</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_model_gradient(kernel::HamiltonianKernel, indices, reg, dL_dHr) -&gt; Vector{Float64}</code></pre><p>Computes the gradient of the model parameters for a given <code>HamiltonianKernel</code>.</p><p><strong>Arguments</strong></p><ul><li><code>kernel::HamiltonianKernel</code>: The Hamiltonian kernel for which the gradient is computed.</li><li><code>indices</code>: Indices specifying which structure descriptors to use.</li><li><code>reg</code>: Regularization term.</li><li><code>dL_dHr</code>: Gradient of the loss function with respect to the real-space Hamiltonian.</li></ul><p><strong>Returns</strong></p><ul><li><code>dparams</code>: A vector containing the computed gradients of the model parameters.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/mlham/kernel.jl#L247-L260">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_params-Tuple{HamiltonianKernel}" href="#Hamster.get_params-Tuple{HamiltonianKernel}"><code>Hamster.get_params</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_params(kernel::HamiltonianKernel)</code></pre><p>Retrieve the parameters associated with a <code>HamiltonianKernel</code>.</p><p><strong>Arguments</strong></p><ul><li><code>kernel::HamiltonianKernel</code>: The Hamiltonian kernel instance from which to extract parameters.</li></ul><p><strong>Returns</strong></p><ul><li>The parameters stored in the <code>ws</code> field of the given <code>HamiltonianKernel</code> instance.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/mlham/kernel.jl#L120-L130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.init_ml_params!" href="#Hamster.init_ml_params!"><code>Hamster.init_ml_params!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">init_ml_params!(data_points, conf=get_empty_config(); initas=get_ml_init_params(conf))</code></pre><p>Initializes machine learning parameters based on a given initialization strategy and updates the <code>data_points</code>.</p><p><strong>Arguments</strong></p><ul><li><code>data_points</code>: The data points associated with the machine learning parameters.</li><li><code>conf</code>: A configuration object (default: <code>get_empty_config()</code>) containing simulation parameters and settings.</li><li><code>initas</code>: A string (default: <code>get_ml_init_params(conf)</code>) that specifies the initialization strategy. Possible values:<ul><li><code>&#39;z&#39;</code>: Initialize parameters to zeros.</li><li><code>&#39;o&#39;</code>: Initialize parameters to ones.</li><li><code>&#39;r&#39;</code>: Initialize parameters with random values.</li><li><code>file</code>: Initialize parameters from a file <code>initas</code></li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/mlham/kernel.jl#L196-L209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.read_ml_params" href="#Hamster.read_ml_params"><code>Hamster.read_ml_params</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_ml_params(conf=get_empty_config(); filename=get_ml_filename(conf))</code></pre><p>Reads the parameters for a HamiltonianKernel model from a file and returns the parameters and associated data points.</p><p><strong>Arguments</strong></p><ul><li><code>conf</code>: A configuration object (default: <code>get_empty_config()</code>) containing simulation parameters and settings.</li><li><code>filename</code>: The name of the <code>.dat</code> file to read from (default: <code>get_ml_filename(conf)</code>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/mlham/kernel.jl#L163-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.set_params!-Tuple{HamiltonianKernel, Any}" href="#Hamster.set_params!-Tuple{HamiltonianKernel, Any}"><code>Hamster.set_params!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_params!(kernel::HamiltonianKernel, ws)</code></pre><p>Set the parameters of a <code>HamiltonianKernel</code> instance.</p><p><strong>Arguments</strong></p><ul><li><code>kernel::HamiltonianKernel</code>: The kernel model whose parameters are to be updated.</li><li><code>ws</code>: The new parameter vector.</li></ul><p><strong>Error Conditions</strong></p><ul><li>Throws an error if the parameter vector <code>ws</code> is not of the correct size.</li></ul><p><strong>Returns</strong></p><ul><li>Updates the <code>Vs</code> field of the <code>kernel</code> in place if the consistency checks pass.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/mlham/kernel.jl#L223-L237">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.update!-Tuple{HamiltonianKernel, Any, Any}" href="#Hamster.update!-Tuple{HamiltonianKernel, Any, Any}"><code>Hamster.update!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update!(kernel::HamiltonianKernel, opt, grad)</code></pre><p>Updates the parameters of a <code>HamiltonianKernel</code> using an optimization method <code>opt</code>.</p><p><strong>Arguments</strong></p><ul><li><code>kernel::HamiltonianKernel</code>: The Hamiltonian kernel whose parameters are to be updated.</li><li><code>opt</code>: The optimizer used to perform the update.</li><li><code>grad</code>: The gradient used for updating the parameters.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/mlham/kernel.jl#L106-L115">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.write_params" href="#Hamster.write_params"><code>Hamster.write_params</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_params(kernel::HamiltonianKernel, conf=get_empty_config(); filename=get_ml_filename(conf))</code></pre><p>Writes the parameters and configuration settings of a HamiltonianKernel object to a file.</p><p><strong>Arguments</strong></p><ul><li><code>kernel::HamiltonianKernel</code>: The HamiltonianKernel object containing the parameters and data points to write to the file.</li><li><code>conf</code>: A configuration object (default: <code>get_empty_config()</code>) containing simulation parameters and settings.</li><li><code>filename</code>: The name of the file to which the data will be written (default: <code>get_ml_filename(conf)</code>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/mlham/kernel.jl#L133-L142">source</a></section></article><h1 id="Optimization"><a class="docs-heading-anchor" href="#Optimization">Optimization</a><a id="Optimization-1"></a><a class="docs-heading-anchor-permalink" href="#Optimization" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Adam" href="#Hamster.Adam"><code>Hamster.Adam</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Adam(η = 0.001, β::Tuple = (0.9, 0.999), ϵ = 1.0e-8)</code></pre><p><a href="https://arxiv.org/abs/1412.6980">Adam</a> optimiser.</p><p><strong>Parameters</strong></p><ul><li>Learning rate (<code>η</code>): Amount by which gradients are discounted before updating                      the weights.</li><li>Decay of momentums (<code>β::Tuple</code>): Exponential decay for the first (β1) and the                                  second (β2) momentum estimate.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">opt = Adam()
opt = Adam(0.001, (0.9, 0.8))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/adam.jl#L3-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.DataLoader" href="#Hamster.DataLoader"><code>Hamster.DataLoader</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DataLoader{A, B}</code></pre><p>A struct to store and manage training and validation datasets.</p><p><strong>Fields</strong></p><ul><li><code>train_data::Vector{A}</code>: A vector containing the training dataset. The type <code>A</code> represents the data type of the training set.</li><li><code>val_data::Vector{B}</code>: A vector containing the validation dataset. The type <code>B</code> represents the data type of the validation set.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/data.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.EigData" href="#Hamster.EigData"><code>Hamster.EigData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EigData</code></pre><p>A struct for storing eigenvalue data associated with k-points.</p><p><strong>Fields</strong></p><ul><li><code>kp::Matrix{Float64}</code>: A matrix where each column represents a k-point. </li><li><code>Es::Matrix{Float64}</code>: A matrix where each column represents the eigenvalues corresponding to the respective k-point.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/data.jl#L24-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.HrData" href="#Hamster.HrData"><code>Hamster.HrData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HrData{M}</code></pre><p>A struct for storing Hamiltonian data <code>Hr</code> and the associated lattice translation vectors <code>Rs</code> for a system, typically from Wannier90.</p><p><strong>Fields</strong></p><ul><li><code>Rs::Matrix{Float64}</code>: A matrix where each column represents a lattice translation vector.</li><li><code>Hr::Vector{M}</code>: A vector of Hamiltonian matrices <code>Hr</code>, where each entry corresponds to a lattice translation vector in <code>Rs</code>. Each element in this vector is a Hamiltonian matrix, with <code>M</code> representing the matrix type (e.g., dense or sparse).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/data.jl#L38-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_neig_and_nk-Tuple{Vector{Hamster.EigData}}" href="#Hamster.get_neig_and_nk-Tuple{Vector{Hamster.EigData}}"><code>Hamster.get_neig_and_nk</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_neig_and_nk(data::Vector)</code></pre><p>Get the number of eigenvalues and the number of k-points from a collection of data.</p><p><strong>Arguments</strong></p><ul><li><code>data</code>: A vector of either <code>EigData</code> or <code>HrData</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>(Neig, Nk)</code>: The number of eigenvalues and k-points of the first data point. <code>Return 0 for HrData</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/data.jl#L52-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_translation_vectors_for_hr_fit" href="#Hamster.get_translation_vectors_for_hr_fit"><code>Hamster.get_translation_vectors_for_hr_fit</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_translation_vectors_for_hr_fit(conf=get_empty_config(); hr_fit=get_hr_fit(conf), train_data=get_train_data(conf))::Matrix{Float64}</code></pre><p>If fitting the model to Hr data, read the respective translation vectors from the <code>train_data</code> file.</p><p><strong>Arguments</strong></p><ul><li><code>conf</code> (default: <code>get_empty_config()</code>): A <code>Config</code> instance.</li><li><code>hr_fit</code>: If true, model is fit to Hr data.</li><li><code>train_data</code>: Path to the training data file.</li></ul><p><strong>Returns</strong></p><ul><li><code>Rs::Matrix{Float64}</code>: The translation vectors, if not <code>hr_fit</code>, return zeros (Rs are calculated depending on <code>rcut</code>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/data.jl#L120-L132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.GDOptimizer" href="#Hamster.GDOptimizer"><code>Hamster.GDOptimizer</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GDOptimizer(Nε, Nk, conf=get_empty_config(); lr=get_lr(conf), Niter=get_niter(conf))</code></pre><p>Creates a gradient descent optimizer for a given loss function, regularization term, and optimizer configuration.</p><p><strong>Arguments</strong></p><ul><li><code>Nε::Int</code> (optional): Parameter representing the number of energy levels. If <code>Nε == 0</code>, a default configuration is used.</li><li><code>Nk::Int</code> (optional): Parameter representing the number of k-points. If <code>Nk == 0</code>, a default configuration is used.</li><li><code>conf::Any</code>: Configuration object for the optimizer, defaults to <code>get_empty_config()</code>.</li><li><code>lr::Float64</code> (optional): Learning rate for the Adam optimizer. Defaults to the value returned by <code>get_lr(conf)</code>.</li><li><code>Niter::Int</code> (optional): Number of iterations for the optimization process. Defaults to the value returned by <code>get_niter(conf)</code>.</li><li><code>val_weights::Bool</code> (optional): If true, same weights are used for validation as for training.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/gd_optimizer.jl#L24-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.GDOptimizer" href="#Hamster.GDOptimizer"><code>Hamster.GDOptimizer</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GDOptimizer</code></pre><p>A gradient descent optimizer for training Hamiltonian models, incorporating loss functions, regularization, and an Adam optimizer for parameter updates.</p><p><strong>Fields</strong></p><ul><li><code>loss::Loss</code>: The loss function used for training. Determines how the model&#39;s error is measured and minimized during training.</li><li><code>val_loss::Loss</code>: The loss function used for validation. Evaluates the model&#39;s performance on unseen data.</li><li><code>reg::Regularization</code>: Regularization strategy applied during training to prevent overfitting.</li><li><code>adam::Adam</code>: The Adam optimizer instance used for updating model parameters with gradient-based methods.</li><li><code>Niter::Int64</code>: The number of training iterations.</li></ul><p><strong>Usage</strong></p><p>This structure encapsulates all components required for optimizing a Hamiltonian model. It is typically passed to training functions, such as <code>train_step!</code> or <code>optimize_model!</code>, to guide the optimization process.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/gd_optimizer.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Loss" href="#Hamster.Loss"><code>Hamster.Loss</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Loss(Nε, Nk; conf=get_empty_config(), loss=get_loss(conf), wE=get_band_weights(conf, Nε), wk=get_kpoint_weights(conf, Nk))</code></pre><p>Create a <code>Loss</code> object with band weights, k-point weights, and loss norm based on a given configuration.</p><p><strong>Arguments</strong></p><ul><li><code>Nε::Int64</code>: Number of energy bands (dimension of <code>wE</code>).</li><li><code>Nk::Int64</code>: Number of k-points (dimension of <code>wk</code>).</li><li><code>conf</code>: Configuration object (default: <code>get_empty_config()</code>). This is used to retrieve parameters for customizing the loss function.</li><li><code>loss</code>: A string that specifies the type of loss function. The default value is obtained from <code>get_loss(conf)</code>.</li><li><code>wE</code>: Vector of weights for the energy bands, defaulted to <code>get_band_weights(conf, Nε)</code>.</li><li><code>wk</code>: Vector of weights for the k-points, defaulted to <code>get_kpoint_weights(conf, Nk)</code>.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>wE</code>: The band weights, used to scale the errors over energy bands (default provided by configuration).</li><li><code>wk</code>: The k-point weights, used to scale the errors over k-points (default provided by configuration).</li></ul><p><strong>Returns</strong></p><ul><li>A <code>Loss</code> object initialized with the appropriate band weights (<code>wE</code>), k-point weights (<code>wk</code>), normalization factor, and loss norm (<code>n</code>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/loss.jl#L24-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Loss" href="#Hamster.Loss"><code>Hamster.Loss</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct Loss</code></pre><p>A structure representing a (weighted) loss function for evaluating the difference between predicted and true values. The loss is calculated based on a given norm, with optional weights applied to the errors along the prediction and observation dimensions.</p><p><strong>Fields</strong></p><ul><li><code>wE::Vector{Float64}</code>: A vector of weights applied to the error terms along the <code>y</code> dimension (true values).</li><li><code>wk::Vector{Float64}</code>: A vector of weights applied to the error terms along the <code>ŷ</code> dimension (predicted values).</li><li><code>N::Float64</code>: Normalization factor, typically the product of the sums of <code>wE</code> and <code>wk</code>.</li><li><code>n::Int64</code>: The order of the norm used for the loss function (e.g., 1 for L1 norm, 2 for L2 norm, etc.).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/loss.jl#L3-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Regularization" href="#Hamster.Regularization"><code>Hamster.Regularization</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Regularization([conf]; lambda=get_lambda(conf), barrier=get_barrier(conf), lreg=get_lreg(conf)) -&gt; Regularization</code></pre><p>Create a <code>Regularization</code> struct using configuration parameters from the provided configuration or default values.</p><p><strong>Arguments</strong></p><ul><li><code>conf</code>: A configuration object (optional). Default values are used if not provided.</li></ul><p><strong>Returns</strong></p><ul><li>A <code>Regularization</code> struct initialized with the provided or default configuration values for <code>barrier</code>, <code>lambda</code>, and <code>lreg</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/loss.jl#L157-L167">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Regularization" href="#Hamster.Regularization"><code>Hamster.Regularization</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct Regularization</code></pre><p>A data structure that defines the regularization parameters used to penalize model complexity during optimization. Regularization is used to penalize large model parameters to avoid overfitting.</p><p><strong>Fields</strong></p><ul><li><code>b::Float64</code>: The barrier for the regularization term. Regularization is only applied if parameter values surpass this barrier.</li><li><code>λ::Float64</code>: The regularization coefficient (lambda), which controls the intensity of regularization. A higher value leads to stronger regularization.</li><li><code>n::Int64</code>: The norm type used for the regularization term, typically corresponding to L1 (<code>n=1</code>), L2 (<code>n=2</code>), or other norm types.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/loss.jl#L141-L150">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.backward-Tuple{Loss, Any, Any}" href="#Hamster.backward-Tuple{Loss, Any, Any}"><code>Hamster.backward</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">backward(l::Loss, y, ŷ)</code></pre><p>Compute the gradient of the loss function with respect to the predicted values <code>ŷ</code>.</p><p><strong>Arguments</strong></p><ul><li><code>l::Loss</code>: A <code>Loss</code> object which specifies how the loss is calculated.</li><li><code>y::AbstractVector</code>: The predicted for each band and k-point.</li><li><code>ŷ::AbstractVector</code>: The true values (ground truth) for each band and k-point.</li></ul><p><strong>Returns</strong></p><ul><li><code>dL::AbstractArray</code>: The gradient of the loss with respect to the predicted values <code>y</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/loss.jl#L111-L123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.backward-Tuple{Regularization, Any}" href="#Hamster.backward-Tuple{Regularization, Any}"><code>Hamster.backward</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">backward(R::Regularization, x::AbstractVector) -&gt; AbstractVector</code></pre><p>Compute the gradient of the regularization penalty with respect to the input (parameter) vector <code>x</code>.</p><p><strong>Arguments</strong></p><ul><li><code>R::Regularization</code>: A <code>Regularization</code> object.</li><li><code>x::AbstractVector</code>: The input (parameter) vector for which the gradient of the regularization penalty is computed.</li></ul><p><strong>Returns</strong></p><ul><li><code>AbstractVector</code>: A vector of the same size as <code>x</code>, where each element is the gradient of the penalty with respect to the corresponding element in <code>x</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/loss.jl#L189-L201">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.forward-Tuple{Loss, Any, Any}" href="#Hamster.forward-Tuple{Loss, Any, Any}"><code>Hamster.forward</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">forward(l::Loss, y, ŷ)</code></pre><p>Compute the forward pass of the loss function given the true values <code>y</code> and the predicted values <code>ŷ</code>.</p><p><strong>Arguments</strong></p><ul><li><code>l::Loss</code>: A <code>Loss</code> object which specifies how the loss is calculated.</li><li><code>y::AbstractArray</code>: The predicted for each band and k-point.</li><li><code>ŷ::AbstractArray</code>: The true values (ground truth) for each band and k-point.</li></ul><p><strong>Returns</strong></p><p>-<code>L::Float64</code>: The loss between <code>y</code> and <code>ŷ</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/loss.jl#L84-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.forward-Tuple{Regularization, Any}" href="#Hamster.forward-Tuple{Regularization, Any}"><code>Hamster.forward</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">forward(R::Regularization, x::AbstractVector) -&gt; Float64</code></pre><p>Compute the regularization penalty for the given input <code>x</code> using the regularization parameters  defined in the <code>Regularization</code> struct.</p><p><strong>Arguments</strong></p><ul><li><code>R::Regularization</code>: A <code>Regularization</code> object.</li><li><code>x::AbstractVector</code>: The input (parameter) vector over which the regularization penalty is applied.</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: The total regularization penalty</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/loss.jl#L174-L186">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_weight_index_from_key-Tuple{Any}" href="#Hamster.get_weight_index_from_key-Tuple{Any}"><code>Hamster.get_weight_index_from_key</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_weight_index_from_key(key::String) -&gt; UnitRange{Int64}</code></pre><p>Parses a weight key string and returns a range of indices.</p><p><strong>Arguments</strong></p><ul><li><code>key::String</code>: A string representing a weight index, either as a single value (e.g., <code>&quot;key_1&quot;</code>) or as a range (e.g., <code>&quot;key_1-3&quot;</code>).</li></ul><p><strong>Returns</strong></p><ul><li>A <code>UnitRange{Int64}</code> representing the parsed index or index range.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/loss.jl#L63-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.backward" href="#Hamster.backward"><code>Hamster.backward</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">backward(ham::EffectiveHamiltonian, index, loss, data, cache)</code></pre><p>Computes the gradient of the loss for a given Hamiltonian model <code>ham</code> with respect to its matrix elements, based on the specified loss function <code>loss</code> and input data <code>data</code>.  The function behavior varies depending on the type of <code>data</code>, which can be either <code>EigData</code> or <code>HrData</code>.</p><p><strong>Arguments</strong></p><ul><li><code>ham::EffectiveHamiltonian</code>: The Hamiltonian model for which the gradient of the loss is being computed.</li><li><code>index</code>: An index that specifies which Hamiltonian structure to use in the gradient computation.</li><li><code>loss</code>: A function that calculates the discrepancy between computed and ground truth values.</li><li><code>data</code>: Either an <code>EigData</code> object containing k-point and ground truth eigenvalues, or an <code>HrData</code> object containing real-space Hamiltonian data.</li><li><code>cache</code>: A preliminary result from <code>forward</code> that is required to compute the gradient.</li></ul><p><strong>Returns</strong></p><ul><li><code>gradient</code>: The computed gradient of the loss with respect to the parameters of <code>ham</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/optimize.jl#L178-L193">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.forward-Tuple{EffectiveHamiltonian, Any, Any, Hamster.EigData}" href="#Hamster.forward-Tuple{EffectiveHamiltonian, Any, Any, Hamster.EigData}"><code>Hamster.forward</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">forward(ham::EffectiveHamiltonian, index, loss, data)</code></pre><p>Computes the loss for a given Hamiltonian model <code>ham</code> using a specified loss function <code>loss</code> and input data <code>data</code>. The behavior of the function depends on the type of <code>data</code>, which can be either <code>EigData</code> or <code>HrData</code>.</p><p><strong>Arguments</strong></p><ul><li><code>ham::EffectiveHamiltonian</code>: The Hamiltonian model from which effective Hamiltonians or real-space Hamiltonians are derived.</li><li><code>index</code>: An index that specifies which structure to compute.</li><li><code>loss</code>: A function that calculates the discrepancy between computed and ground truth values.</li><li><code>data</code>: Either an <code>EigData</code> object containing k-point and ground truth eigenvalues, or an <code>HrData</code> object containing real-space Hamiltonian data.</li></ul><p><strong>Returns</strong></p><ul><li><code>L_train::Float64</code>: The calculated loss.</li><li><code>cache</code>: A preliminary result that is needed to compute the gradient.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/optimize.jl#L149-L164">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.optimize_model!" href="#Hamster.optimize_model!"><code>Hamster.optimize_model!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">optimize_model!(ham_train, ham_val, optim, dl, prof, conf=get_empty_config(); verbosity=get_verbosity(conf), Nbatch=get_nbatch(conf), validate=get_validate(conf), rank=0, nranks=1)</code></pre><p>Optimizes the model by performing training and optional validation steps.</p><p><strong>Arguments</strong></p><ul><li><code>ham_train</code>: The Hamiltonian model used for training.</li><li><code>ham_val</code>: The Hamiltonian model used for validation (optional).</li><li><code>optim</code>: An optimization configuration, including the optimizer and its settings.</li><li><code>dl</code>: A data loader object containing the training data.</li><li><code>prof</code>: A profiler object used to store training and validation information.</li><li><code>comm</code>: The MPI communicator.</li><li><code>conf</code>: A <code>Config</code> instance.</li><li><code>verbosity</code>: The level of verbosity for logging.</li><li><code>Nbatch</code>: The number of batches per training iteration.</li><li><code>validate</code>: A flag indicating whether to perform validation during training.</li></ul><p><strong>Workflow</strong></p><ol><li>Print the start message.</li><li>For each training iteration, split the training data into batches and perform training steps.</li><li>Optionally validate the model after each training iteration.</li><li>Print the final status once training is complete.</li></ol><p><strong>Returns</strong></p><ul><li>Updates the HamsterProfiler <code>prof</code> and the model parameters in <code>ham_train</code> and <code>ham_val</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/optimize.jl#L1-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.train_step!" href="#Hamster.train_step!"><code>Hamster.train_step!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">train_step!(ham_train, indices, optim, train_data)</code></pre><p>Performs a single training step on a Hamiltonian model by computing gradients and updating model parameters.</p><p><strong>Arguments</strong></p><ul><li><code>ham_train</code>: The Hamiltonian model being trained.</li><li><code>indices</code>: The indices of the structures to be evaluated.</li><li><code>optim</code>: A <code>GDOptimizer</code> instance.</li><li><code>train_data</code>: The training data.</li><li><code>prof</code>: A <code>HamsterProfiler</code> instance.</li><li><code>iter</code>: The iteration index.</li><li><code>batch_id</code>: The batch index.</li><li><code>comm</code>: The MPI communicator.</li><li><code>conf</code>: A <code>Config</code> instance.</li><li><code>rank</code>: The active MPI rank.</li><li><code>nranks</code>: The total number of MPI ranks.</li></ul><p><strong>Side Effects</strong></p><ul><li>Updates the model parameters in-place within <code>ham_train</code>.</li><li>Writes timing information and training loss to <code>prof</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/optimize.jl#L48-L69">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.val_step!-NTuple{6, Any}" href="#Hamster.val_step!-NTuple{6, Any}"><code>Hamster.val_step!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">val_step!(ham_val, loss, val_data, prof, iter, comm, rank=0)</code></pre><p>Evaluates the validation loss for a Hamiltonian model over a given validation dataset, and stores the results in the <code>HamsterProfiler</code> instance. This function also tracks the time taken for validation.</p><p><strong>Arguments</strong></p><ul><li><code>ham_val</code>: The Hamiltonian model being validated.</li><li><code>loss</code>: The loss function used to evaluate the performance of the model.</li><li><code>val_data</code>: A collection of validation data.</li><li><code>prof</code>: An instance of the <code>HamsterProfiler</code> struct that tracks various profiling information, including validation times and losses.</li><li><code>iter</code>: The current iteration number, used to store the validation results at the correct index in the <code>prof</code> instance.</li></ul><p><strong>Returns</strong></p><ul><li><code>L_val</code>: The average validation loss computed over all validation structures. This value is also stored in <code>prof.L_val</code> at the index corresponding to <code>iter</code>.</li><li>Updates to <code>prof.val_times</code>: The elapsed time for the validation step is stored in <code>prof.val_times[iter]</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/optimize.jl#L119-L134">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.HamsterProfiler" href="#Hamster.HamsterProfiler"><code>Hamster.HamsterProfiler</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HamsterProfiler(Ntimes, conf=get_empty_config(); Nbatch=get_nbatch(conf), Niter=get_niter(conf), printeachbatch=get_printeachbatch(conf), printeachiter=get_printeachiter(conf))</code></pre><p>A constructor function for initializing a <code>HamsterProfiler</code> instance.</p><p><strong>Arguments</strong></p><ul><li><code>Ntimes::Int</code>: The number of timing measurements to store for each batch and iteration.</li><li><code>conf::Dict</code>: A configuration dictionary (optional). Default is the result of <code>get_empty_config()</code>.</li><li><code>Nbatch::Int</code>: The number of batches (optional). Default is determined by the value of <code>get_nbatch(conf)</code>.</li><li><code>Niter::Int</code>: The number of iterations (optional). Default is determined by the value of <code>get_niter(conf)</code>.</li><li><code>printeachbatch::Bool</code>: A flag to determine whether to print detailed status for each batch (optional). Default is determined by the value of <code>get_printeachbatch(conf)</code>.</li><li><code>printeachiter::Int</code>: Specifies the frequency of printing status updates (optional). Default is determined by the value of <code>get_printeachiter(conf)</code>.</li></ul><p>-<code>Nparams::Int</code>: The number of parameters that are optimized.</p><p><strong>Returns</strong></p><ul><li>An instance of the <code>HamsterProfiler</code> struct.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/profiler.jl#L34-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.HamsterProfiler" href="#Hamster.HamsterProfiler"><code>Hamster.HamsterProfiler</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HamsterProfiler</code></pre><p>A data structure for tracking and managing profiling information during an iterative process, including loss, timing, and verbosity settings.</p><p><strong>Fields</strong></p><ul><li><code>L_train::Matrix{Float64}</code>: A 2D array where each row corresponds to training loss values for a specific batch across iterations.</li><li><code>L_val::Vector{Float64}</code>: A 1D array containing validation loss values across iterations.</li><li><code>printeachbatch::Bool</code>: Indicates whether to print detailed status updates for each batch during training.</li><li><code>printeachiter::Int64</code>: Specifies the frequency (in number of iterations) at which status updates are printed.</li><li><code>timings::Array{Float64, 3}</code>: A 3D array storing timing information:<ul><li>First dimension: batches.</li><li>Second dimension: iterations.</li><li>Third dimension: additional timing steps or phases within each iteration.</li></ul></li><li><code>val_times::Vector{Float64}</code>: A 1D array containing validation timing information for each iteration.</li><li><code>param_values::Vector{Float64}</code>: A 2D array where each column stores the parameter values for a given iteration.</li></ul><p><strong>Usage</strong></p><p>The <code>HamsterProfiler</code> struct is used in training workflows to:</p><ul><li>Record and track training and validation loss values.</li><li>Measure and store timing data for profiling purposes.</li><li>Control the verbosity and frequency of printed status updates.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/profiler.jl#L1-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.decide_printit-NTuple{5, Any}" href="#Hamster.decide_printit-NTuple{5, Any}"><code>Hamster.decide_printit</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">decide_printit(batch_id, Nbatch, iter, printeachbatch, printeachiter; verbosity=verbosity)</code></pre><p>Determines whether to print status updates based on the current iteration, batch, and verbosity settings.</p><p><strong>Arguments</strong></p><ul><li><code>batch_id::Int</code>: The current batch identifier.</li><li><code>Nbatch::Int</code>: The total number of batches.</li><li><code>iter::Int</code>: The current iteration number.</li><li><code>printeachbatch::Bool</code>: Whether to print at the end of each batch.</li><li><code>printeachiter::Int</code>: Interval for printing during iterations if <code>printeachbatch</code> is false.</li><li><code>verbosity::Int</code>: (Keyword argument) The verbosity level. Printing is disabled if <code>verbosity</code> is less than 1.</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: <code>true</code> if a status update should be printed, <code>false</code> otherwise.</li></ul><p><strong>Behavior</strong></p><ol><li>If <code>verbosity &lt; 1</code>, printing is disabled and the function returns <code>false</code>.</li><li>If <code>printeachbatch</code> is <code>true</code>, the function always returns <code>true</code>.</li><li>Otherwise, printing occurs only if:<ul><li>The current batch is the last batch (<code>batch_id == Nbatch</code>), and</li><li>The current iteration number (<code>iter</code>) is a multiple of <code>printeachiter</code>.</li></ul></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/profiler.jl#L216-L238">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.print_final_status-Tuple{Any}" href="#Hamster.print_final_status-Tuple{Any}"><code>Hamster.print_final_status</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">print_final_status(prof)</code></pre><p>Prints the final loss, the total time elapsed, and a message indicating that the run has finished.</p><p><strong>Arguments</strong></p><ul><li><code>prof</code>: A HamsterProfiler instance used to compute <code>final_loss</code> and <code>total_time</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/profiler.jl#L182-L189">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.print_iteration_status-NTuple{7, Any}" href="#Hamster.print_iteration_status-NTuple{7, Any}"><code>Hamster.print_iteration_status</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">print_iteration_status(iter, Niter, batch_id, Nbatch, L_train, time_iter, time_left)</code></pre><p>Prints the current status of an iterative process, including iteration number, batch details, loss, and timing information.</p><p><strong>Arguments</strong></p><ul><li><code>iter::Int</code>: The current iteration number.</li><li><code>Niter::Int</code>: The total number of iterations.</li><li><code>batch_id::Int</code>: The current batch identifier (use <code>0</code> if not using batches).</li><li><code>Nbatch::Int</code>: The total number of batches (use <code>0</code> if not using batches).</li><li><code>L_train::Union{Float64, Int}</code>: The current training loss value. Use <code>0</code> if loss is not being reported.</li><li><code>time_iter::Float64</code>: Time elapsed for the current iteration, in seconds.</li><li><code>time_left::Float64</code>: Estimated time remaining to complete the process, in seconds.</li></ul><p><strong>Behavior</strong></p><p>The function adapts its printed output based on the values of <code>batch_id</code> and <code>L_train</code>:</p><ol><li><strong>No batches and loss reported</strong>:<ul><li>Prints iteration number, total iterations, loss, iteration time, and estimated time left.</li></ul></li><li><strong>No batches, no loss reported</strong>:<ul><li>Prints iteration number, total iterations, iteration time, and estimated time left.</li></ul></li><li><strong>With batches and loss reported</strong>:<ul><li>Prints batch number, total batches, iteration number, total iterations, loss, iteration time, and estimated time left.</li></ul></li><li><strong>With batches, no loss reported</strong>:<ul><li>Prints batch number, total batches, iteration number, total iterations, iteration time, and estimated time left.</li></ul></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/profiler.jl#L125-L149">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.print_start_message-Tuple{HamsterProfiler}" href="#Hamster.print_start_message-Tuple{HamsterProfiler}"><code>Hamster.print_start_message</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">print_start_message(prof)</code></pre><p>Prints a message indicating the start of a run, along with the total number of iterations.</p><p><strong>Arguments</strong></p><ul><li><code>prof</code>: A HamsterProfiler instance.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/profiler.jl#L162-L169">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.print_train_status-Tuple{Any, Any, Any}" href="#Hamster.print_train_status-Tuple{Any, Any, Any}"><code>Hamster.print_train_status</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">print_train_status(prof, iter, batch_id; verbosity=1)</code></pre><p>Prints the training status during an iterative training process, including loss, timing, and iteration progress.</p><p><strong>Arguments</strong></p><ul><li><code>prof</code>: A profiling object containing training data, configuration, and timing information. Expected fields include:<ul><li><code>L_train</code>: A 2D array where each row corresponds to batch loss values across iterations.</li><li><code>timings</code>: A 3D array of timing data, where the first dimension corresponds to batch timing, the second to iteration, and the third to another dimension (e.g., steps or phases).</li><li><code>printeachbatch</code>: A boolean indicating whether to print details for every batch.</li><li><code>printeachiter</code>: A boolean indicating whether to print details for iterations only.</li></ul></li><li><code>iter::Int</code>: The current iteration number.</li><li><code>batch_id::Int</code>: The current batch identifier (use <code>0</code> if not using batches).</li><li><code>verbosity::Int</code> (optional): Controls the level of detail in the output. Default is <code>1</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/profiler.jl#L57-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.print_val_start-Tuple{Any, Any}" href="#Hamster.print_val_start-Tuple{Any, Any}"><code>Hamster.print_val_start</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">print_val_start(; verbosity=1)</code></pre><p>Prints a message indicating the start of the model validation process.</p><p><strong>Arguments</strong></p><ul><li><code>verbosity</code>: (optional) An integer controlling the level of output. If <code>verbosity &gt; 0</code>, the message &quot;Validating model...&quot; will be printed. Default is <code>1</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/profiler.jl#L94-L101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.print_val_status-Tuple{Any, Any}" href="#Hamster.print_val_status-Tuple{Any, Any}"><code>Hamster.print_val_status</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">print_val_status(prof, iter; verbosity=1)</code></pre><p>Prints the validation loss and the time taken for validation at a specific iteration during the training process.</p><p><strong>Arguments</strong></p><ul><li><code>prof</code>: A <code>HamsterProfiler</code> object that contains profiling information, including the validation loss (<code>L_val</code>) and validation times (<code>val_times</code>).</li><li><code>iter</code>: The current iteration number in the training process.</li><li><code>verbosity</code>: (optional) An integer controlling the level of output. If <code>verbosity &gt; 0</code>, the validation status will be printed. Default is <code>1</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/profiler.jl#L107-L116">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.save" href="#Hamster.save"><code>Hamster.save</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_prof(prof::HamsterProfiler; filename=&quot;hamster_out.h5&quot;)</code></pre><p>Write the contents of a <code>HamsterProfiler</code> object to an HDF5 file (only if <code>rank==0</code>).</p><p><strong>Arguments</strong></p><ul><li><code>prof::HamsterProfiler</code>: The profiler instance.</li><li><code>filename::String=&quot;hamster_out.h5&quot;</code>: Path to the HDF5 file to write.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/optim/profiler.jl#L251-L259">source</a></section></article><h1 id="Parsing-functions"><a class="docs-heading-anchor" href="#Parsing-functions">Parsing functions</a><a id="Parsing-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Parsing-functions" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.parse_commandline-Tuple{Any}" href="#Hamster.parse_commandline-Tuple{Any}"><code>Hamster.parse_commandline</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_commandline(args::Vector{String}) -&gt; Dict{String, String}</code></pre><p>Parses command-line arguments from a vector of strings <code>args</code> and returns a dictionary of parsed arguments.</p><p><strong>Arguments</strong></p><ul><li><code>args</code>: A vector of command-line arguments passed as strings.</li></ul><p><strong>Behavior</strong></p><ul><li>Keyword arguments (<code>--option</code>): If an argument starts with <code>--</code>, it is treated as a key with an associated value in the following position. If a comma is found at the end of an argument, the following arguments are concatenated until no comma is found.</li><li>Flags (<code>-o</code>): If an argument starts with a single <code>-</code>, it is treated as a flag and is set to <code>true</code> (empty &quot;–&quot; arguments are also treated as flags).</li><li>Positional arguments: stored with key <code>pos_arg_i</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>args_dict</code>: A dictionary containing parsed command-line arguments. Long options are stored as key-value pairs, flags are stored with a value of <code>true</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/parse/commandline.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.read_eigenval" href="#Hamster.read_eigenval"><code>Hamster.read_eigenval</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_eigenval(file::AbstractString, nmax::Int=1000000)</code></pre><p>Read the <code>EIGENVAL</code> VASP output file and extract the k-points, energy bands and occupancies.</p><p><strong>Arguments</strong></p><ul><li><code>file::AbstractString</code>: The path to the <code>EIGENVAL</code> file.</li><li><code>nmax::Int=1000000</code>: The maximum number of bands to read. Default is 1,000,000.</li></ul><p><strong>Returns</strong></p><ul><li><code>kpoints::Array{Float64, 2}</code>: A 3 x nkpts array where each column represents a k-point.</li><li><code>E_bands::Array{Float64, 2}</code>: An nbands x nkpts array of energy bands.</li><li><code>occs::Array{Float64, 2}</code>: An nbrand × nkpts array of band occupancies.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/parse/eigenval.jl#L1-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Poscar" href="#Hamster.Poscar"><code>Hamster.Poscar</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct Poscar</code></pre><p>A structure to represent the data contained in a VASP POSCAR file.</p><p><strong>Fields</strong></p><ul><li><code>a::Float64</code>: The scaling factor.</li><li><code>lattice::Array{Float64, 2}</code>: A 3x3 array representing the lattice vectors.</li><li><code>atom_names::Array{AbstractString, 1}</code>: An array of atom names.</li><li><code>atom_numbers::Array{Int64, 1}</code>: An array of the number of each type of atom.</li><li><code>rs_atom::Array{Float64, 2}</code>: A 3xNion array of atomic positions.</li><li><code>atom_types::Array{String, 1}</code>: An array of atom types corresponding to each atom position.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/parse/poscar.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.read_poscar-Tuple{Any}" href="#Hamster.read_poscar-Tuple{Any}"><code>Hamster.read_poscar</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_poscar(poscar::AbstractString) -&gt; Poscar</code></pre><p>Extract all data from the POSCAR file at <code>poscar</code>.</p><p><strong>Arguments</strong></p><ul><li><code>poscar::AbstractString</code>: The path to the POSCAR file.</li></ul><p><strong>Returns</strong></p><ul><li><code>Poscar</code>: A <code>Poscar</code> struct containing all the extracted data from the POSCAR file, including:<ul><li><code>a</code>: The scaling factor.</li><li><code>lattice</code>: The 3x3 array of lattice vectors.</li><li><code>atom_names</code>: An array of atom names.</li><li><code>atom_numbers</code>: An array of the number of each type of atom.</li><li><code>rs_atom</code>: A 3xNion array of atomic positions.</li><li><code>atom_types</code>: An array of atom types corresponding to each atom position.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/parse/poscar.jl#L23-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.collapse_files_with-Tuple{Any}" href="#Hamster.collapse_files_with-Tuple{Any}"><code>Hamster.collapse_files_with</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">collapse_files_with!(str)</code></pre><p>Searches for all output files in the <code>&quot;tmp&quot;</code> directory that contain the substring <code>str</code> in their filename.   Reads and combines their data into a single large array, then writes the merged result to a new file named <code>str*&quot;.dat&quot;</code>.</p><p><strong>Arguments</strong></p><ul><li><code>str::String</code>: A substring to match filenames in the <code>&quot;tmp&quot;</code> directory.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/parse/utils.jl#L149-L157">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.next_line_with-Tuple{AbstractArray, Any}" href="#Hamster.next_line_with-Tuple{AbstractArray, Any}"><code>Hamster.next_line_with</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">next_line_with(keywords, lines)</code></pre><p>Find the next line in lines that contains a set of keywords.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/parse/utils.jl#L102-L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.open_and_read-Tuple{Any}" href="#Hamster.open_and_read-Tuple{Any}"><code>Hamster.open_and_read</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">open_and_read(file::AbstractString) -&gt; Vector{String}</code></pre><p>Open a file, read all lines, and return them as a vector of strings.</p><p><strong>Arguments</strong></p><ul><li><code>file::AbstractString</code>: The path to the file to be read.</li></ul><p><strong>Returns</strong></p><ul><li><code>lines::Vector{String}</code>: A vector where each element is a line from the file.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/parse/utils.jl#L28-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.parse_lines_as_array-Tuple{Any}" href="#Hamster.parse_lines_as_array-Tuple{Any}"><code>Hamster.parse_lines_as_array</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_lines_as_array(lines; i1=1, i2=3, type=Float64)</code></pre><p>Parses a list of strings into a 2D array, extracting and converting elements from each line based on specified indices and type.</p><p><strong>Arguments</strong></p><ul><li><code>lines</code>: A list of strings, where each string is a line containing elements to be parsed.</li><li><code>i1</code> (optional): The starting index for the elements to extract from each line. Defaults to <code>1</code>.</li><li><code>i2</code> (optional): The ending index for the elements to extract from each line. Defaults to <code>3</code>.</li><li><code>type</code> (optional): The type to which the extracted elements should be converted. Defaults to <code>Float64</code>.</li></ul><p><strong>Returns</strong></p><ul><li>A 2D array of the specified <code>type</code>, where each row corresponds to a line and each column corresponds to an extracted element from the line.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/parse/utils.jl#L79-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.print_hamster" href="#Hamster.print_hamster"><code>Hamster.print_hamster</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">print_hamster(io_stream=stdout)</code></pre><p>Prints an ASCII art Hamster logo and description.</p><p><strong>Arguments</strong></p><ul><li><code>io_stream::IO</code>: The output stream to which the text should be printed. Defaults to <code>stdout</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/parse/utils.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.read_from_file-Tuple{Any}" href="#Hamster.read_from_file-Tuple{Any}"><code>Hamster.read_from_file</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_from_file(filename, type)</code></pre><p>Read an Array <code>M</code> with elements of <code>type</code> from the file with name <code>filename</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/parse/utils.jl#L134-L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.split_line-Tuple{Any}" href="#Hamster.split_line-Tuple{Any}"><code>Hamster.split_line</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">split_line(line::String) -&gt; Vector{String}</code></pre><p>Splits a line of text into individual words, removing any extra spaces.</p><p><strong>Arguments</strong></p><ul><li><code>line::String</code>: A string representing the line of text to be split.</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{String}</code>: An array of words from the input line, excluding any empty elements.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/parse/utils.jl#L66-L76">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.split_lines-Tuple{Any}" href="#Hamster.split_lines-Tuple{Any}"><code>Hamster.split_lines</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">split_lines(lines::Vector{String}) -&gt; Vector{Vector{String}}</code></pre><p>Split each line of the input vector of strings into its constituent non-empty elements.</p><p><strong>Arguments</strong></p><ul><li><code>lines::Vector{String}</code>: A vector of strings, where each string represents a line to be split.</li></ul><p><strong>Returns</strong></p><ul><li><code>split_lines::Vector{Vector{String}}</code>: A vector of vectors of strings, where each inner vector </li></ul><p>contains the non-empty elements of the corresponding line from the input.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/parse/utils.jl#L46-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.write_to_file-Tuple{Any, Any}" href="#Hamster.write_to_file-Tuple{Any, Any}"><code>Hamster.write_to_file</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_to_file(M, filename)</code></pre><p>Write the Array <code>M</code> and shape to a new file with name <code>filename</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/parse/utils.jl#L120-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.read_hrdat" href="#Hamster.read_hrdat"><code>Hamster.read_hrdat</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_hrdat(file::String)</code></pre><p>Read a Wannier90 <code>hr.dat</code> file and extract the Hamiltonian matrix elements, lattice vectors, and degeneracy values.</p><p><strong>Arguments</strong></p><ul><li><code>file::String</code>: The path to the <code>hr.dat</code> file.</li></ul><p><strong>Returns</strong></p><ul><li>A tuple containing:<ul><li><code>Hᴿ::Array{ComplexF64, 3}</code>: The Hamiltonian matrix elements, a 3D array with dimensions (num<em>wann, num</em>wann, NR).</li><li><code>Rs::Array{Float64, 2}</code>: The lattice vectors, a 2D array with dimensions (3, NR).</li><li><code>deg::Vector{Int64}</code>: The degeneracy values, a vector of length NR.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/parse/wannier90.jl#L1-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.read_xdatcar" href="#Hamster.read_xdatcar"><code>Hamster.read_xdatcar</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_xdatcar(xdatcar::AbstractString) -&gt; Xdatcar</code></pre><p>Read the configurations in the <code>xdatcar</code> file and store them in an <code>Xdatcar</code> object.</p><p><strong>Arguments</strong></p><ul><li><code>xdatcar::AbstractString</code>: The path to the XDATCAR file.</li><li><code>frac::Bool=true</code>: If false, coordinates are transformed to cartesian from fractional.</li><li><code>verbosity::Int64=1</code>: If greater 1, progress is printed.</li></ul><p><strong>Returns</strong></p><ul><li><code>lattice::Array{Float64, 3}</code>: A 3x3 array representing the lattice vectors.</li><li><code>configs::Array{Float64, 3}</code>: A 3D array of shape (3, Nion, Nconfig), where each 3xNion slice represents the atomic positions in a configuration.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/parse/xdatcar.jl#L1-L14">source</a></section></article><h1 id="Main"><a class="docs-heading-anchor" href="#Main">Main</a><a id="Main-1"></a><a class="docs-heading-anchor-permalink" href="#Main" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.decide_which_task_to_perform-Tuple{Config}" href="#Hamster.decide_which_task_to_perform-Tuple{Config}"><code>Hamster.decide_which_task_to_perform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">decide_which_task_to_perform(conf::Config)</code></pre><p>Given a <code>Config</code> instance, decides which type of calculation is to be performed based on certain tags in the input file.</p><p><strong>Details</strong></p><ul><li>An <code>Optimizer</code> without a <code>HyperOpt</code> block tells Hamster to run a parameter optimization.</li><li>An <code>Optimizer</code> with a <code>HyperOpt</code> block tells Hamster to run a hyperparameter optimization.</li><li>Otherwise, a standard calculation is performed.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/main.jl#L47-L56">source</a></section></article><h1 id="Config"><a class="docs-heading-anchor" href="#Config">Config</a><a id="Config-1"></a><a class="docs-heading-anchor-permalink" href="#Config" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.ConfigBlock" href="#Hamster.ConfigBlock"><code>Hamster.ConfigBlock</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ConfigBlock</code></pre><p>A structure representing a block of configuration settings.</p><p>The <code>ConfigBlock</code> struct is used to encapsulate a segment of a configuration file, typically consisting of a header and associated content lines. The header usually indicates the section or category of the configuration, while the content contains key-value pairs or other relevant settings.</p><p><strong>Fields:</strong></p><ul><li><code>header::Vector{String}</code>: A vector of strings representing the header of the configuration block. This typically identifies the section or category the block belongs to.</li><li><code>content::Vector{String}</code>: A vector of strings representing the content of the configuration block. Each string usually corresponds to a line in the configuration file, often containing key-value pairs or other settings.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/conf/read_config.jl#L78-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.filter_comment-Tuple{Any}" href="#Hamster.filter_comment-Tuple{Any}"><code>Hamster.filter_comment</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">filter_comment(line::String)</code></pre><p>Removes comments from a line of text based on predefined comment symbols. The function scans for comment symbols, and if found, it removes the comment portion and returns the remaining part of the line.</p><p><strong>Arguments:</strong></p><ul><li><code>line::String</code>: The line of text from which comments need to be filtered out.</li></ul><p><strong>Returns:</strong></p><ul><li>A <code>String</code> that contains the line without comments. If the entire line is a comment or becomes empty after removing the comment, an empty string is returned.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/conf/read_config.jl#L140-L150">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_config-Tuple{}" href="#Hamster.get_config-Tuple{}"><code>Hamster.get_config</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_config(; filename=&quot;hconf&quot;)</code></pre><p>Retrieves the configuration from a file if it exists, or returns an empty configuration if the file does not exist.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code> (optional): The name of the configuration file to check for existence. Defaults to <code>&quot;hconf&quot;</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>Config</code>: A <code>Config</code> instance.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/conf/read_config.jl#L3-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.read_config-Tuple{String}" href="#Hamster.read_config-Tuple{String}"><code>Hamster.read_config</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_config()</code></pre><p>Read the tbconfig file if given, else return default config.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/conf/read_config.jl#L17-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.read_config_block!-Tuple{Hamster.ConfigBlock, Config}" href="#Hamster.read_config_block!-Tuple{Hamster.ConfigBlock, Config}"><code>Hamster.read_config_block!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_config_block!(block::ConfigBlock, conf::Config)</code></pre><p>Processes a configuration block and updates the configuration object with the parsed key-value pairs.</p><p>This function iterates over the lines in a <code>ConfigBlock</code>, parses each line to extract configuration options and their values, and updates the provided <code>Config</code> object. The function handles lines containing the <code>=</code> character, while ignoring comments and empty lines. The updates are made based on whether the block&#39;s header ends with <code>&quot;Options&quot;</code> or some other string.</p><p><strong>Arguments:</strong></p><ul><li><code>block::ConfigBlock</code>: An object representing a block of configuration lines, typically containing a header and a list of content lines.</li><li><code>conf::Config</code>: The configuration object that will be updated with the parsed key-value pairs from the block.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/conf/read_config.jl#L94-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.read_config_line-Tuple{Any}" href="#Hamster.read_config_line-Tuple{Any}"><code>Hamster.read_config_line</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_config_line(line::String) -&gt; Tuple{String, String}</code></pre><p>Parses a configuration line into a key-value pair.</p><p>This function splits a configuration line at the first occurrence of the <code>=</code> character, separating the line into an option key and its corresponding value. Both the key and value are stripped of any leading or trailing whitespace.</p><p><strong>Arguments:</strong></p><ul><li><code>line::String</code>: A string representing a single line from a configuration file, typically in the form <code>&quot;key = value&quot;</code>.</li></ul><p><strong>Returns:</strong></p><ul><li>A tuple <code>(option_key, option_value)</code> where:<ul><li><code>option_key::String</code>: The configuration option key, stripped of leading and trailing whitespace.</li><li><code>option_value::String</code>: The configuration option value, also stripped of leading and trailing whitespace.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/conf/read_config.jl#L118-L132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.split_blocks-Tuple{Any}" href="#Hamster.split_blocks-Tuple{Any}"><code>Hamster.split_blocks</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">split_blocks(lines)</code></pre><p>Splits a list of lines into blocks of text based on &quot;begin&quot; and &quot;end&quot; markers. Each block is encapsulated in a <code>ConfigBlock</code> struct.</p><p><strong>Arguments</strong></p><ul><li><code>lines</code>: A list of strings, where each string is a line from the input text.</li></ul><p><strong>Returns</strong></p><ul><li>A list of <code>ConfigBlock</code> instances, each containing the header and content of a block found in the input lines.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/conf/read_config.jl#L36-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Config" href="#Hamster.Config"><code>Hamster.Config</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">(conf::Config)(key, typekey=&quot;none&quot;)</code></pre><p>Retrieve a value associated with a given key from <code>conf</code>. If a <code>typekey</code> is provided and exists in the <code>blocks</code> dictionary, it retrieves the value from the corresponding block.  If no <code>typekey</code> is provided or it is set to <code>&quot;none&quot;</code>, it retrieves the value from the <code>options</code> dictionary.</p><p><strong>Arguments</strong></p><ul><li><code>conf::Config</code>: The <code>Config</code> instance to query.</li><li><code>key</code>: The key to look up in the <code>Config</code> instance.</li><li><code>typekey</code> (optional): The key for the block in the <code>blocks</code> dictionary to look up the value. Defaults to <code>&quot;none&quot;</code>.</li></ul><p><strong>Returns</strong></p><ul><li>The value associated with the <code>key</code> in the <code>options</code> dictionary if <code>typekey</code> is <code>&quot;none&quot;</code> and the key exists.</li><li>The value associated with the <code>key</code> in the specified block of the <code>blocks</code> dictionary if <code>typekey</code> is provided and exists, and the key exists in that block.</li><li>The string &quot;default&quot; if the key does not exist in the relevant dictionary or block.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/conf/config.jl#L25-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Config" href="#Hamster.Config"><code>Hamster.Config</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct Config</code></pre><p>A configuration structure that holds options and blocks of tags in dictionaries.</p><p><strong>Fields</strong></p><ul><li><code>options::Dict{String, String}</code>: A dictionary holding configuration options.</li><li><code>blocks::Dict{String, Dict{String, String}}</code>: A dictionary holding configuration blocks.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/conf/config.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.Config" href="#Hamster.Config"><code>Hamster.Config</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">(conf::Config)(keys::Vector{String}, typekey=&quot;none&quot;)</code></pre><p>Makes the <code>Config</code> instance callable with a vector of keys to retrieve corresponding values.  If a <code>typekey</code> is provided and exists in the <code>blocks</code> dictionary, it retrieves the values from the corresponding block.  If no <code>typekey</code> is provided or it is set to <code>&quot;none&quot;</code>, it retrieves the values from the <code>options</code> dictionary.</p><p><strong>Arguments</strong></p><ul><li><code>conf::Config</code>: The <code>Config</code> instance to query.</li><li><code>keys::Vector{String}</code>: A vector of keys to look up in the <code>Config</code> instance.</li><li><code>typekey</code> (optional): The key for the block in the <code>blocks</code> dictionary to look up the values. Defaults to <code>&quot;none&quot;</code>.</li></ul><p><strong>Returns</strong></p><ul><li>A vector of values corresponding to the provided keys. <ul><li>If <code>typekey</code> is <code>&quot;none&quot;</code> and the key exists in the <code>options</code> dictionary, the value from the <code>options</code> dictionary is returned.</li><li>If <code>typekey</code> is provided and exists in the <code>blocks</code> dictionary, and the key exists in that block, the value from the block is returned.</li><li>If the key does not exist in the relevant dictionary or block, the string &quot;default&quot; is returned for that key.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/conf/config.jl#L80-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.get-Union{Tuple{T}, Tuple{Config, Any, T}} where T" href="#Base.get-Union{Tuple{T}, Tuple{Config, Any, T}} where T"><code>Base.get</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Base.get(conf::Config, key, default::T) :: T where {T}
 Base.get(conf::Config, key, typekey, default::T) :: T where {T}</code></pre><p>Retrieve a value associated with <code>key</code> (and <code>typekey</code>) from a configuration object <code>conf</code>. If the value returned by <code>conf(key)</code> is <code>&quot;default&quot;</code>, the fallback value <code>default</code> is returned instead.</p><p><strong>Arguments</strong></p><ul><li><code>conf::Config</code>: A configuration object, typically implementing callable behavior for key lookups.</li><li><code>key</code>: The key to look up in the configuration. Its type depends on the <code>Config</code> implementation.</li><li><code>default::T</code>: A fallback value of type <code>T</code> to return if the configuration value for <code>key</code> is <code>&quot;default&quot;</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>::T</code>: The value associated with <code>key</code> in <code>conf</code>, unless that value is <code>&quot;default&quot;</code>, in which case <code>default</code> is returned.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/conf/config.jl#L56-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.haskey-Tuple{Config, Any}" href="#Base.haskey-Tuple{Config, Any}"><code>Base.haskey</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">haskey(conf::Config, key)</code></pre><p>Checks if a given key exists in either the <code>options</code> or <code>blocks</code> dictionary of a <code>Config</code> instance.</p><p><strong>Arguments</strong></p><ul><li><code>conf::Config</code>: The <code>Config</code> instance to check.</li><li><code>key</code>: The key to check for existence.</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: <code>true</code> if the key exists in either the <code>options</code> or <code>blocks</code> dictionary, <code>false</code> otherwise.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/conf/config.jl#L100-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.check_parse-Tuple{Any, Any}" href="#Hamster.check_parse-Tuple{Any, Any}"><code>Hamster.check_parse</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_parse(type, line)</code></pre><p>Check if the string or vector of strings <code>line</code> can be converte to <code>type</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/conf/config.jl#L181-L185">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.convert_value-Tuple{Any}" href="#Hamster.convert_value-Tuple{Any}"><code>Hamster.convert_value</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">convert_value(value::String)</code></pre><p>Attempts to convert a string <code>value</code> into its most appropriate data type among <code>Int64</code>, <code>Float64</code>, and <code>Bool</code>. If the string represents a valid value for one of these types, it is parsed and returned as that type. If not, the original string is returned.</p><p><strong>Arguments:</strong></p><ul><li><code>value::String</code>: The string representation of a value to be converted.</li></ul><p><strong>Returns:</strong></p><ul><li>The converted value in its most appropriate type (either <code>Int64</code>, <code>Float64</code>, or <code>Bool</code>), or the original string if it cannot be converted.</li></ul><p><strong>Behavior:</strong></p><ul><li>The function splits the input <code>value</code> based on spaces into components using <code>split_line(value, char=&#39; &#39;)</code>.</li><li>It then attempts to parse these components into <code>Int64</code>, <code>Float64</code>, and <code>Bool</code> types.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/conf/config.jl#L147-L161">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.get_empty_config-Tuple{}" href="#Hamster.get_empty_config-Tuple{}"><code>Hamster.get_empty_config</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_empty_config()</code></pre><p>Returns an empty <code>Config</code> instance.</p><p><strong>Returns</strong></p><ul><li><code>Config</code>: An empty <code>Config</code> instance with empty <code>options</code> and <code>blocks</code> dictionaries.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/conf/config.jl#L15-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.set_value!-Tuple{Config, Any, Any, Any}" href="#Hamster.set_value!-Tuple{Config, Any, Any, Any}"><code>Hamster.set_value!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_value!(conf::Config, key, typekey, value)</code></pre><p>Sets the value of a given key in the specified block of the <code>blocks</code> dictionary of a <code>Config</code> instance. If the block does not exist, it creates a new block with the given key-value pair. Keys are always stored in lowercase.</p><p><strong>Arguments</strong></p><ul><li><code>key</code>: The key to set in the specified block.</li><li><code>typekey</code>: The key for the block in which the key-value pair should be set.</li><li><code>value</code>: The value to set for the specified key.</li><li><code>conf::Config</code>: The <code>Config</code> instance where the key-value pair should be set.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/conf/config.jl#L126-L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.set_value!-Tuple{Config, Any, Any}" href="#Hamster.set_value!-Tuple{Config, Any, Any}"><code>Hamster.set_value!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_value!(conf::Config, key, value)</code></pre><p>Sets the value of a given key in the <code>options</code> dictionary of a <code>Config</code> instance.</p><p><strong>Arguments</strong></p><ul><li><code>key</code>: The key for which the value needs to be set.</li><li><code>value</code>: The value to set for the specified key.</li><li><code>conf::Config</code>: The <code>Config</code> instance where the key-value pair should be set.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/conf/config.jl#L114-L123">source</a></section></article><h1 id="Output"><a class="docs-heading-anchor" href="#Output">Output</a><a id="Output-1"></a><a class="docs-heading-anchor-permalink" href="#Output" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.append_output_block-Tuple{Any, Any, Any}" href="#Hamster.append_output_block-Tuple{Any, Any, Any}"><code>Hamster.append_output_block</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">append_output_block(block_title, block_tags, block_values; filename=&quot;hamster.out&quot;)</code></pre><p>Append a formatted block of output to the specified file, typically used for logging or report generation.</p><p><strong>Arguments</strong></p><ul><li><code>block_title::AbstractString</code>: The title of the block to be appended. This title will be written as a header.</li><li><code>block_tags::AbstractVector{&lt;:AbstractString}</code>: A vector of tags or labels corresponding to the block&#39;s values.</li><li><code>block_values::AbstractVector{&lt;:Any}</code>: A vector of values corresponding to the tags, representing the content to be written.</li><li><code>filename::AbstractString</code>: The name of the file to which the block will be appended. Defaults to <code>&quot;hamster.out&quot;</code>.</li></ul><p><strong>Usage</strong></p><ul><li>This function checks if the specified file exists. If it does, it appends a titled block of information with tags and corresponding values.</li><li>Each tag-value pair is written on a new line using the <code>write_output_line</code> function.</li><li>A separator line is written after the block for clarity.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/out/output.jl#L54-L69">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.append_output_line-Tuple{Any, Any}" href="#Hamster.append_output_line-Tuple{Any, Any}"><code>Hamster.append_output_line</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_output_line(key, value, L)</code></pre><p>Append a line with <code>key</code> and <code>value</code> pair to the output file <code>dyntb.out</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/out/output.jl#L110-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.clear_hamster_output-Tuple{}" href="#Hamster.clear_hamster_output-Tuple{}"><code>Hamster.clear_hamster_output</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">clear_hamster_output(; output_files=[&quot;hamster_out.h5&quot;, &quot;hamster.out&quot;, &quot;Es.dat&quot;, &quot;vs.dat&quot;])</code></pre><p>Delete output files generated by Hamster.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>output_files::Vector{String}</code>: List of filenames to remove. Defaults to <code>[&quot;hamster_out.h5&quot;, &quot;hamster.out&quot;, &quot;Es.dat&quot;, &quot;vs.dat&quot;]</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/out/output.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.generate_output" href="#Hamster.generate_output"><code>Hamster.generate_output</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_output(conf::Config)</code></pre><p>Generates the main output file <code>hamster.out</code> with initial run information.</p><p><strong>Arguments</strong></p><ul><li><code>conf::Config</code>: A configuration object containing parameters and settings for the current run.</li></ul><p><strong>Details</strong></p><p>This function performs the following tasks:</p><ol><li>Opens (creates) the file <code>hamster.out</code> for writing.</li><li>Writes the current date and time to the file to record when the Hamster run started.</li><li>Writes the list of unique hostnames.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/out/output.jl#L16-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.write_output_line-Tuple{Any, Any, Any}" href="#Hamster.write_output_line-Tuple{Any, Any, Any}"><code>Hamster.write_output_line</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_output_line(dyntb_out, key, value, L)</code></pre><p>Write a line with <code>key</code> and <code>value</code> pair to the output file <code>dyntb_out</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/out/output.jl#L98-L102">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hamster.write_separator-Tuple{Any}" href="#Hamster.write_separator-Tuple{Any}"><code>Hamster.write_separator</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_separator(hamster_out)</code></pre><p>Write a separator line of <code>L</code> times <code>char</code><code>to the</code>io_stream`.</p><p><strong>Arguments</strong></p><ul><li><code>io_stream::IO</code>: The io stream to which the separator will be written.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/TheoFEM-TUM/Hamster.jl/blob/33e34ad7c481d277e4841dc7ab963743d5f042ed/src/out/output.jl#L44-L51">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../examples/gaas_ml_fit/">« Fitting a Delta-ML model on data from MD</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 30 September 2025 15:23">Tuesday 30 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
